<div class="fluent-content-container">
  <div class="fluent-mb-4">
    <h2 class="fluent-m-0 fluent-mb-1">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</h2>
    <p class="fluent-text-secondary fluent-m-0">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ <strong><%= user.displayName %></strong>! Ø¢Ø®Ø±ÛŒÙ† Ø¢Ù…Ø§Ø± Ùˆ ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ… Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
  </div>
  
  <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø± -->
  <div class="fluent-grid fluent-grid-cols-4 fluent-grid-cols-sm-2 fluent-mb-5">
    <div class="fluent-stat-card fluent-card fluent-shadow-sm">
      <h4 class="fluent-stat-card-title">Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h4>
      <div class="fluent-stat-card-value"><%= userStats.totalUsers.toLocaleString() %></div>
      <div class="fluent-stat-card-change fluent-stat-card-change-up">
        <span class="fluent-stat-card-change-icon"><i class="fas fa-arrow-up"></i></span>
        <%= userStats.newUsersToday %> Ø§Ù…Ø±ÙˆØ²
      </div>
      <i class="fas fa-users fluent-opacity-25 fluent-text-primary" style="position: absolute; top: 10px; left: 10px; font-size: 24px;"></i>
    </div>
    
    <div class="fluent-stat-card fluent-card fluent-shadow-sm">
      <h4 class="fluent-stat-card-title">Ø¯Ø³ØªÙˆØ±Ø§Øª Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡</h4>
      <div class="fluent-stat-card-value"><%= systemStats.commands.toLocaleString() %></div>
      <div class="fluent-stat-card-change fluent-stat-card-change-up">
        <span class="fluent-stat-card-change-icon"><i class="fas fa-arrow-up"></i></span>
        <%= systemStats.today.commandsUsed %> Ø§Ù…Ø±ÙˆØ²
      </div>
      <i class="fas fa-terminal fluent-opacity-25 fluent-text-success" style="position: absolute; top: 10px; left: 10px; font-size: 24px;"></i>
    </div>
    
    <div class="fluent-stat-card fluent-card fluent-shadow-sm">
      <h4 class="fluent-stat-card-title">Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ</h4>
      <div class="fluent-stat-card-value"><%= systemStats.aiRequests.toLocaleString() %></div>
      <div class="fluent-stat-card-change fluent-stat-card-change-up">
        <span class="fluent-stat-card-change-icon"><i class="fas fa-arrow-up"></i></span>
        <%= systemStats.today.aiRequests %> Ø§Ù…Ø±ÙˆØ²
      </div>
      <i class="fas fa-robot fluent-opacity-25 fluent-text-primary" style="position: absolute; top: 10px; left: 10px; font-size: 24px;"></i>
    </div>
    
    <div class="fluent-stat-card fluent-card fluent-shadow-sm">
      <h4 class="fluent-stat-card-title">Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡</h4>
      <div class="fluent-stat-card-value"><%= systemStats.gamesPlayed.toLocaleString() %></div>
      <div class="fluent-stat-card-change fluent-stat-card-change-up">
        <span class="fluent-stat-card-change-icon"><i class="fas fa-arrow-up"></i></span>
        <%= systemStats.today.gamesPlayed %> Ø§Ù…Ø±ÙˆØ²
      </div>
      <i class="fas fa-gamepad fluent-opacity-25 fluent-text-warning" style="position: absolute; top: 10px; left: 10px; font-size: 24px;"></i>
    </div>
  </div>
  
  <!-- Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ -->
  <div class="fluent-grid fluent-grid-cols-2 fluent-grid-cols-sm-1 fluent-mb-5">
    <div class="fluent-card fluent-p-0">
      <div class="fluent-card-header">
        <div class="fluent-card-header-start">
          <div class="fluent-card-icon">
            <i class="fas fa-chart-line"></i>
          </div>
          <h3 class="fluent-card-title">ÙØ¹Ø§Ù„ÛŒØª Ù‡ÙØªÙ‡ Ø§Ø®ÛŒØ±</h3>
        </div>
        <div class="fluent-card-actions">
          <div class="fluent-btn-group">
            <button class="fluent-btn fluent-btn-sm fluent-btn-toggle active" onclick="toggleChartData('activityChart', 'commands')">Ø¯Ø³ØªÙˆØ±Ø§Øª</button>
            <button class="fluent-btn fluent-btn-sm fluent-btn-toggle" onclick="toggleChartData('activityChart', 'ai')">Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ</button>
            <button class="fluent-btn fluent-btn-sm fluent-btn-toggle" onclick="toggleChartData('activityChart', 'games')">Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§</button>
          </div>
        </div>
      </div>
      <div class="fluent-card-body">
        <canvas id="activityChart"></canvas>
      </div>
    </div>
    
    <div class="fluent-card fluent-p-0">
      <div class="fluent-card-header">
        <div class="fluent-card-header-start">
          <div class="fluent-card-icon">
            <i class="fas fa-user-plus"></i>
          </div>
          <h3 class="fluent-card-title">Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¬Ø¯ÛŒØ¯</h3>
        </div>
      </div>
      <div class="fluent-card-body">
        <canvas id="newUsersChart"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª -->
  <div class="fluent-grid fluent-grid-cols-2 fluent-grid-cols-sm-1 fluent-mb-5">
    <div class="fluent-card fluent-p-0">
      <div class="fluent-card-header">
        <div class="fluent-card-header-start">
          <div class="fluent-card-icon">
            <i class="fas fa-server"></i>
          </div>
          <h3 class="fluent-card-title">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÛŒØ³ØªÙ…</h3>
        </div>
        <div class="fluent-card-actions">
          <a href="/admin/stats" class="fluent-btn fluent-btn-sm fluent-btn-outline">
            Ù†Ù…Ø§ÛŒØ´ Ø¨ÛŒØ´ØªØ±
            <i class="fas fa-arrow-left fluent-mr-1"></i>
          </a>
        </div>
      </div>
      <div class="fluent-card-body">
        <div class="fluent-form-grid fluent-form-col-2">
          <div class="fluent-mb-2">
            <div class="fluent-text-sm fluent-text-secondary">Ø¢Ù†Ù„Ø§ÛŒÙ† Ø§Ø²:</div>
            <div>
              <%= new Date(Date.now() - systemStats.uptime * 1000).toLocaleString('fa-IR') %>
              (<%= Math.floor(systemStats.uptime / 86400) %> Ø±ÙˆØ²)
            </div>
          </div>
          <div class="fluent-mb-2">
            <div class="fluent-text-sm fluent-text-secondary">ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§:</div>
            <div><%= systemStats.transactions.toLocaleString() %></div>
          </div>
          <div class="fluent-mb-2">
            <div class="fluent-text-sm fluent-text-secondary">Ø³Ø±Ù‚Øªâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚:</div>
            <div>
              <%= systemStats.robberies.successful.toLocaleString() %>
              (<%= systemStats.robberies.successRate %>%)
            </div>
          </div>
          <div class="fluent-mb-2">
            <div class="fluent-text-sm fluent-text-secondary">ÙˆØ§Ù…â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„:</div>
            <div>
              <%= systemStats.loans.outstandingCount.toLocaleString() %>
            </div>
          </div>
          <div class="fluent-mb-2">
            <div class="fluent-text-sm fluent-text-secondary">Ø¢Ø®Ø±ÛŒÙ† Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ:</div>
            <div>
              <%= systemStats.lastBackup.toLocaleString('fa-IR') %>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="fluent-card fluent-p-0">
      <div class="fluent-card-header">
        <div class="fluent-card-header-start">
          <div class="fluent-card-icon">
            <i class="fas fa-crown"></i>
          </div>
          <h3 class="fluent-card-title">Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨Ø±ØªØ±</h3>
        </div>
        <div class="fluent-card-actions">
          <a href="/admin/users" class="fluent-btn fluent-btn-sm fluent-btn-outline">
            Ù†Ù…Ø§ÛŒØ´ Ù‡Ù…Ù‡
            <i class="fas fa-arrow-left fluent-mr-1"></i>
          </a>
        </div>
      </div>
      <div class="fluent-card-body fluent-p-0">
        <div class="fluent-table-container">
          <table class="fluent-table fluent-table-compact">
            <thead>
              <tr>
                <th class="fluent-table-col-min">#</th>
                <th>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±</th>
                <th class="fluent-text-left">Ø«Ø±ÙˆØª</th>
              </tr>
            </thead>
            <tbody>
              <% for (let i = 0; i < userStats.topUsers.length; i++) { %>
                <tr>
                  <td><%= i + 1 %></td>
                  <td><%= userStats.topUsers[i].username %></td>
                  <td class="fluent-text-left"><%= userStats.topUsers[i].totalWealth.toLocaleString() %> ğŸ’°</td>
                </tr>
              <% } %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ùˆ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ -->
  <div class="fluent-grid fluent-grid-cols-2 fluent-grid-cols-sm-1 fluent-mb-5">
    <div class="fluent-card fluent-p-0">
      <div class="fluent-card-header">
        <div class="fluent-card-header-start">
          <div class="fluent-card-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h3 class="fluent-card-title">Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…</h3>
        </div>
        <div class="fluent-card-actions">
          <a href="/admin/logs" class="fluent-btn fluent-btn-sm fluent-btn-outline">
            Ù†Ù…Ø§ÛŒØ´ Ù‡Ù…Ù‡
            <i class="fas fa-arrow-left fluent-mr-1"></i>
          </a>
        </div>
      </div>
      <div class="fluent-card-body fluent-p-0">
        <div class="fluent-scrollbar" style="max-height: 300px; overflow-y: auto;">
          <% if (alerts.length === 0) { %>
            <div class="fluent-text-center fluent-p-4 fluent-text-secondary">
              <i class="fas fa-check-circle fluent-mb-2" style="font-size: 24px;"></i>
              <div>Ù‡ÛŒÚ† Ù‡Ø´Ø¯Ø§Ø±ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!</div>
            </div>
          <% } else { %>
            <div class="fluent-p-2">
              <% alerts.forEach(alert => { %>
                <div class="fluent-card fluent-p-3 fluent-mb-2 fluent-border-r
                  <%= alert.type === 'error' ? 'fluent-card-border-error' : 
                    alert.type === 'warning' ? 'fluent-card-border-warning' : 
                    'fluent-card-border-info' %>">
                  <div class="fluent-flex fluent-align-center fluent-mb-2">
                    <i class="fas 
                      <%= alert.type === 'error' ? 'fa-exclamation-circle fluent-text-error' : 
                        alert.type === 'warning' ? 'fa-exclamation-triangle fluent-text-warning' : 
                        'fa-info-circle fluent-text-primary' %>
                      fluent-mr-2"></i>
                    <div><%= alert.message %></div>
                  </div>
                  <div class="fluent-text-xs fluent-text-secondary">
                    <%= new Date(alert.time).toLocaleString('fa-IR') %>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } %>
        </div>
      </div>
    </div>
    
    <div class="fluent-card fluent-p-0">
      <div class="fluent-card-header">
        <div class="fluent-card-header-start">
          <div class="fluent-card-icon">
            <i class="fas fa-history"></i>
          </div>
          <h3 class="fluent-card-title">ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ÛŒØ±</h3>
        </div>
        <div class="fluent-card-actions">
          <a href="/admin/logs" class="fluent-btn fluent-btn-sm fluent-btn-outline">
            Ù†Ù…Ø§ÛŒØ´ Ù‡Ù…Ù‡
            <i class="fas fa-arrow-left fluent-mr-1"></i>
          </a>
        </div>
      </div>
      <div class="fluent-card-body fluent-p-0">
        <div class="fluent-scrollbar" style="max-height: 300px; overflow-y: auto;">
          <% if (recentActivities.length === 0) { %>
            <div class="fluent-text-center fluent-p-4 fluent-text-secondary">
              <i class="fas fa-history fluent-mb-2" style="font-size: 24px;"></i>
              <div>Ù‡ÛŒÚ† ÙØ¹Ø§Ù„ÛŒØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!</div>
            </div>
          <% } else { %>
            <div class="fluent-p-2">
              <% recentActivities.forEach(activity => { %>
                <div class="fluent-card fluent-p-3 fluent-mb-2">
                  <div class="fluent-flex fluent-align-center fluent-mb-2">
                    <div style="width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-left: 12px;" 
                      class="<%= activity.type === 'user' ? 'fluent-bg-primary' : 
                        activity.type === 'transaction' ? 'fluent-bg-success' : 
                        activity.type === 'game' ? 'fluent-bg-warning' : 
                        activity.type === 'system' ? 'fluent-bg-primary' : 'fluent-bg-subtle' %>">
                      <i class="fas 
                        <%= activity.type === 'user' ? 'fa-user' : 
                          activity.type === 'transaction' ? 'fa-money-bill-wave' :
                          activity.type === 'game' ? 'fa-gamepad' :
                          activity.type === 'system' ? 'fa-cog' : 'fa-shield-alt' %>
                        fluent-text-white"></i>
                    </div>
                    <div>
                      <div class="fluent-font-semibold"><%= activity.username %> - <%= activity.action %></div>
                      <div class="fluent-text-sm"><%= activity.details %></div>
                    </div>
                  </div>
                  <div class="fluent-text-xs fluent-text-secondary">
                    <%= new Date(activity.time).toLocaleString('fa-IR') %>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ÙˆØ¸Ø§ÛŒÙ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ø´Ø¯Ù‡ -->
  <div class="fluent-card fluent-p-0 fluent-mb-5">
    <div class="fluent-card-header">
      <div class="fluent-card-header-start">
        <div class="fluent-card-icon">
          <i class="fas fa-tasks"></i>
        </div>
        <h3 class="fluent-card-title">ÙˆØ¸Ø§ÛŒÙ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ø´Ø¯Ù‡</h3>
      </div>
    </div>
    <div class="fluent-card-body fluent-p-0">
      <div class="fluent-table-container">
        <table class="fluent-table">
          <thead>
            <tr>
              <th>Ù†Ø§Ù… ÙˆØ¸ÛŒÙÙ‡</th>
              <th>Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ</th>
              <th>ÙˆØ¶Ø¹ÛŒØª</th>
              <th class="fluent-table-col-action">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
          </thead>
          <tbody>
            <% if (scheduledTasks.length === 0) { %>
              <tr>
                <td colspan="4" class="fluent-text-center fluent-p-4 fluent-text-secondary">
                  Ù‡ÛŒÚ† ÙˆØ¸ÛŒÙÙ‡â€ŒØ§ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª!
                </td>
              </tr>
            <% } else { %>
              <% scheduledTasks.forEach(task => { %>
                <tr>
                  <td><%= task.name %></td>
                  <td><%= new Date(task.nextRun).toLocaleString('fa-IR') %></td>
                  <td>
                    <span class="fluent-table-status 
                      <%= task.status === 'active' ? 'fluent-table-status-success' : 'fluent-table-status-error' %>">
                      <%= task.status === 'active' ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ±ÙØ¹Ø§Ù„' %>
                    </span>
                  </td>
                  <td>
                    <div class="fluent-table-row-actions">
                      <button class="fluent-btn-icon fluent-btn-sm fluent-btn-subtle fluent-table-row-action" title="Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÛŒ">
                        <i class="fas fa-play"></i>
                      </button>
                      <button class="fluent-btn-icon fluent-btn-sm fluent-btn-subtle fluent-table-row-action" title="<%= task.status === 'active' ? 'ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†' : 'ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù†' %>">
                        <i class="fas fa-<%= task.status === 'active' ? 'pause' : 'play' %>"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              <% }) %>
            <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ ÙÙ„ÙˆØ¦Ù†Øª
    const fluentPrimary = '#0078d4';
    const fluentSuccess = '#107c10';
    const fluentWarning = '#ffaa44';
    const fluentGray20 = '#f3f2f1';
    const fluentGray30 = '#edebe9';
    
    // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø´ØªØ±Ú© Ù†Ù…ÙˆØ¯Ø§Ø±
    Chart.defaults.font.family = 'Vazirmatn, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, sans-serif';
    Chart.defaults.color = '#605e5c';
    Chart.defaults.plugins.tooltip.backgroundColor = 'rgba(50, 49, 48, 0.95)';
    Chart.defaults.plugins.tooltip.titleFont = { weight: '600' };
    Chart.defaults.plugins.tooltip.bodyFont = { weight: '400' };
    Chart.defaults.plugins.tooltip.padding = 12;
    Chart.defaults.plugins.tooltip.cornerRadius = 4;
    
    // Ù†Ù…ÙˆØ¯Ø§Ø± ÙØ¹Ø§Ù„ÛŒØª Ù‡ÙØªÙ‡ Ø§Ø®ÛŒØ±
    const activityCtx = document.getElementById('activityChart').getContext('2d');
    const activityChart = new Chart(activityCtx, {
      type: 'line',
      data: {
        labels: ['Ø´Ù†Ø¨Ù‡', 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡'],
        datasets: [{
          label: 'Ø¯Ø³ØªÙˆØ±Ø§Øª',
          data: <%= JSON.stringify(systemStats.weeklyStats.commandsUsed) %>,
          borderColor: fluentPrimary,
          backgroundColor: 'rgba(0, 120, 212, 0.1)',
          tension: 0.3,
          fill: true,
          borderWidth: 2
        }, {
          label: 'Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ',
          data: <%= JSON.stringify(systemStats.weeklyStats.aiRequests) %>,
          borderColor: fluentSuccess,
          backgroundColor: 'rgba(16, 124, 16, 0.1)',
          tension: 0.3,
          fill: true,
          borderWidth: 2,
          hidden: true
        }, {
          label: 'Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§',
          data: <%= JSON.stringify(systemStats.weeklyStats.gamesPlayed) %>,
          borderColor: fluentWarning,
          backgroundColor: 'rgba(255, 170, 68, 0.1)',
          tension: 0.3,
          fill: true,
          borderWidth: 2,
          hidden: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          mode: 'index',
          intersect: false
        },
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            mode: 'index',
            intersect: false
          }
        },
        layout: {
          padding: {
            top: 20,
            bottom: 16,
            left: 20,
            right: 20
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: fluentGray30,
              drawBorder: false
            },
            ticks: {
              padding: 10
            }
          },
          x: {
            grid: {
              display: false,
              drawBorder: false
            },
            ticks: {
              padding: 10
            }
          }
        }
      }
    });
    
    // Ù†Ù…ÙˆØ¯Ø§Ø± Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¬Ø¯ÛŒØ¯
    const newUsersCtx = document.getElementById('newUsersChart').getContext('2d');
    const newUsersChart = new Chart(newUsersCtx, {
      type: 'bar',
      data: {
        labels: ['Ø´Ù†Ø¨Ù‡', 'ÛŒÚ©Ø´Ù†Ø¨Ù‡', 'Ø¯ÙˆØ´Ù†Ø¨Ù‡', 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡', 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡', 'Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù‡', 'Ø¬Ù…Ø¹Ù‡'],
        datasets: [{
          label: 'Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¬Ø¯ÛŒØ¯',
          data: <%= JSON.stringify(systemStats.weeklyStats.newUsers) %>,
          backgroundColor: fluentPrimary,
          borderRadius: 4,
          maxBarThickness: 40
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          }
        },
        layout: {
          padding: {
            top: 20,
            bottom: 16,
            left: 20,
            right: 20
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: fluentGray30,
              drawBorder: false
            },
            ticks: {
              padding: 10
            }
          },
          x: {
            grid: {
              display: false,
              drawBorder: false
            },
            ticks: {
              padding: 10
            }
          }
        }
      }
    });
    
    // ØªØ§Ø¨Ø¹ ØªØºÛŒÛŒØ± Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±
    window.toggleChartData = function(chartId, datasetLabel) {
      const chart = Chart.getChart(chartId);
      const buttons = document.querySelectorAll('.fluent-btn-toggle');
      
      // ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
      buttons.forEach(btn => {
        if (btn.textContent.trim().toLowerCase() === datasetLabel.toLowerCase()) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
      
      // ØªØºÛŒÛŒØ± Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
      chart.data.datasets.forEach(dataset => {
        if (dataset.label.toLowerCase() === datasetLabel.toLowerCase()) {
          dataset.hidden = false;
        } else {
          dataset.hidden = true;
        }
      });
      
      chart.update();
    };
  });
</script>