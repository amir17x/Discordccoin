import { huggingFaceService } from "../services/huggingface";
import { log } from "../../vite";

/**
 * ูุฌููุนู ููุถูุนุงุช ุชุฎุตุต ุจุฑุง ุชููุฏ ูฺฉุงุช
 * ูุฑ ููุถูุน ุจู ุนููุงู ฺฉ ุฏุณุชูโุจูุฏ ุจุฑุง ุชููุฏ ูฺฉุงุช ุชูุณุท ููุด ูุตููุน ุงุณุชูุงุฏู ูโุดูุฏ
 */
export const tipTopics = [
  "ุงูุชุตุงุฏ ู ูุฏุฑุช Ccoin",
  "ุงุณุชุฑุงุชฺโูุง ุจุงุฒ ู ุฑูุงุจุช",
  "ูฺฺฏโูุง ูพููุงู ุฑุจุงุช",
  "ูุงุจูุชโูุง ุฌุฏุฏ",
  "ุฑุงูฺฉุงุฑูุง ุงูุฒุงุด ุฏุฑุขูุฏ",
  "ููุงุจุน ฺฉุณุจ Ccoin",
  "ูุฏุฑุช ฺฉููโูุง",
  "ุดุฎุตโุณุงุฒ ูพุฑููุงู",
  "ุฑุงุฒูุง ููููุช ุฏุฑ ุจุงุฒโูุง ฺฏุฑูู",
  "ูฺฉุงุช ุงููุช ู ูุญุงูุธุช ุงุฒ ุญุณุงุจ",
  "ุชุฑููุฏูุง ูุนุงููุงุช",
  "ูุฒุงุง ุนุถูุช ุฏุฑ ฺฉููโูุง",
  "ูฺฉุงุช ุจุฑุง ุชุงุฒูโูุงุฑุฏุงู",
  "ุงุณุชูุงุฏู ุจููู ุงุฒ ูุฑูุดฺฏุงู",
  "ุขุชูโูุง ูฺู ู ฺฉุงุฑุจุฑุฏ ุขูโูุง"
];

/**
 * ุชููุฏ ฺฉ ูฺฉุชู ุงุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ Hugging Face
 * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
 */
export async function generateAITip(): Promise<string> {
  try {
    // ุงูุชุฎุงุจ ฺฉ ููุถูุน ุงุชูุงู ุงุฒ ูุณุช ููุถูุนุงุช
    const randomTopic = tipTopics[Math.floor(Math.random() * tipTopics.length)];
    
    // ุณุงุฎุช ูพุฑุงููพุช ุจุฑุง Hugging Face
    const prompt = `ุจู ุนููุงู ฺฉ ูุชุฎุตุต ุฏุฑ ุฑุจุงุช ุฏุณฺฉูุฑุฏ Ccoin ฺฉู ุฏุงุฑุง ุณุณุชู ุงูุชุตุงุฏุ ฺฉููโูุงุ ุจุงุฒโูุง ฺฏุฑููุ ู ูุฏุฑุช ุขุชูโูุงุณุชุ 
      ฺฉ ูฺฉุชู ุฌุงูุจุ ฺฉูุชุงู ู ฺฉุงุฑุจุฑุฏ (ุญุฏุงฺฉุซุฑ ด ุฌููู) ุจุง ููุถูุน "${randomTopic}" ุจู ูุงุฑุณ ุจููุณ.
      ูพุงุณุฎ ุจุงุฏ ููุท ุดุงูู ูุชู ูฺฉุชู ุจุงุดุฏุ ุจุฏูู ุนููุงู ุง ููุฏูู. ุงุฒ ุงููุฌโูุง ููุงุณุจ ุงุณุชูุงุฏู ฺฉู ุชุง ุฌุฐุงุจโุชุฑ ุดูุฏ.`;
    
    // ุฏุฑุงูุช ูพุงุณุฎ ุงุฒ Hugging Face
    const response = await huggingFaceService.getAIResponse(prompt, {
      maxTokens: 150,
      temperature: 0.8 // ฺฉู ุฎูุงูุช ุจุดุชุฑ ุจุฑุง ุชููุน ุฏุฑ ูฺฉุงุช
    });
    
    log(`AI tip generated successfully with topic: ${randomTopic}`, 'discord');
    
    return response;
  } catch (error) {
    log(`Error generating AI tip: ${error}`, 'error');
    
    // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู
    return "๐ก ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ `/daily` ูโุชูุงูุฏ ูุฑ ฒด ุณุงุนุช ฺฉุจุงุฑ ุฌุงุฒู ุฑูุฒุงูู ุฎูุฏ ุฑุง ุฏุฑุงูุช ฺฉูุฏ. ุจุง ุญูุธ ุงุณุชุฑฺฉ ท ุฑูุฒูุ ุฌูุงุฒ ูฺูโุง ุฏุฑุงูุช ุฎูุงูุฏ ฺฉุฑุฏ!";
  }
}

/**
 * ุชููุฏ ฺฉ ูฺฉุชู ุฏุฑ ููุฑุฏ ููุถูุน ูุดุฎุต
 * @param topic ููุถูุน ุจุฑุง ุชููุฏ ูฺฉุชู
 * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
 */
export async function generateTopicTip(topic: string): Promise<string> {
  try {
    // ุณุงุฎุช ูพุฑุงููพุช ุจุฑุง Hugging Face
    const prompt = `ุจู ุนููุงู ฺฉ ูุชุฎุตุต ุฏุฑ ุฑุจุงุช ุฏุณฺฉูุฑุฏ Ccoin ฺฉู ุฏุงุฑุง ุณุณุชู ุงูุชุตุงุฏุ ฺฉููโูุงุ ุจุงุฒโูุง ฺฏุฑููุ ู ูุฏุฑุช ุขุชูโูุงุณุชุ 
      ฺฉ ูฺฉุชู ุฌุงูุจุ ฺฉูุชุงู ู ฺฉุงุฑุจุฑุฏ (ุญุฏุงฺฉุซุฑ ด ุฌููู) ุจุง ููุถูุน "${topic}" ุจู ูุงุฑุณ ุจููุณ.
      ูพุงุณุฎ ุจุงุฏ ููุท ุดุงูู ูุชู ูฺฉุชู ุจุงุดุฏุ ุจุฏูู ุนููุงู ุง ููุฏูู. ุงุฒ ุงููุฌโูุง ููุงุณุจ ุงุณุชูุงุฏู ฺฉู ุชุง ุฌุฐุงุจโุชุฑ ุดูุฏ.`;
    
    // ุฏุฑุงูุช ูพุงุณุฎ ุงุฒ Hugging Face
    const response = await huggingFaceService.getAIResponse(prompt, {
      maxTokens: 150,
      temperature: 0.7
    });
    
    log(`AI topic tip generated successfully for topic: ${topic}`, 'discord');
    
    return response;
  } catch (error) {
    log(`Error generating AI topic tip: ${error}`, 'error');
    
    // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู
    return `๐ก ${topic} ฺฉ ุงุฒ ูฺฺฏโูุง ููู ุฑุจุงุช Ccoin ุงุณุช ฺฉู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุฌุฑุจู ุจูุชุฑ ุฏุงุดุชู ุจุงุดุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุงุฒ ุฏุณุชูุฑ /help ุงุณุชูุงุฏู ฺฉูุฏ!`;
  }
}