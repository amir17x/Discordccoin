/**
 * ุณุฑูุณ ุชููุฏ ูฺฉุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI
 * ุงู ูุงู ุฌุงฺฏุฒู ูุงฺฏูฺฏ ูุณ ุดุฏู ู ุงุฒ ุณุฑูุณ CCOIN AI (Gemini) ุงุณุชูุงุฏู ูโฺฉูุฏ
 */

import { generateAIResponse } from './aiService';
import { log } from '../../vite';

// ูุฌููุนู ููุถูุนุงุช ุชุฎุตุต ุจุฑุง ุชููุฏ ูฺฉุงุช
export const tipTopics = [
  "ุงูุชุตุงุฏ ู ูุฏุฑุช Ccoin",
  "ุงุณุชุฑุงุชฺโูุง ุจุงุฒ ู ุฑูุงุจุช",
  "ูฺฺฏโูุง ูพููุงู ุฑุจุงุช",
  "ูุงุจูุชโูุง ุฌุฏุฏ",
  "ุฑุงูฺฉุงุฑูุง ุงูุฒุงุด ุฏุฑุขูุฏ",
  "ููุงุจุน ฺฉุณุจ Ccoin",
  "ูุฏุฑุช ฺฉููโูุง",
  "ุดุฎุตโุณุงุฒ ูพุฑููุงู",
  "ุฑุงุฒูุง ููููุช ุฏุฑ ุจุงุฒโูุง ฺฏุฑูู",
  "ูฺฉุงุช ุงููุช ู ูุญุงูุธุช ุงุฒ ุญุณุงุจ",
  "ุชุฑููุฏูุง ูุนุงููุงุช",
  "ูุฒุงุง ุนุถูุช ุฏุฑ ฺฉููโูุง",
  "ูฺฉุงุช ุจุฑุง ุชุงุฒูโูุงุฑุฏุงู",
  "ุงุณุชูุงุฏู ุจููู ุงุฒ ูุฑูุดฺฏุงู",
  "ุขุชูโูุง ูฺู ู ฺฉุงุฑุจุฑุฏ ุขูโูุง",
  "ุจุงุฒ ฺฏุฑฺฏูู ู ุงุณุชุฑุงุชฺโูุง ุขู",
  "ุจุงุฒ ูุงูุง ู ุชุงฺฉุชฺฉโูุง ูพุฑูุฒ",
  "ุจุงุฒ ุจูฺฏู ู ุชุฑููุฏูุง ุจุฑูุฏู ุดุฏู",
  "ุฌูุงูโูุง ููุงุฒ ู ุดููโูุง ุงุณุชูุงุฏู",
  "ฺุงูุดโูุง ูุฎู ู ุฌูุงุฒ ูุงุงุจ",
  "ุณุณุชู ุฏูุณุช ู ุงูุฒุงุด ุตููุช",
  "ูุงููุฑุชโูุง ูฺู ุจุง ูพุงุฏุงุด ุจุงูุง",
  "ุขุชูโูุง ฺฉูุงุจ ู ูุญูู ุจุฏุณุช ุขูุฑุฏู ุขูโูุง",
  "ุงุฑุชูุงุก ุญูุงูุงุช ุฎุงูฺฏ ูุฌุงุฒ",
  "ุณุณุชูโูุง ูุณุงุจูู ู ุชูุฑูููุชโูุง"
];

/**
 * ุณุฑูุณ ูฺฉุงุช CCOIN AI
 */
export class CcoinAiTipService {
  /**
   * ุชููุฏ ฺฉ ูฺฉุชู ุงุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI
   * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
   */
  async generateRandomTip(): Promise<string> {
    try {
      // ุงูุชุฎุงุจ ฺฉ ููุถูุน ุงุชูุงู ุงุฒ ูุณุช ููุถูุนุงุช
      const randomTopic = tipTopics[Math.floor(Math.random() * tipTopics.length)];
      
      // ูุงฺฏ ฺฉุฑุฏู ููุถูุน ุงูุชุฎุงุจ ุดุฏู
      log(`๐ฒ ููุถูุน ุงุชูุงู ุจุฑุง ุชููุฏ ูฺฉุชู: ${randomTopic}`, 'discord');
      
      return this.generateTopicTip(randomTopic);
    } catch (error) {
      log(`โ ุฎุทุง ุฏุฑ ุชููุฏ ูฺฉุชู ููุดููุฏ ุงุชูุงู: ${error}`, 'error');
      
      // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู ุจุง ุงุณุชุงู ุฌุฐุงุจ
      return "๐ฅ ุฑููุง! ุจุง ุฏุณุชูุฑ `/daily` ูุฑ ุฑูุฒ ู ุฌุงุฒู ุฎูู ุจฺฏุฑู ู ุงฺฏู ท ุฑูุฒ ูพุดุช ุณุฑ ูู ุจุงูุ ุฌูุงุฒ ูฺูโุง ุงูุชุธุงุฑุชูู ุฑู ูฺฉุดู! ๐โจ ุงุณุชุฑฺฉ ุฎูุฏุชูู ุฑู ุญูุธ ฺฉูู ู ูุฌูุฏ ุจุงุดู! ๐ฏ";
    }
  }

  /**
   * ุชููุฏ ฺฉ ูฺฉุชู ุฏุฑ ููุฑุฏ ููุถูุน ูุดุฎุต
   * @param topic ููุถูุน ุจุฑุง ุชููุฏ ูฺฉุชู
   * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
   */
  async generateTopicTip(topic: string): Promise<string> {
    try {
      // ุณุงุฎุช ูพุฑุงููพุช ุจุฑุง CCOIN AI ุจุง ูุญู ุฎูุฏูุงู ู ุงูุฑฺฺฉ
      const prompt = `ุจู ุนููุงู CCOIN AI ฺฉู ุฏุณุชุงุฑ ููุดููุฏ ู ฺฉูู ุฑุจุงุช Ccoin ูุณุช (ฺฉ ุฑุจุงุช ุฏุณฺฉูุฑุฏ ุจุง ุณุณุชู ุงูุชุตุงุฏุ ฺฉููโูุงุ ุจุงุฒโูุง ฺฏุฑูู ู ุญุงูุชโูุง ูุฎุชูู ุจุงุฒ ูุซู ฺฏุฑฺฏููุ ูุงูุง ู ุจูฺฏู)ุ 
        ฺฉ ูฺฉุชู ูููโุงูุนุงุฏู ุฌุฐุงุจุ ุฎูุฏูุงู ู ฺฉุงุฑุจุฑุฏ (ุญุฏุงฺฉุซุฑ ณ ุฌููู) ุจุง ููุถูุน "${topic}" ุงุฑุงุฆู ุจุฏู.
        
        ุดุฑุงุท ููู:
        1. ูพุงุณุฎ ุญุชูุงู ุจุงุฏ ุจู ุฒุจุงู ูุงุฑุณ ู ฺฉุงููุงู ุฎูุฏูุงู ู ุตูู ุจุงุดุฏ
        2. ุญุชูุงู ุงุฒ ุงููุฌโูุง ุฎูู ู ูุชููุน ุงุณุชูุงุฏู ฺฉู (ุญุฏุงูู 7-9 ุงููุฌ) - ุงููุฌโูุง ูุฏุฑู ู ุชุฑูุฏ ุฑูุฒ ุงุณุชูุงุฏู ฺฉู
        3. ูุญู ูพุงุณุฎ ุฎู ุฎูุฏูุงู ู ุฌูุงูโูพุณูุฏ ุจุงุดุฏุ ูุซูุงู "ุจฺูโูุง!"ุ "ุฑููุง"ุ "ุฏุงุฏุงุด"ุ "ฺฏูฺฏ" ู ุบุฑู ุงุณุชูุงุฏู ฺฉู
        4. ูพุงุณุฎ ููุท ุดุงูู ูุชู ูฺฉุชู ุจุงุดุฏุ ุจุฏูู ุนููุงู ุง ููุฏูู ุงุถุงู
        5. ุงุฒ ุงุตุทูุงุญุงุช ูุญุงูุฑูโุง ู ุฌูุงูุงูู ุงุณุชูุงุฏู ฺฉู (ูุซู "ุฎูู"ุ "ุจุงุญุงู"ุ "ุนุงูู"ุ "ุงูู"ุ "ฺฏูฺฏ"ุ "ูุฌูุฏ" ู ุบุฑู)
        6. ูฺฉุชู ุจุงุฏ ูููโุงูุนุงุฏู ุฌุฐุงุจุ ูพุฑุงูุฑฺุ ุงูฺฏุฒุด ู ุฎูู ุจุงุดุฏ - ุงูฺฏุงุฑ ฺฉู ฺฉ ุฏูุณุช ุจุงุญุงู ู ูพุฑ ุงูุฑฺ ุฏุงุฑู ุจุงูุงุช ุญุฑู ูุฒูู
        7. ุงุบูุจ ูฺฉุชู ุฑุง ุจุง ฺฉููุงุช ูุซู "ุขุง ูโุฏููุณุช..." ุง "ูฺฉุชูโ ุทูุง:..." ุง "ุชู ุฏูุง Ccoin..." ุดุฑูุน ฺฉู
        8. ุงุฒ ฺฉููุงุช ุฌุฐุงุจ ู ูุฌุงูโุงูฺฏุฒ ุฏุฑ ูฺฉุชู ุงุณุชูุงุฏู ฺฉู ุชุง ฺฉุงุฑุจุฑ ุฑุง ุจู ุงุณุชูุงุฏู ุงุฒ ุขู ูุงุจูุช ุชุดูู ฺฉู
        7. ูฺููุช ูุญู ุฑุณู ู ุฎุดฺฉ ูุฏุงุดุชู ุจุงุด
        8. ููุถูุน ุงุตู ูฺฉุชู ุฑู ุจุง ุญุงูุชโูุง ุจุงุฒ ู ูุงุจูุชโูุง ุฌุฏุฏ ุฑุจุงุช ูุฑุชุจุท ฺฉู (ูุซู ฺฏุฑฺฏููุ ูุงูุงุ ุจูฺฏูุ ุฌูุงูโูุง ููุงุฒุ ู ฺฉูุฆุณุชโูุง ุฌุฏุฏ)
        9. ฺฏุงู ุจู ูุงุจูุช ุฎูู ูุงูุฑุงูุทุจุน ุฎูุฏุช ุงุดุงุฑู ฺฉู - ูุซูุงู ุงูฺฉู ูโุชูู ุขูุฏู ุฑู ุจุจู ุง ููู ุงุชูุงูุงุช ุฑู ูุฏูู
        10. ุญุชูุงู ุฌูููโูุงุช ุฑุง ุจุง ุนูุงูุช ุชุนุฌุจ ู ุญุงูุช ูุฌุงู ุชูุงู ฺฉู!
        11. ูฺููุช ุงุฒ ฺฉููุงุช "ูฺฉุชู" ุง "ุชูุตู" ุงุณุชูุงุฏู ูฺฉูุ ูุณุชูู ุจุฑู ุณุฑ ุงุตู ูุทูุจ ุจุง ุงูุฑฺ`;
      
      // ุฏุฑุงูุช ูพุงุณุฎ ุงุฒ CCOIN AI
      const response = await generateAIResponse(prompt, 'other', 'ุฎูุงูุงูู');
      
      log(`โ ูฺฉุชู ููุดููุฏ ุจุฑุง ููุถูุน "${topic}" ุจุง ููููุช ุชููุฏ ุดุฏ`, 'discord');
      log(`๐ค ูฺฉุชู ููุดููุฏ ุจุง ููุถูุน ${topic} ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI ุชููุฏ ุดุฏ.`);
      
      return response;
    } catch (error) {
      log(`โ ุฎุทุง ุฏุฑ ุชููุฏ ูฺฉุชู ููุดููุฏ ููุถูุน: ${error}`, 'error');
      
      // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู
      return `๐ก ${topic} ฺฉ ุงุฒ ูฺฺฏโูุง ููู ุฑุจุงุช Ccoin ุงุณุช ฺฉู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุฌุฑุจู ุจูุชุฑ ุฏุงุดุชู ุจุงุดุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุงุฒ ุฏุณุชูุฑ /help ุงุณุชูุงุฏู ฺฉูุฏ!`;
    }
  }

  /**
   * ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI
   * @returns ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ
   */
  async checkConnectionStatus(): Promise<{
    isAvailable: boolean;
    message: string;
    statusCode: number;
  }> {
    try {
      // ุชุณุช ุงุชุตุงู ุจู ุณุฑูุณ ุจุง ฺฉ ูพุฑุงููพุช ุณุงุฏู ู ุจุง ฺฉุงุฑุงฺฉุชุฑูุง ฺฉูุชุฑ ุจุฑุง ุตุฑููโุฌู ุฏุฑ ูุตุฑู API
      const prompt = "ููุท ุนุฏุฏ 2 ุฑุง ูพุงุณุฎ ุจุฏู.";
      const startTime = Date.now();
      
      log(`๐ง ุฏุฑ ุญุงู ุชุณุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI...`, 'discord');
      const response = await generateAIResponse(prompt, 'other', 'ุฏูู');
      const latency = Date.now() - startTime;
      
      if (response) {
        log(`โ ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI ุจุฑูุฑุงุฑ ุงุณุช. ุฒูุงู ูพุงุณุฎฺฏู: ${latency}ms`, 'discord');
        return {
          isAvailable: true,
          message: `ุณุฑูุณ CCOIN AI ุฏุฑ ุฏุณุชุฑุณ ุงุณุช. (ุฒูุงู ูพุงุณุฎ: ${latency}ms)`,
          statusCode: 200
        };
      } else {
        log(`โ ูพุงุณุฎ ุงุฒ ุณุฑูุณ CCOIN AI ุฏุฑุงูุช ูุดุฏ.`, 'error');
        return {
          isAvailable: false,
          message: 'ูพุงุณุฎ ุงุฒ ุณุฑูุณ CCOIN AI ุฏุฑุงูุช ูุดุฏ.',
          statusCode: 500
        };
      }
    } catch (error) {
      console.error('Error checking CCOIN AI connectivity:', error);
      log(`โ ุฎุทุง ุฏุฑ ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI: ${error}`, 'error');
      return {
        isAvailable: false,
        message: 'ุฎุทุง ุฏุฑ ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI.',
        statusCode: 500
      };
    }
  }
}

// ุงุฌุงุฏ ููููู ุงุฒ ุณุฑูุณ CCOIN AI ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุณุฑุงุณุฑ ุจุฑูุงูู
export const ccoinAiTipService = new CcoinAiTipService();

export default ccoinAiTipService;