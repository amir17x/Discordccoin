/**
 * ุณุฑูุณ ุชููุฏ ูฺฉุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI
 * ุงู ูุงู ุฌุงฺฏุฒู ูุงฺฏูฺฏ ูุณ ุดุฏู ู ุงุฒ ุณุฑูุณ CCOIN AI (Gemini) ุงุณุชูุงุฏู ูโฺฉูุฏ
 */

import { generateAIResponse } from './aiService';
import { log } from '../../vite';

// ูุฌููุนู ููุถูุนุงุช ุชุฎุตุต ุจุฑุง ุชููุฏ ูฺฉุงุช - ุฏุณุชูโุจูุฏ ุฏููโุชุฑ ู ููุธูโุชุฑ
export const tipTopics = [
  // ูุฏุฑุช ุงูุชุตุงุฏ
  "ุณุณุชู ุจุงูฺฉ Ccoin",  
  "ูุฏุฑุช ุณฺฉูโูุง ู ุฐุฎุฑูโุณุงุฒ",
  "ุฑุงูฺฉุงุฑูุง ุงูุฒุงุด ุฏุฑุขูุฏ ุฑูุฒุงูู",
  "ููุงุจุน ฺฉุณุจ Ccoin ู ฺฉุฑุณุชุงู",
  "ุณุฑูุงูโฺฏุฐุงุฑ ุฏุฑ ุจุงุฒุงุฑ ุณูุงู",
  "ุชุฑููุฏูุง ูุนุงููุงุช ู ุฎุฑุฏ ู ูุฑูุด",
  "ุณุณุชู ูุงูโุฏู ู ูุฑุถ",
  
  // ุณุณุชู ฺฉููโูุง
  "ุชุดฺฉู ู ูุฏุฑุช ฺฉูู",
  "ุงุณุชุฑุงุชฺโูุง ูุจุฑุฏ ฺฉููโูุง",
  "ูุฒุงุง ุนุถูุช ุฏุฑ ฺฉููโูุง",
  "ุงุฑุชูุงุก ฺฉูู ู ุงูุฒุงุด ุณุทุญ",
  "ูฺฉุงุช ููู ุจุฑุง ุฑูุจุฑุงู ฺฉูู",
  "ุฑุชุจูโุจูุฏ ฺฉููโูุง ู ุฑูุงุจุช",
  
  // ุจุงุฒโูุง ุชุนุงูู
  "ุงุณุชุฑุงุชฺโูุง ููููุช ุฏุฑ ุจุงุฒ ฺฏุฑฺฏูู",
  "ุชุงฺฉุชฺฉโูุง ุจุฑูุฏู ุดุฏู ุฏุฑ ุจุงุฒ ูุงูุง",
  "ุชุฑููุฏูุง ุจุงุฒ ุจูฺฏู",
  "ฺุงูุดโูุง ูุฎู ู ุฌูุงุฒ ูฺู",
  "ุฑุงูููุง ููโฺฏูโูุง ู ุจุงุฒโูุง ุดุงูุณ",
  
  // ุณุณุชู ุงุฌุชูุงุน
  "ฺฏุณุชุฑุด ุฑูุงุจุท ุฏูุณุช ุฏุฑ Ccoin",
  "ุณุณุชู ูุฏูโุฏู ุจู ุฏูุณุชุงู",
  "ฺุชโูุง ูุงุดูุงุณ ู ุงุตูู ุงุณุชูุงุฏู",
  "ุณุงุฎุชู ุดุจฺฉู ุงุฌุชูุงุน ุฏุฑ Ccoin",
  
  // ุงูฺฉุงูุงุช ูพุดุฑูุชู
  "ุฌูุงูโูุง ููุงุฒ ู ฺฉุงุฑุจุฑุฏ ุขููุง",
  "ูพุชโูุง ูุฌุงุฒ ู ูุญูู ุงุฑุชูุงุก ุขููุง",
  "ุขุชูโูุง ฺฉูุงุจ ู ุฑูุดโูุง ุฏุณุชุงุจ",
  "ุณุณุชู ุฏุณุชุงูุฑุฏูุง ู ูุดุงูโูุง",
  
  // ุจุฑุง ุชุงุฒูโูุงุฑุฏุงู
  "ุดุฑูุน ูุฏุฑุชููุฏ ุฏุฑ Ccoin",
  "ุฏุณุชูุฑุงุช ุงุณุงุณ ุจุฑุง ุชุงุฒูโูุงุฑุฏุงู",
  "ูุณุฑ ูพุดุฑูุช ุณุฑุน ุฏุฑ ุจุงุฒ",
  
  // ุงููุช ู ุชูุธูุงุช
  "ูุญุงูุธุช ุงุฒ ุญุณุงุจ ู ุณฺฉูโูุง",
  "ุชูุธูุงุช ูพุดุฑูุชู ูพุฑููุงู",
  "ุดุฎุตโุณุงุฒ ุชุฌุฑุจู ุจุงุฒ"
];

/**
 * ุณุฑูุณ ูฺฉุงุช CCOIN AI
 */
export class CcoinAITipService {
  /**
   * ุชููุฏ ฺฉ ูฺฉุชู ุงุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI
   * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
   */
  async generateRandomTip(): Promise<string> {
    try {
      // ุงูุชุฎุงุจ ฺฉ ููุถูุน ุงุชูุงู ุงุฒ ูุณุช ููุถูุนุงุช
      const randomTopic = tipTopics[Math.floor(Math.random() * tipTopics.length)];
      
      // ูุงฺฏ ฺฉุฑุฏู ููุถูุน ุงูุชุฎุงุจ ุดุฏู
      log(`๐ฒ ููุถูุน ุงุชูุงู ุจุฑุง ุชููุฏ ูฺฉุชู: ${randomTopic}`, 'discord');
      
      return this.generateTopicTip(randomTopic);
    } catch (error) {
      log(`โ ุฎุทุง ุฏุฑ ุชููุฏ ูฺฉุชู ููุดููุฏ ุงุชูุงู: ${error}`, 'error');
      
      // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู ุจุง ุงุณุชุงู ุฌุฐุงุจ
      return "๐ฅ ุฑููุง! ุจุง ุฏุณุชูุฑ `/daily` ูุฑ ุฑูุฒ ู ุฌุงุฒู ุฎูู ุจฺฏุฑู ู ุงฺฏู ท ุฑูุฒ ูพุดุช ุณุฑ ูู ุจุงูุ ุฌูุงุฒ ูฺูโุง ุงูุชุธุงุฑุชูู ุฑู ูฺฉุดู! ๐โจ ุงุณุชุฑฺฉ ุฎูุฏุชูู ุฑู ุญูุธ ฺฉูู ู ูุฌูุฏ ุจุงุดู! ๐ฏ";
    }
  }

  /**
   * ุชููุฏ ฺฉ ูฺฉุชู ุฏุฑ ููุฑุฏ ููุถูุน ูุดุฎุต
   * @param topic ููุถูุน ุจุฑุง ุชููุฏ ูฺฉุชู
   * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
   */
  async generateTopicTip(topic: string): Promise<string> {
    try {
      // ุณุงุฎุช ูพุฑุงููพุช ุจุฑุง CCOIN AI ุจุง ูุญู ุฎูุฏูุงู ู ุงูุฑฺฺฉ ู ุจุง ุชูุฑฺฉุฒ ุจุดุชุฑ ุฑู ููุถูุน ุฎุงุต
      const prompt = `ุจู ุนููุงู CCOIN AI ฺฉู ุฏุณุชุงุฑ ููุดููุฏ ู ฺฉูู ุฑุจุงุช Ccoin ูุณุช (ฺฉ ุฑุจุงุช ุฏุณฺฉูุฑุฏ ุจุง ุณุณุชู ุงูุชุตุงุฏุ ฺฉููโูุงุ ุจุงุฒโูุง ฺฏุฑูู ู ุญุงูุชโูุง ูุฎุชูู ุจุงุฒ ูุซู ฺฏุฑฺฏููุ ูุงูุง ู ุจูฺฏู)ุ 
        ฺฉ ูฺฉุชู ูููโุงูุนุงุฏู ุฌุฐุงุจุ ุฎูุฏูุงู ู ฺฉุงุฑุจุฑุฏ (ุญุฏุงฺฉุซุฑ ณ ุฌููู) ุฏููุงู ุจุง ููุถูุน "${topic}" ุงุฑุงุฆู ุจุฏู.
        
        ุดุฑุงุท ููู:
        1. ูุญุชูุง ูฺฉุชู ุจุงุฏ ุฏููุงู ูุฑุชุจุท ุจุง ููุถูุน "${topic}" ุจุงุดุฏ ู ุงุฒ ููุถูุน ุฎุงุฑุฌ ูุดูุฏ
        2. ูพุงุณุฎ ุญุชูุงู ุจุงุฏ ุจู ุฒุจุงู ูุงุฑุณ ู ฺฉุงููุงู ุฎูุฏูุงู ู ุตูู ุจุงุดุฏ
        3. ุญุชูุงู ุงุฒ ุงููุฌโูุง ูุฑุชุจุท ู ูุชููุน ุงุณุชูุงุฏู ฺฉู (ุญุฏุงูู 5-7 ุงููุฌ ูุฑุชุจุท ุจุง ููุถูุน)
        4. ูุญู ูพุงุณุฎ ุฎู ุฎูุฏูุงู ู ุฌูุงูโูพุณูุฏ ุจุงุดุฏุ ูุซูุงู "ุจฺูโูุง!"ุ "ุฑููุง!"ุ "ุฏูุณุชุงู!"
        5. ูพุงุณุฎ ููุท ุดุงูู ูุชู ูฺฉุชู ุจุงุดุฏุ ุจุฏูู ุนููุงู ุง ููุฏูู ุงุถุงู
        6. ูฺฉุชู ุจุงุฏ ูููโุงูุนุงุฏู ุฌุฐุงุจุ ฺฉุงุฑุจุฑุฏ ู ูุงุจู ุงุฌุฑุง ุจุงุดุฏ - ุงุทูุงุนุงุช ฺฉู ฺฉุงุฑุจุฑ ูุงูุนุงู ุจุชูุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏ
        7. ุงุฒ ุงุทูุงุนุงุช ุบูุท ุง ฺฏูุฑุงูโฺฉููุฏู ุฏุฑ ููุฑุฏ ูุงุจูุชโูุง Ccoin ุฎูุฏุฏุงุฑ ฺฉู
        8. ุงุบูุจ ูฺฉุชู ุฑุง ุจุง ุนุจุงุฑุงุช ูุซู "ุขุง ูโุฏููุณุช..." ุง "ุชู ุฏูุง Ccoin..." ุดุฑูุน ฺฉู
        9. ุชูุถุญุงุช ุฏูู ู ฺฉุงุฑุจุฑุฏ ุฏุฑ ููุฑุฏ ูฺฺฏโูุง ุฎุงุต ูุฑุชุจุท ุจุง "${topic}" ุงุฑุงุฆู ฺฉู
        10. ุญุชูุงู ุฌูููโูุงุช ุฑุง ุจุง ุนูุงูุช ุชุนุฌุจ ู ุญุงูุช ูุฌุงู ุชูุงู ฺฉู!

        ููู: ุงฺฏุฑ ููุถูุน "${topic}" ุดุงูู ฺฉููู "ฺฉูู" ุงุณุชุ ููุท ู ููุท ุฏุฑุจุงุฑู ฺฉููโูุง ู ูฺฉุงุช ูุฑุชุจุท ุจุง ูุฏุฑุชุ ูุจุฑุฏุ ุง ูุฒุงุง ฺฉููโูุง ุตุญุจุช ฺฉู ู ุจู ูฺ ูุฌู ุจู ุจุงุฒโูุง ูุซู ฺฏุฑฺฏูู ุง ูุงูุง ุงุดุงุฑู ูฺฉู.
        
        ุงฺฏุฑ ููุถูุน "${topic}" ุดุงูู ฺฉููู "ฺฏุฑฺฏูู" ุงุณุชุ ููุท ู ููุท ุฏุฑุจุงุฑู ุจุงุฒ ฺฏุฑฺฏูู ู ุงุณุชุฑุงุชฺโูุง ุขู ุตุญุจุช ฺฉู.
        
        ุงฺฏุฑ ููุถูุน "${topic}" ุดุงูู ฺฉููู "ูุงูุง" ุงุณุชุ ููุท ู ููุท ุฏุฑุจุงุฑู ุจุงุฒ ูุงูุง ู ุชุงฺฉุชฺฉโูุง ุขู ุตุญุจุช ฺฉู.
        
        ุงฺฏุฑ ููุถูุน "${topic}" ุดุงูู ฺฉููู "ุจูฺฏู" ุงุณุชุ ููุท ู ููุท ุฏุฑุจุงุฑู ุจุงุฒ ุจูฺฏู ู ุชุฑููุฏูุง ุขู ุตุญุจุช ฺฉู.
        
        ุจู ููู ุชุฑุชุจุ ุจุฑุง ูุฑ ููุถูุนุ ุตุฑูุงู ุจู ููุงู ููุถูุน ูุดุฎุต ุจูพุฑุฏุงุฒ ู ุงุฒ ููุถูุน ุฎุงุฑุฌ ูุดู.`;
      
      // ุฏุฑุงูุช ูพุงุณุฎ ุงุฒ CCOIN AI
      const response = await generateAIResponse(prompt, 'other', 'ุฎูุงูุงูู');
      
      log(`โ ูฺฉุชู ููุดููุฏ ุจุฑุง ููุถูุน "${topic}" ุจุง ููููุช ุชููุฏ ุดุฏ`, 'discord');
      log(`๐ค ูฺฉุชู ููุดููุฏ ุจุง ููุถูุน ${topic} ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI ุชููุฏ ุดุฏ.`);
      
      return response;
    } catch (error) {
      log(`โ ุฎุทุง ุฏุฑ ุชููุฏ ูฺฉุชู ููุดููุฏ ููุถูุน: ${error}`, 'error');
      
      // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู
      return `๐ก ${topic} ฺฉ ุงุฒ ูฺฺฏโูุง ููู ุฑุจุงุช Ccoin ุงุณุช ฺฉู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุฌุฑุจู ุจูุชุฑ ุฏุงุดุชู ุจุงุดุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุงุฒ ุฏุณุชูุฑ /help ุงุณุชูุงุฏู ฺฉูุฏ!`;
    }
  }

  /**
   * ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI
   * @returns ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ
   */
  async checkConnectionStatus(): Promise<{
    isAvailable: boolean;
    message: string;
    statusCode: number;
  }> {
    try {
      // ุชุณุช ุงุชุตุงู ุจู ุณุฑูุณ ุจุง ฺฉ ูพุฑุงููพุช ุณุงุฏู ู ุจุง ฺฉุงุฑุงฺฉุชุฑูุง ฺฉูุชุฑ ุจุฑุง ุตุฑููโุฌู ุฏุฑ ูุตุฑู API
      const prompt = "ููุท ุนุฏุฏ 2 ุฑุง ูพุงุณุฎ ุจุฏู.";
      const startTime = Date.now();
      
      log(`๐ง ุฏุฑ ุญุงู ุชุณุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI...`, 'discord');
      const response = await generateAIResponse(prompt, 'other', 'ุฏูู');
      const latency = Date.now() - startTime;
      
      if (response) {
        log(`โ ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI ุจุฑูุฑุงุฑ ุงุณุช. ุฒูุงู ูพุงุณุฎฺฏู: ${latency}ms`, 'discord');
        return {
          isAvailable: true,
          message: `ุณุฑูุณ CCOIN AI ุฏุฑ ุฏุณุชุฑุณ ุงุณุช. (ุฒูุงู ูพุงุณุฎ: ${latency}ms)`,
          statusCode: 200
        };
      } else {
        log(`โ ูพุงุณุฎ ุงุฒ ุณุฑูุณ CCOIN AI ุฏุฑุงูุช ูุดุฏ.`, 'error');
        return {
          isAvailable: false,
          message: 'ูพุงุณุฎ ุงุฒ ุณุฑูุณ CCOIN AI ุฏุฑุงูุช ูุดุฏ.',
          statusCode: 500
        };
      }
    } catch (error) {
      console.error('Error checking CCOIN AI connectivity:', error);
      log(`โ ุฎุทุง ุฏุฑ ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI: ${error}`, 'error');
      return {
        isAvailable: false,
        message: 'ุฎุทุง ุฏุฑ ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI.',
        statusCode: 500
      };
    }
  }
}

// ุงุฌุงุฏ ููููู ุงุฒ ุณุฑูุณ CCOIN AI ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุณุฑุงุณุฑ ุจุฑูุงูู
export const ccoinAITipService = new CcoinAITipService();

export default ccoinAITipService;