/**
 * ุณุฑูุณ ุชููุฏ ูฺฉุงุช ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI
 * ุงู ูุงู ุฌุงฺฏุฒู ูุงฺฏูฺฏ ูุณ ุดุฏู ู ุงุฒ ุณุฑูุณ CCOIN AI (Gemini) ุงุณุชูุงุฏู ูโฺฉูุฏ
 */

import { generateAIResponse } from './aiService';
import { log } from '../../vite';

// ูุฌููุนู ููุถูุนุงุช ุชุฎุตุต ุจุฑุง ุชููุฏ ูฺฉุงุช
export const tipTopics = [
  "ุงูุชุตุงุฏ ู ูุฏุฑุช Ccoin",
  "ุงุณุชุฑุงุชฺโูุง ุจุงุฒ ู ุฑูุงุจุช",
  "ูฺฺฏโูุง ูพููุงู ุฑุจุงุช",
  "ูุงุจูุชโูุง ุฌุฏุฏ",
  "ุฑุงูฺฉุงุฑูุง ุงูุฒุงุด ุฏุฑุขูุฏ",
  "ููุงุจุน ฺฉุณุจ Ccoin",
  "ูุฏุฑุช ฺฉููโูุง",
  "ุดุฎุตโุณุงุฒ ูพุฑููุงู",
  "ุฑุงุฒูุง ููููุช ุฏุฑ ุจุงุฒโูุง ฺฏุฑูู",
  "ูฺฉุงุช ุงููุช ู ูุญุงูุธุช ุงุฒ ุญุณุงุจ",
  "ุชุฑููุฏูุง ูุนุงููุงุช",
  "ูุฒุงุง ุนุถูุช ุฏุฑ ฺฉููโูุง",
  "ูฺฉุงุช ุจุฑุง ุชุงุฒูโูุงุฑุฏุงู",
  "ุงุณุชูุงุฏู ุจููู ุงุฒ ูุฑูุดฺฏุงู",
  "ุขุชูโูุง ูฺู ู ฺฉุงุฑุจุฑุฏ ุขูโูุง"
];

/**
 * ุณุฑูุณ ูฺฉุงุช CCOIN AI
 */
export class CcoinAiTipService {
  /**
   * ุชููุฏ ฺฉ ูฺฉุชู ุงุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI
   * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
   */
  async generateRandomTip(): Promise<string> {
    try {
      // ุงูุชุฎุงุจ ฺฉ ููุถูุน ุงุชูุงู ุงุฒ ูุณุช ููุถูุนุงุช
      const randomTopic = tipTopics[Math.floor(Math.random() * tipTopics.length)];
      
      return this.generateTopicTip(randomTopic);
    } catch (error) {
      log(`Error generating AI tip: ${error}`, 'error');
      
      // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู
      return "๐ก ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ `/daily` ูโุชูุงูุฏ ูุฑ ฒด ุณุงุนุช ฺฉุจุงุฑ ุฌุงุฒู ุฑูุฒุงูู ุฎูุฏ ุฑุง ุฏุฑุงูุช ฺฉูุฏ. ุจุง ุญูุธ ุงุณุชุฑฺฉ ท ุฑูุฒูุ ุฌูุงุฒ ูฺูโุง ุฏุฑุงูุช ุฎูุงูุฏ ฺฉุฑุฏ!";
    }
  }

  /**
   * ุชููุฏ ฺฉ ูฺฉุชู ุฏุฑ ููุฑุฏ ููุถูุน ูุดุฎุต
   * @param topic ููุถูุน ุจุฑุง ุชููุฏ ูฺฉุชู
   * @returns ููู ุจุฑุง ุฏุฑุงูุช ฺฉ ูฺฉุชู ุชููุฏ ุดุฏู ุชูุณุท ููุด ูุตููุน
   */
  async generateTopicTip(topic: string): Promise<string> {
    try {
      // ุณุงุฎุช ูพุฑุงููพุช ุจุฑุง CCOIN AI ุจุง ูุญู ุฎูุฏูุงู ู ุงูุฑฺฺฉ
      const prompt = `ุจู ุนููุงู CCOIN AI ฺฉู ุฏุณุชุงุฑ ููุดููุฏ ู ฺฉูู ุฑุจุงุช Ccoin ูุณุช (ฺฉ ุฑุจุงุช ุฏุณฺฉูุฑุฏ ุจุง ุณุณุชู ุงูุชุตุงุฏุ ฺฉููโูุงุ ุจุงุฒโูุง ฺฏุฑูู)ุ 
        ฺฉ ูฺฉุชู ุฌุฐุงุจุ ุฎูุฏูุงู ู ฺฉุงุฑุจุฑุฏ (ุญุฏุงฺฉุซุฑ ณ ุฌููู) ุจุง ููุถูุน "${topic}" ุงุฑุงุฆู ุจุฏู.
        
        ุดุฑุงุท ููู:
        1. ูพุงุณุฎ ุญุชูุงู ุจุงุฏ ุจู ุฒุจุงู ูุงุฑุณ ู ฺฉุงููุงู ุฎูุฏูุงู ู ุตูู ุจุงุดุฏ
        2. ุญุชูุงู ุงุฒ ุงููุฌโูุง ูุชููุน ู ุฒุงุฏ ุงุณุชูุงุฏู ฺฉู (ุญุฏุงูู 3-5 ุงููุฌ)
        3. ูุญู ูพุงุณุฎ ุฎู ุฎูุฏูุงู ู ุฌูุงูโูพุณูุฏ ุจุงุดุฏุ ูุซูุงู "ุจฺูโูุง!"ุ "ุฑููุง"ุ "ุฏุงุฏุงุด" ู ุบุฑู ุงุณุชูุงุฏู ฺฉู
        4. ูพุงุณุฎ ููุท ุดุงูู ูุชู ูฺฉุชู ุจุงุดุฏุ ุจุฏูู ุนููุงู ุง ููุฏูู ุงุถุงู
        5. ุงุฒ ุงุตุทูุงุญุงุช ูุญุงูุฑูโุง ู ุฌูุงูุงูู ุงุณุชูุงุฏู ฺฉู (ูุซู "ุฎูู"ุ "ุจุงุญุงู"ุ "ุงูู" ู ุบุฑู)
        6. ุณุน ฺฉู ูฺฉุชู ุฎู ุฌุฐุงุจุ ูพุฑุงูุฑฺ ู ุฎูู ุจุงุดุฏ
        7. ูฺููุช ูุญู ุฑุณู ู ุฎุดฺฉ ูุฏุงุดุชู ุจุงุด`;
      
      // ุฏุฑุงูุช ูพุงุณุฎ ุงุฒ CCOIN AI
      const response = await generateAIResponse(prompt, 'other', 'ุฎูุงูุงูู');
      
      log(`AI topic tip generated successfully for topic: ${topic}`, 'discord');
      log(`๐ค ูฺฉุชู ููุดููุฏ ุจุง ููุถูุน ${topic} ุจุง ุงุณุชูุงุฏู ุงุฒ CCOIN AI ุชููุฏ ุดุฏ.`);
      
      return response;
    } catch (error) {
      log(`Error generating AI topic tip: ${error}`, 'error');
      
      // ุฏุฑ ุตูุฑุช ุฎุทุงุ ฺฉ ูฺฉุชู ูพุดโูุฑุถ ุจุฑฺฏุฑุฏุงู
      return `๐ก ${topic} ฺฉ ุงุฒ ูฺฺฏโูุง ููู ุฑุจุงุช Ccoin ุงุณุช ฺฉู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุฌุฑุจู ุจูุชุฑ ุฏุงุดุชู ุจุงุดุฏ. ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุงุฒ ุฏุณุชูุฑ /help ุงุณุชูุงุฏู ฺฉูุฏ!`;
    }
  }

  /**
   * ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI
   * @returns ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ
   */
  async checkConnectionStatus(): Promise<{
    isAvailable: boolean;
    message: string;
    statusCode: number;
  }> {
    try {
      // ุชุณุช ุงุชุตุงู ุจู ุณุฑูุณ ุจุง ฺฉ ูพุฑุงููพุช ุณุงุฏู
      const prompt = "ูุทูุงู ูพุงุณุฎ ุฎู ฺฉูุชุงู ุจุฏู: 1+1 ฺูุฏ ูโุดูุฏุ";
      const startTime = Date.now();
      
      const response = await generateAIResponse(prompt, 'other', 'ุฏูู');
      const latency = Date.now() - startTime;
      
      if (response) {
        return {
          isAvailable: true,
          message: `ุณุฑูุณ CCOIN AI ุฏุฑ ุฏุณุชุฑุณ ุงุณุช. (ุฒูุงู ูพุงุณุฎ: ${latency}ms)`,
          statusCode: 200
        };
      } else {
        return {
          isAvailable: false,
          message: 'ูพุงุณุฎ ุงุฒ ุณุฑูุณ CCOIN AI ุฏุฑุงูุช ูุดุฏ.',
          statusCode: 500
        };
      }
    } catch (error) {
      console.error('Error checking CCOIN AI connectivity:', error);
      return {
        isAvailable: false,
        message: 'ุฎุทุง ุฏุฑ ุจุฑุฑุณ ูุถุนุช ุงุชุตุงู ุจู ุณุฑูุณ CCOIN AI.',
        statusCode: 500
      };
    }
  }
}

// ุงุฌุงุฏ ููููู ุงุฒ ุณุฑูุณ CCOIN AI ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ุณุฑุงุณุฑ ุจุฑูุงูู
export const ccoinAiTipService = new CcoinAiTipService();

export default ccoinAiTipService;