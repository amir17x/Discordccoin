/**
 * Ø§Ø¨Ø²Ø§Ø± ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª
 * Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ ØªØ³Øª ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
 */

import { ccoinAITipService, tipTopics } from './discord/services/ccoinAITipService';
import { log } from './vite';

/**
 * Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª
 */
async function testTipSystem() {
  try {
    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„
    console.log('ðŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„ Ø¨Ù‡ CCOIN AI...');
    const status = await ccoinAITipService.checkConnectionStatus();
    console.log('ðŸ“¡ ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„:', status);
    
    if (status.isAvailable) {
      // ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ Ù†Ú©ØªÙ‡ Ø§ØªÙØ§Ù‚ÛŒ
      console.log('\nðŸŽ² Ø¯Ø± Ø­Ø§Ù„ ØªÙˆÙ„ÛŒØ¯ ÛŒÚ© Ù†Ú©ØªÙ‡ Ø§ØªÙØ§Ù‚ÛŒ...');
      const randomTip = await ccoinAITipService.generateRandomTip();
      console.log('ðŸ’¡ Ù†Ú©ØªÙ‡ Ø§ØªÙØ§Ù‚ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡:\n', randomTip);
      
      // ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ Ù†Ú©ØªÙ‡ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø®Ø§Øµ
      console.log('\nðŸ” Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ Ù†Ú©ØªÙ‡ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¶ÙˆØ¹Ø§Øª Ø®Ø§Øµ...');
      
      // Ù„ÛŒØ³Øª Ù…ÙˆØ¶ÙˆØ¹Ø§Øª ØªØ³ØªÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒÙ… Ù†Ú©Ø§Øª Ø¢Ù†Ù‡Ø§ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒÙ…
      const testTopics = [
        // Ú†Ù†Ø¯ Ù…ÙˆØ¶ÙˆØ¹ Ø§Ø² Ù‡Ø± Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ
        "Ø³ÛŒØ³ØªÙ… Ø¨Ø§Ù†Ú©ÛŒ Ccoin",
        "Ù…Ø¯ÛŒØ±ÛŒØª Ø³Ú©Ù‡â€ŒÙ‡Ø§ Ùˆ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ",
        "ØªØ´Ú©ÛŒÙ„ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„Ù†",
        "Ù…Ø²Ø§ÛŒØ§ÛŒ Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ù„Ù†â€ŒÙ‡Ø§",
        "Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¨Ø§Ø²ÛŒ Ú¯Ø±Ú¯ÛŒÙ†Ù‡",
        "ØªØ§Ú©ØªÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø¯Ø± Ø¨Ø§Ø²ÛŒ Ù…Ø§ÙÛŒØ§",
        "Ú¯Ø³ØªØ±Ø´ Ø±ÙˆØ§Ø¨Ø· Ø¯ÙˆØ³ØªÛŒ Ø¯Ø± Ccoin",
        "Ú†Øªâ€ŒÙ‡Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³ Ùˆ Ø§ØµÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡",
        "Ù…Ø­Ø§ÙØ¸Øª Ø§Ø² Ø­Ø³Ø§Ø¨ Ùˆ Ø³Ú©Ù‡â€ŒÙ‡Ø§",
        "Ø´Ø±ÙˆØ¹ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ Ø¯Ø± Ccoin"
      ];
      
      // ØªØ³Øª ØªÙˆÙ„ÛŒØ¯ Ù†Ú©ØªÙ‡ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…ÙˆØ¶ÙˆØ¹
      for (const topic of testTopics) {
        console.log(`\nðŸŽ¯ Ø¯Ø± Ø­Ø§Ù„ ØªÙˆÙ„ÛŒØ¯ Ù†Ú©ØªÙ‡ Ø¨Ø§ Ù…ÙˆØ¶ÙˆØ¹ "${topic}"...`);
        const topicTip = await ccoinAITipService.generateTopicTip(topic);
        console.log('ðŸ’¡ Ù†Ú©ØªÙ‡ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡:\n', topicTip);
        
        // Ú©Ù…ÛŒ ØªØ£Ø®ÛŒØ± Ø¨ÛŒÙ† Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù†Ø±Ø® API
        await new Promise(resolve => setTimeout(resolve, 2000));
      }
      
      console.log('\nâœ… ØªÙ…Ø§Ù… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯.');
    } else {
      console.error('âŒ Ø³Ø±ÙˆÛŒØ³ CCOIN AI Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª. ØªØ³Øª Ù…ØªÙˆÙ‚Ù Ø´Ø¯.');
    }
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ù†Ø¬Ø§Ù… ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª:', error);
  }
}

// Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øªâ€ŒÙ‡Ø§
testTipSystem()
  .then(() => {
    log('ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯.', 'info');
    // Ø¯Ø± Ù…Ø­ÛŒØ· ØªÙˆØ³Ø¹Ù‡ØŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±Ø§ Ø®Ø§ØªÙ…Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…
    if (process.env.NODE_ENV !== 'production') {
      setTimeout(() => process.exit(0), 1000);
    }
  })
  .catch(err => {
    log(`Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ù†Ú©Ø§Øª: ${err}`, 'error');
    // Ø¯Ø± Ù…Ø­ÛŒØ· ØªÙˆØ³Ø¹Ù‡ØŒ Ø¨Ø§ Ú©Ø¯ Ø®Ø·Ø§ Ø®Ø§Ø±Ø¬ Ù…ÛŒâ€ŒØ´ÙˆÛŒÙ…
    if (process.env.NODE_ENV !== 'production') {
      setTimeout(() => process.exit(1), 1000);
    }
  });