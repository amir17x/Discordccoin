const { Client, GatewayIntentBits, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle, Collection, Events, REST, Routes, SlashCommandBuilder, StringSelectMenuBuilder, ModalBuilder, TextInputBuilder, TextInputStyle } = require('discord.js');
require('dotenv').config();
const { QuickDB } = require('quick.db');
const cron = require('node-cron');
const db = new QuickDB();
const fs = require('fs');
const path = require('path');

// Create a new Discord client with required intents
const client = new Client({
  intents: [
    GatewayIntentBits.Guilds,
    GatewayIntentBits.GuildMessages,
    GatewayIntentBits.MessageContent,
    GatewayIntentBits.GuildMembers
  ]
});

// Ø§Ø¹Ù„Ø§Ù† Ú©Ø§Ù†ÙÛŒÚ¯ Ù‡Ø§ÛŒ Ú©Ù„ÛŒ
const CONFIG = {
  // Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
  DAILY_AMOUNT: 100, // Ù…Ù‚Ø¯Ø§Ø± Ù¾Ø§Ø¯Ø§Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡
  ROBBERY_MIN_AMOUNT: 10, // Ø­Ø¯Ø§Ù‚Ù„ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø²Ø¯ÛŒ
  ROBBERY_MAX_AMOUNT: 50, // Ø­Ø¯Ø§Ú©Ø«Ø± Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø²Ø¯ÛŒ
  ROBBERY_FAIL_CHANCE: 0.4, // 40% Ø§Ø­ØªÙ…Ø§Ù„ Ø´Ú©Ø³Øª Ø¯Ø± Ø¯Ø²Ø¯ÛŒ
  BANK_INTEREST_RATE: 0.05, // 5% Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ Ø¨Ø§Ù†Ú©ÛŒ
  
  // Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… ÙˆØ§Ù…
  LOAN_TYPES: {
    LOW: { maxAmount: 1000, interestRate: 0.05, durationDays: 7 },
    MEDIUM: { maxAmount: 5000, interestRate: 0.10, durationDays: 14 },
    HIGH: { maxAmount: 10000, interestRate: 0.20, durationDays: 30 }
  },
  LOAN_PENALTY_RATE: 0.10, // 10% Ø¬Ø±ÛŒÙ…Ù‡ ØªØ§Ø®ÛŒØ± Ø¯Ø± Ù¾Ø±Ø¯Ø§Ø®Øª ÙˆØ§Ù…
  
  // Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  BLACK_MARKET_MIN_LEVEL: 20, // Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  BLACK_MARKET_BUST_CHANCE: 0.10, // 10% Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  
  // Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ø§Ø±Ø¬Ø§Ø¹
  REFERRAL_BONUS_REFERRER: 100, // Ù¾Ø§Ø¯Ø§Ø´ Ø¯Ø¹ÙˆØªâ€ŒÚ©Ù†Ù†Ø¯Ù‡
  REFERRAL_BONUS_REFERRED: 50, // Ù¾Ø§Ø¯Ø§Ø´ Ø¯Ø¹ÙˆØªâ€ŒØ´ÙˆÙ†Ø¯Ù‡
  REFERRAL_MAX_COUNT: 10, // Ø­Ø¯Ø§Ú©Ø«Ø± ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø¹ÙˆØª Ù…Ø¹ØªØ¨Ø±
  
  // Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ø²Ù†Ø¯Ø§Ù†
  JAIL_DURATION: {
    MIN: 24 * 60 * 60 * 1000, // Ø­Ø¯Ø§Ù‚Ù„ 1 Ø±ÙˆØ²
    MAX: 7 * 24 * 60 * 60 * 1000 // Ø­Ø¯Ø§Ú©Ø«Ø± 7 Ø±ÙˆØ²
  },
  JAIL_FINE_RATE: 0.20, // 20% Ø¬Ø±ÛŒÙ…Ù‡ Ù…Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ Ø²Ù†Ø¯Ø§Ù†ÛŒâ€ŒÙ‡Ø§
  
  // Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ù„ÛŒÚ¯
  LEAGUES: {
    BRONZE: { minLevel: 1, maxLevel: 10, weeklyBonus: 100 },
    SILVER: { minLevel: 11, maxLevel: 20, weeklyBonus: 300 },
    GOLD: { minLevel: 21, maxLevel: 30, weeklyBonus: 500 },
    DIAMOND: { minLevel: 31, maxLevel: Infinity, weeklyBonus: 1000 }
  }
};

// Main data structures
client.commands = new Collection();
client.cooldowns = new Collection();
client.buttons = new Collection();

// Read commands from commands directory
const commands = [];
const commandsPath = path.join(__dirname, 'commands');

// Create commands directory if it doesn't exist
if (!fs.existsSync(commandsPath)){
    fs.mkdirSync(commandsPath, { recursive: true });
}

// Constants
const DAILY_AMOUNT = 100; // Daily reward amount
const ROBBERY_MIN_AMOUNT = 10;
const ROBBERY_MAX_AMOUNT = 50;
const ROBBERY_FAIL_CHANCE = 0.4; // 40% chance of failure
const BANK_INTEREST_RATE = 0.05; // 5% monthly interest

// Define slash commands
const slashCommands = [
  // Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ
  new SlashCommandBuilder()
    .setName('menu')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ Ø±Ø¨Ø§Øª'),

  // Ø§Ù‚ØªØµØ§Ø¯
  new SlashCommandBuilder()
    .setName('wallet')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„'),

  new SlashCommandBuilder()
    .setName('bank')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ'),

  new SlashCommandBuilder()
    .setName('deposit')
    .setDescription('ÙˆØ§Ø±ÛŒØ² Ø³Ú©Ù‡ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ')
    .addStringOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± Ø³Ú©Ù‡ Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±ÛŒØ² (all Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ)')
        .setRequired(true)),

  new SlashCommandBuilder()
    .setName('withdraw')
    .setDescription('Ø¨Ø±Ø¯Ø§Ø´Øª Ø³Ú©Ù‡ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ')
    .addStringOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± Ø³Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯Ø§Ø´Øª (all Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ)')
        .setRequired(true)),

  // Ø±Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø³Ø¨ Ø¯Ø±Ø¢Ù…Ø¯
  new SlashCommandBuilder()
    .setName('daily')
    .setDescription('Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡'),

  // Ø¯Ø³ØªÙˆØ± Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
  new SlashCommandBuilder()
    .setName('pickpocket')
    .setDescription('Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø± Ø¨Ø§ Ø±ÛŒØ³Ú© Ùˆ Ù¾Ø§Ø¯Ø§Ø´ Ù…ØªÙØ§ÙˆØª')
    .addUserOption(option => 
      option.setName('target')
        .setDescription('Ú©Ø§Ø±Ø¨Ø± Ù‡Ø¯Ù Ø¨Ø±Ø§ÛŒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ')
        .setRequired(true))
    .addStringOption(option => 
      option.setName('type')
        .setDescription('Ù†ÙˆØ¹ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ (Ù‡Ø± Ú©Ø¯Ø§Ù… Ø±ÛŒØ³Ú© Ùˆ Ù¾Ø§Ø¯Ø§Ø´ Ù…ØªÙØ§ÙˆØªÛŒ Ø¯Ø§Ø±Ø¯)')
        .setRequired(true)
        .addChoices(
          { name: 'Ø³Ø±ÛŒØ¹ (Ø±ÛŒØ³Ú© Ú©Ù…ØŒ Ø³ÙˆØ¯ Ú©Ù…)', value: 'quick' },
          { name: 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ (Ø±ÛŒØ³Ú© Ù…ØªÙˆØ³Ø·ØŒ Ø³ÙˆØ¯ Ù…ØªÙˆØ³Ø·)', value: 'professional' },
          { name: 'Ø¨Ø²Ø±Ú¯ (Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ØŒ Ø³ÙˆØ¯ Ø¨Ø§Ù„Ø§)', value: 'grand' },
          { name: 'Ù¾Ù†Ù‡Ø§Ù†ÛŒ (Ø³Ø·Ø­ 25+)', value: 'stealth' }
        )),

  // Ø¯Ø³ØªÙˆØ± Ù‚Ø¯ÛŒÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø­ÙØ¸ Ø³Ø§Ø²Ú¯Ø§Ø±ÛŒ
  new SlashCommandBuilder()
    .setName('rob')
    .setDescription('Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø±')
    .addUserOption(option => 
      option.setName('target')
        .setDescription('Ú©Ø§Ø±Ø¨Ø± Ù‡Ø¯Ù Ø¨Ø±Ø§ÛŒ Ø¯Ø²Ø¯ÛŒ')
        .setRequired(true)),

  // Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§
  new SlashCommandBuilder()
    .setName('coinflip')
    .setDescription('Ø¨Ø§Ø²ÛŒ Ø´ÛŒØ± ÛŒØ§ Ø®Ø·')
    .addStringOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ')
        .setRequired(true))
    .addStringOption(option => 
      option.setName('choice')
        .setDescription('Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ù…Ø§ (Ø´ÛŒØ± ÛŒØ§ Ø®Ø·)')
        .setRequired(true)
        .addChoices(
          { name: 'Ø´ÛŒØ±', value: 'Ø´ÛŒØ±' },
          { name: 'Ø®Ø·', value: 'Ø®Ø·' }
        )),

  new SlashCommandBuilder()
    .setName('dice')
    .setDescription('Ø¨Ø§Ø²ÛŒ ØªØ§Ø³')
    .addStringOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ')
        .setRequired(true))
    .addIntegerOption(option => 
      option.setName('number')
        .setDescription('Ø¹Ø¯Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ (1-6)')
        .setRequired(true)
        .setMinValue(1)
        .setMaxValue(6)),

  // ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ùˆ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
  new SlashCommandBuilder()
    .setName('shop')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ ÙØ±ÙˆØ´Ú¯Ø§Ù‡'),

  new SlashCommandBuilder()
    .setName('buy')
    .setDescription('Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ… Ø§Ø² ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
    .addIntegerOption(option => 
      option.setName('item')
        .setDescription('Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ… Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯')
        .setRequired(true)),

  new SlashCommandBuilder()
    .setName('inventory')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ'),

  // Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ùˆ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ  
  new SlashCommandBuilder()
    .setName('profile')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±'),

  new SlashCommandBuilder()
    .setName('leaderboard')
    .setDescription('Ù†Ù…Ø§ÛŒØ´ Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯ Ø«Ø±ÙˆØªÙ…Ù†Ø¯ØªØ±ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±Ø§Ù†'),

  // Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡
  new SlashCommandBuilder()
    .setName('transfer')
    .setDescription('Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø±')
    .addUserOption(option => 
      option.setName('target')
        .setDescription('Ú©Ø§Ø±Ø¨Ø± Ù‡Ø¯Ù Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡')
        .setRequired(true))
    .addStringOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± Ø³Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„')
        .setRequired(true)),
        
  // Ø³ÛŒØ³ØªÙ… ÙˆØ§Ù…
  new SlashCommandBuilder()
    .setName('loan')
    .setDescription('Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÙˆØ§Ù… Ø§Ø² Ø¨Ø§Ù†Ú©')
    .addStringOption(option => 
      option.setName('type')
        .setDescription('Ù†ÙˆØ¹ ÙˆØ§Ù… (Ù‡Ø± Ú©Ø¯Ø§Ù… Ø¨Ø§ Ø³ÙˆØ¯ Ùˆ Ø´Ø±Ø§ÛŒØ· Ù…ØªÙØ§ÙˆØª)')
        .setRequired(true)
        .addChoices(
          { name: 'Ú©Ù…â€ŒØ±ÛŒØ³Ú© (Ø³ÙˆØ¯ 5%ØŒ Ø­Ø¯Ø§Ú©Ø«Ø± 1000 Ø³Ú©Ù‡)', value: 'low' },
          { name: 'Ù…ØªÙˆØ³Ø· (Ø³ÙˆØ¯ 10%ØŒ Ø­Ø¯Ø§Ú©Ø«Ø± 5000 Ø³Ú©Ù‡)', value: 'medium' },
          { name: 'Ù¾Ø±Ø±ÛŒØ³Ú© (Ø³ÙˆØ¯ 20%ØŒ Ø­Ø¯Ø§Ú©Ø«Ø± 10000 Ø³Ú©Ù‡)', value: 'high' }
        ))
    .addIntegerOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ù… Ø¯Ø±Ø®ÙˆØ§Ø³ØªÛŒ')
        .setRequired(true)),
        
  new SlashCommandBuilder()
    .setName('repay')
    .setDescription('Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª ÙˆØ§Ù…')
    .addStringOption(option => 
      option.setName('amount')
        .setDescription('Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª (all Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ù…Ù„)')
        .setRequired(true)),
  
  // Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  new SlashCommandBuilder()
    .setName('blackmarket')
    .setDescription('Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ (ÙÙ‚Ø· Ø³Ø·Ø­ 20 Ø¨Ù‡ Ø¨Ø§Ù„Ø§)'),
    
  // Ø³ÛŒØ³ØªÙ… Ø§Ø±Ø¬Ø§Ø¹
  new SlashCommandBuilder()
    .setName('referral')
    .setDescription('Ø¯Ø±ÛŒØ§ÙØª Ú©Ø¯ Ø§Ø±Ø¬Ø§Ø¹ Ùˆ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ø§Ø¯Ø§Ø´â€ŒÙ‡Ø§ÛŒ Ø¯Ø¹ÙˆØª'),
    
  new SlashCommandBuilder()
    .setName('usecode')
    .setDescription('Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú©Ø¯ Ø§Ø±Ø¬Ø§Ø¹')
    .addStringOption(option => 
      option.setName('code')
        .setDescription('Ú©Ø¯ Ø§Ø±Ø¬Ø§Ø¹')
        .setRequired(true)),
  
  // Ø§Ø¹Ù„Ø§Ù… Ø±ÙˆÛŒØ¯Ø§Ø¯ ÙØµÙ„ÛŒ
  new SlashCommandBuilder()
    .setName('events')
    .setDescription('Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ÙØµÙ„ÛŒ ÙØ¹Ø§Ù„'),
    
  // Ø¯Ø³ØªÙˆØ± Ø³ÛŒØ³ØªÙ… Ø²Ù†Ø¯Ø§Ù† (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§)
  new SlashCommandBuilder()
    .setName('jail')
    .setDescription('Ø²Ù†Ø¯Ø§Ù†ÛŒ Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø± Ù…ØªØ®Ù„Ù')
    .addUserOption(option => 
      option.setName('user')
        .setDescription('Ú©Ø§Ø±Ø¨Ø± Ù…ØªØ®Ù„Ù')
        .setRequired(true))
    .addStringOption(option => 
      option.setName('reason')
        .setDescription('Ø¯Ù„ÛŒÙ„ Ø²Ù†Ø¯Ø§Ù†ÛŒ Ú©Ø±Ø¯Ù†')
        .setRequired(true))
    .addIntegerOption(option => 
      option.setName('days')
        .setDescription('Ù…Ø¯Øª Ø²Ù†Ø¯Ø§Ù† (Ø±ÙˆØ²)')
        .setRequired(true)
        .setMinValue(1)
        .setMaxValue(7)),
        
  // Ø³ÛŒØ³ØªÙ… Ø¢Ù…ÙˆØ²Ø´ÛŒ
  new SlashCommandBuilder()
    .setName('tutorial')
    .setDescription('Ø¢Ù…ÙˆØ²Ø´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø±Ø¨Ø§Øª Ø§Ù‚ØªØµØ§Ø¯ÛŒ'),
    
  // Ø³ÛŒØ³ØªÙ… Ø§Ù…Ù„Ø§Ú©
  new SlashCommandBuilder()
    .setName('properties')
    .setDescription('Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù…Ù„Ø§Ú© Ùˆ Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§'),
    
  new SlashCommandBuilder()
    .setName('buy-property')
    .setDescription('Ø®Ø±ÛŒØ¯ Ù…Ù„Ú©')
    .addIntegerOption(option => 
      option.setName('id')
        .setDescription('Ø´Ù…Ø§Ø±Ù‡ Ù…Ù„Ú©')
        .setRequired(true)),
        
  // Ø³ÛŒØ³ØªÙ… Ù„ÛŒÚ¯â€ŒÙ‡Ø§
  new SlashCommandBuilder()
    .setName('leagues')
    .setDescription('Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„ÛŒÚ¯â€ŒÙ‡Ø§ Ùˆ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†'),
];

// Register slash commands
client.once(Events.ClientReady, async () => {
  console.log(`${client.user.tag} Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ø¯!`);
  client.user.setActivity('Ø§Ù‚ØªØµØ§Ø¯ Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯ | /menu', { type: 'PLAYING' });

  // Register commands with Discord API
  try {
    console.log('Started refreshing application (/) commands.');

    const rest = new REST({ version: '10' }).setToken(process.env.TOKEN);

    await rest.put(
      Routes.applicationCommands(client.user.id),
      { body: slashCommands },
    );

    console.log('Successfully registered application commands.');
  } catch (error) {
    console.error(error);
  }

  // Set up recurring interest payments using cron - runs on the 1st day of each month at 00:00
  console.log('Setting up monthly bank interest using cron...');
  cron.schedule('0 0 1 * *', () => {
    console.log('Running scheduled monthly bank interest...');
    applyBankInterest();
  });
  
  // Set up daily reset for pickpocket counter - runs every day at midnight
  console.log('Setting up daily reset for pickpocket counter...');
  cron.schedule('0 0 * * *', () => {
    console.log('Running daily reset for pickpocket counter...');
    resetDailyPickpocketCounters();
  });
});


// Create a button handler function
const handleButton = async (interaction) => {
  const buttonId = interaction.customId;

  // Handle different button actions
  switch(buttonId) {
    // Ù…Ù†ÙˆÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
    case 'economy_menu':
      await showEconomyMenu(interaction);
      break;

    case 'games_menu':
      await showGamesMenu(interaction);
      break;

    case 'shop_menu':
      await showShopMenu(interaction);
      break;

    case 'profile_menu':
      await showProfileMenu(interaction);
      break;

    case 'quests_menu':
      await showQuestsMenu(interaction);
      break;

    case 'duel_menu':
      await showDuelMenu(interaction);
      break;

    case 'jackpot_menu':
      await showJackpotMenu(interaction);
      break;

    case 'admin_menu':
      await showAdminMenu(interaction);
      break;

    case 'main_menu':
      // Return to main menu
      await showMainMenu(interaction);
      break;

    // Ù…Ù†ÙˆÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§
    case 'skill_games_menu':
      await showSkillGamesMenu(interaction);
      break;

    case 'chance_games_menu':
      await showChanceGamesMenu(interaction);
      break;

    case 'competitive_games_menu':
      await showCompetitiveGamesMenu(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯
    case 'check_wallet':
      await checkBalance(interaction);
      break;

    case 'show_deposit_menu':
      await showDepositMenu(interaction);
      break;

    case 'show_withdraw_menu':
      await showWithdrawMenu(interaction);
      break;

    case 'show_transfer_menu':
      await showTransferMenu(interaction);
      break;

    case 'show_investment_menu':
      await showInvestmentMenu(interaction);
      break;

    case 'invest_short':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showInvestmentMenu(interaction);
      break;

    case 'invest_medium':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showInvestmentMenu(interaction);
      break;

    case 'invest_long':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showInvestmentMenu(interaction);
      break;

    case 'claim_daily':
      await claimDaily(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§
    case 'show_coinflip_menu':
      await showCoinFlipMenu(interaction);
      break;

    case 'show_dice_menu':
      await showDiceMenu(interaction);
      break;

    case 'show_rps_menu':
      await showRPSMenu(interaction);
      break;

    case 'show_guess_menu':
      await showGuessNumberMenu(interaction);
      break;

    case 'show_rob_menu':
      await showRobMenu(interaction);
      break;

    case 'show_slot_menu':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showChanceGamesMenu(interaction);
      break;

    case 'show_shooting_menu':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showSkillGamesMenu(interaction);
      break;

    case 'start_race':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showCompetitiveGamesMenu(interaction);
      break;

    case 'start_tournament':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showCompetitiveGamesMenu(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
    case 'show_shop_items':
      await showShop(interaction);
      break;

    case 'show_inventory':
      await showInventory(interaction);
      break;

    case 'show_buy_menu':
      await showBuyItemMenu(interaction);
      break;

    case 'show_sell_menu':
      await showSellMenu(interaction);
      break;

    case 'show_special_items':
      await showSpecialItems(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„
    case 'show_profile':
      await showProfile(interaction);
      break;

    case 'show_leaderboard':
      await showLeaderboard(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§
    case 'show_daily_quests':
      await showDailyQuests(interaction);
      break;

    case 'show_weekly_quests':
      await showWeeklyQuests(interaction);
      break;

    case 'claim_quest_reward':
      await claimQuestReward(interaction);
      break;

    case 'refresh_quests':
      await refreshQuests(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„
    case 'start_duel':
      await startDuel(interaction);
      break;

    case 'show_active_duels':
      await showActiveDuels(interaction);
      break;

    case 'place_bet':
      await placeBet(interaction);
      break;

    case 'show_leaderboard_duels':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showDuelMenu(interaction);
      break;

    case 'duel_stats':
      await showDuelStats(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ø¬Ú©Ù¾Ø§Øª
    case 'join_jackpot':
      await joinJackpot(interaction);
      break;

    case 'buy_ticket':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showJackpotMenu(interaction);
      break;

    case 'jackpot_winners':
      // Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
      await showJackpotMenu(interaction);
      break;

    // Ø§Ù‚Ø¯Ø§Ù…Ø§Øª Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª
    case 'admin_panel':
      await showAdminPanel(interaction);
      break;

    case 'manage_users':
      await showManageUsers(interaction);
      break;

    case 'economy_settings':
      await showEconomySettings(interaction);
      break;

    case 'reset_data':
      await showResetData(interaction);
      break;

    default:
      console.log(`Unknown button: ${buttonId}`);
  }
};

// Function to show main menu
async function showMainMenu(interaction) {
  // Ø¨Ø±Ø±Ø³ÛŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ÙØµÙ„ÛŒ ÙØ¹Ø§Ù„
  const isEventActive = await checkActiveEvents();
  const eventIcon = isEventActive ? 'ğŸ„' : 'ğŸ†';
  const eventStyle = isEventActive ? ButtonStyle.Danger : ButtonStyle.Secondary;
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø¢Ù…ÙˆØ²Ø´â€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ù†Ø´Ø¯Ù‡
  const hasUncompletedTutorial = await checkUncompletedTutorial(interaction.user.id);
  
  // Create the main menu embed
  const mainMenuEmbed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ¤– Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ Holi Coin')
    .setDescription('Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ Holi Coin Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸ¦ Ø§Ù‚ØªØµØ§Ø¯ Ùˆ Ø¨Ø§Ù†Ú©', value: 'Ù…Ø¯ÛŒØ±ÛŒØª Ú©ÛŒÙ Ù¾ÙˆÙ„ØŒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒØŒ ÙˆØ§Ù… Ùˆ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ', inline: true },
      { name: 'ğŸ® Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§', value: 'Ø³Ø±Ú¯Ø±Ù…ÛŒ Ùˆ Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ø³Ø¨ Ø³Ú©Ù‡', inline: true },
      { name: 'ğŸ›’ ÙØ±ÙˆØ´Ú¯Ø§Ù‡', value: 'Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ', inline: true },
      { name: 'ğŸ¯ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§', value: 'Ø§Ù†Ø¬Ø§Ù… Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ùˆ Ú©Ø³Ø¨ Ø¬Ø§ÛŒØ²Ù‡', inline: true },
      { name: 'âš”ï¸ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§', value: 'Ù…Ø¨Ø§Ø±Ø²Ù‡ Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø± Ùˆ Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ', inline: true },
      { name: 'ğŸ° Ø¬Ú©Ù¾Ø§Øª Ùˆ Ø¨Ø®Øªâ€ŒØ¢Ø²Ù…Ø§ÛŒÛŒ', value: 'Ø´Ø±Ú©Øª Ø¯Ø± Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯', inline: true },
      { name: 'ğŸ‘¤ Ù¾Ø±ÙˆÙØ§ÛŒÙ„', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ØŒ Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ùˆ Ù„ÛŒÚ¯â€ŒÙ‡Ø§', inline: true },
      { name: 'ğŸ˜ï¸ Ø§Ù…Ù„Ø§Ú© Ùˆ Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§', value: 'Ø®Ø±ÛŒØ¯ Ø§Ù…Ù„Ø§Ú© Ùˆ Ú©Ø³Ø¨ Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡', inline: true },
      { name: 'ğŸ› ï¸ Ù…Ø¯ÛŒØ±ÛŒØª', value: 'ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø±Ø¨Ø§Øª (Ù…Ø®ØµÙˆØµ Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§)', inline: false }
    )
    .setFooter({ text: 'Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù‡Ø± Ø¨Ø®Ø´ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Ù…Ø±Ø¨ÙˆØ·Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.' });

  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø¹Ù„Ø§Ù† Ø±ÙˆÛŒØ¯Ø§Ø¯ ÙØµÙ„ÛŒ Ø¯Ø± ØµÙˆØ±Øª ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯Ù†
  if (isEventActive) {
    const eventInfo = await getActiveEventInfo();
    mainMenuEmbed.addFields(
      { name: 'ğŸ„ Ø±ÙˆÛŒØ¯Ø§Ø¯ ÙØµÙ„ÛŒ ÙØ¹Ø§Ù„!', value: `${eventInfo.name} - ${eventInfo.description}\nØ²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ${eventInfo.timeLeft}`, inline: false }
    );
  }

  // Create buttons for main menu - Row 1
  const row1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø§Ù‚ØªØµØ§Ø¯ Ùˆ Ø¨Ø§Ù†Ú©')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ¦'),
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ®'),
      new ButtonBuilder()
        .setCustomId('shop_menu')
        .setLabel('ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ›’'),
      new ButtonBuilder()
        .setCustomId('quests_menu')
        .setLabel('Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ¯')
    );

  // Row 2
  const row2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('duel_menu')
        .setLabel('Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('âš”ï¸'),
      new ButtonBuilder()
        .setCustomId('jackpot_menu')
        .setLabel('Ø¬Ú©Ù¾Ø§Øª')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ°'),
      new ButtonBuilder()
        .setCustomId('profile_menu')
        .setLabel('Ù¾Ø±ÙˆÙØ§ÛŒÙ„')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ‘¤'),
      new ButtonBuilder()
        .setCustomId('properties_menu')
        .setLabel('Ø§Ù…Ù„Ø§Ú©')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ˜ï¸')
    );
    
  // Row 3 - ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
  const row3 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('events_menu')
        .setLabel('Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§')
        .setStyle(eventStyle)
        .setEmoji(eventIcon),
      new ButtonBuilder()
        .setCustomId('leagues_menu')
        .setLabel('Ù„ÛŒÚ¯â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ…'),
      new ButtonBuilder()
        .setCustomId('tutorial_menu')
        .setLabel('Ø¢Ù…ÙˆØ²Ø´')
        .setStyle(hasUncompletedTutorial ? ButtonStyle.Success : ButtonStyle.Secondary)
        .setEmoji('ğŸ“š'),
      new ButtonBuilder()
        .setCustomId('admin_menu')
        .setLabel('Ù…Ø¯ÛŒØ±ÛŒØª')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ› ï¸')
    );

  // Check if this is a new interaction or an update
  if (interaction.replied || interaction.deferred) {
    await interaction.update({ embeds: [mainMenuEmbed], components: [row1, row2, row3] });
  } else {
    await interaction.reply({ embeds: [mainMenuEmbed], components: [row1, row2, row3] });
  }
}

// Helper function to check active events
async function checkActiveEvents() {
  const events = await db.get('seasonal_events') || [];
  const now = Date.now();
  
  return events.some(event => event.startDate <= now && event.endDate >= now);
}

// Get active event information
async function getActiveEventInfo() {
  const events = await db.get('seasonal_events') || [];
  const now = Date.now();
  
  const activeEvent = events.find(event => event.startDate <= now && event.endDate >= now);
  
  if (!activeEvent) return null;
  
  const timeLeftMs = activeEvent.endDate - now;
  const days = Math.floor(timeLeftMs / (1000 * 60 * 60 * 24));
  const hours = Math.floor((timeLeftMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  
  return {
    name: activeEvent.name,
    description: activeEvent.description,
    timeLeft: `${days} Ø±ÙˆØ² Ùˆ ${hours} Ø³Ø§Ø¹Øª`
  };
}

// Helper function to check uncompleted tutorial for new users
async function checkUncompletedTutorial(userId) {
  const joinedAt = await db.get(`joined_at_${userId}`);
  if (!joinedAt) {
    // Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø§Ø³ØªØŒ Ø²Ù…Ø§Ù† Ø¹Ø¶ÙˆÛŒØª Ø±Ø§ Ø«Ø¨Øª Ú©Ù†
    await db.set(`joined_at_${userId}`, Date.now());
    return true;
  }
  
  const now = Date.now();
  const threeDaysMs = 3 * 24 * 60 * 60 * 1000;
  
  // Ø§Ú¯Ø± Ú©Ù…ØªØ± Ø§Ø² 3 Ø±ÙˆØ² Ø§Ø² Ø¹Ø¶ÙˆÛŒØª Ú¯Ø°Ø´ØªÙ‡ Ùˆ Ø¢Ù…ÙˆØ²Ø´ ØªÚ©Ù…ÛŒÙ„ Ù†Ø´Ø¯Ù‡
  if (now - joinedAt < threeDaysMs) {
    const tutorialCompleted = await db.get(`tutorial_completed_${userId}`);
    return !tutorialCompleted;
  }
  
  return false;
}

// Economy Menu
async function showEconomyMenu(interaction) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const bank = await db.get(`bank_${userId}`) || 0;
  
  // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ§Ù… ÙØ¹Ø§Ù„
  const activeLoan = await db.get(`loan_${userId}`);
  const loanInfoText = activeLoan 
    ? `ÙˆØ§Ù… ÙØ¹Ø§Ù„: **${activeLoan.amount}** ğŸª™ (Ù†ÙˆØ¹: ${getReadableLoanType(activeLoan.type)})\nØ³Ø±Ø±Ø³ÛŒØ¯: ${new Date(activeLoan.dueDate).toLocaleDateString('fa-IR')}\nØ³ÙˆØ¯: ${(activeLoan.interestRate * 100).toFixed(0)}%`
    : 'Ø´Ù…Ø§ ÙˆØ§Ù… ÙØ¹Ø§Ù„ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯.';
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø±ÙØ±Ø§Ù„ Ø¯Ø§Ø´ØªÙ‡
  const referrals = await db.get(`referrals_${userId}`) || [];
  const referralCount = referrals.length;
  const referralBonus = referralCount > 0 ? `Ø´Ù…Ø§ ${referralCount} Ù†ÙØ± Ø±Ø§ Ø¯Ø¹ÙˆØª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ Ùˆ ${referralCount * CONFIG.REFERRAL_BONUS_REFERRER} Ø³Ú©Ù‡ Ù¾Ø§Ø¯Ø§Ø´ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯!` : '';

  const economyEmbed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ¦ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯ Ùˆ Ø¨Ø§Ù†Ú©')
    .setDescription('Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù‚ØªØµØ§Ø¯ Ø®ÙˆØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ', value: `Ú©ÛŒÙ Ù¾ÙˆÙ„: **${wallet}** ğŸª™\nØ¨Ø§Ù†Ú©: **${bank}** ğŸª™\nÙ…Ø¬Ù…ÙˆØ¹: **${wallet + bank}** ğŸª™`, inline: false },
      { name: 'ğŸ’³ Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§Ù†Ú©ÛŒ', value: 'ÙˆØ§Ø±ÛŒØ²ØŒ Ø¨Ø±Ø¯Ø§Ø´Øª Ùˆ Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡', inline: true },
      { name: 'ğŸ“ˆ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ', value: 'Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ Ú©Ø³Ø¨ Ø³ÙˆØ¯', inline: true },
      { name: 'ğŸ Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡', value: 'Ø¯Ø±ÛŒØ§ÙØª Ø³Ú©Ù‡ Ø±Ø§ÛŒÚ¯Ø§Ù† Ø±ÙˆØ²Ø§Ù†Ù‡', inline: true },
      { name: 'ğŸ“Š Ø³ÙˆØ¯ Ø¨Ø§Ù†Ú©ÛŒ', value: `Ù†Ø±Ø® Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡: ${CONFIG.BANK_INTEREST_RATE * 100}%`, inline: true },
      { name: 'ğŸ›ï¸ ÙˆØ§Ù… Ø¨Ø§Ù†Ú©ÛŒ', value: loanInfoText, inline: false }
    )
    .setFooter({ text: 'Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ø¨Ø§Ù†Ú© Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ ØªØ§ Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!' });
    
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±ÙØ±Ø§Ù„ Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´Øª
  if (referralBonus) {
    economyEmbed.addFields({ name: 'ğŸ¤ Ø³ÛŒØ³ØªÙ… Ø§Ø±Ø¬Ø§Ø¹', value: referralBonus, inline: false });
  }

  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù‚ØªØµØ§Ø¯
  const economyRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('check_wallet')
        .setLabel('Ù…ÙˆØ¬ÙˆØ¯ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ’°'),
      new ButtonBuilder()
        .setCustomId('show_deposit_menu')
        .setLabel('ÙˆØ§Ø±ÛŒØ² Ø¨Ù‡ Ø¨Ø§Ù†Ú©')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ¦'),
      new ButtonBuilder()
        .setCustomId('show_withdraw_menu')
        .setLabel('Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø¨Ø§Ù†Ú©')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ’µ')
    );

  const economyRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_investment_menu')
        .setLabel('Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ“ˆ'),
      new ButtonBuilder()
        .setCustomId('show_transfer_menu')
        .setLabel('Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”„'),
      new ButtonBuilder()
        .setCustomId('claim_daily')
        .setLabel('Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ')
    );
    
  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ù… Ùˆ Ø§Ø±Ø¬Ø§Ø¹
  const economyRow3 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_loan_menu')
        .setLabel(activeLoan ? 'Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù…' : 'Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÙˆØ§Ù…')
        .setStyle(activeLoan ? ButtonStyle.Danger : ButtonStyle.Primary)
        .setEmoji('ğŸ›ï¸'),
      new ButtonBuilder()
        .setCustomId('show_repay_menu')
        .setLabel('Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª ÙˆØ§Ù…')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ’²')
        .setDisabled(!activeLoan),
      new ButtonBuilder()
        .setCustomId('show_referral_menu')
        .setLabel('Ø³ÛŒØ³ØªÙ… Ø§Ø±Ø¬Ø§Ø¹')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ¤')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [economyEmbed], components: [economyRow1, economyRow2, economyRow3, backRow] });
}

// Helper function to get readable loan type
function getReadableLoanType(loanType) {
  switch(loanType) {
    case 'low': return 'Ú©Ù…â€ŒØ±ÛŒØ³Ú©';
    case 'medium': return 'Ù…ØªÙˆØ³Ø·';
    case 'high': return 'Ù¾Ø±Ø±ÛŒØ³Ú©';
    default: return loanType;
  }
}

// Investment Menu
async function showInvestmentMenu(interaction) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const investments = await db.get(`investments_${userId}`) || [];
  const economyState = await db.get('economy_state') || 'normal'; // ÙˆØ¶Ø¹ÛŒØª Ø§Ù‚ØªØµØ§Ø¯ÛŒ: normal, boom, recession
  
  let investmentsList = '';
  let totalInvestment = 0;
  
  if (investments.length > 0) {
    investmentsList = '**Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ:**\n';
    investments.forEach((inv, index) => {
      const returnDate = new Date(inv.returnDate);
      const daysLeft = Math.ceil((returnDate - Date.now()) / (1000 * 60 * 60 * 24));
      investmentsList += `${index + 1}. **${inv.amount}** ğŸª™ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ **${inv.type}** - Ø¨Ø§Ø²Ú¯Ø´Øª Ø¯Ø± **${daysLeft}** Ø±ÙˆØ² Ø¯ÛŒÚ¯Ø± (Ø³ÙˆØ¯ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø´Ø¯Ù‡: **${inv.expectedProfit}** ğŸª™)\n`;
      totalInvestment += inv.amount;
    });
  } else {
    investmentsList = '**Ø´Ù…Ø§ Ù‡ÛŒÚ† Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ ÙØ¹Ø§Ù„ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯.**';
  }

  // ØªÙ†Ø¸ÛŒÙ… Ù†Ø±Ø® Ø³ÙˆØ¯ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ¶Ø¹ÛŒØª Ø§Ù‚ØªØµØ§Ø¯ÛŒ
  let economyStateText = '';
  let lowRiskRate = 5, mediumRiskRate = { min: 10, max: 20 }, highRiskRate = { min: 20, max: 50 };
  let economyIcon = 'ğŸ“Š';
  
  if (economyState === 'boom') {
    economyStateText = 'ğŸ”º Ø±ÙˆÙ†Ù‚ Ø§Ù‚ØªØµØ§Ø¯ÛŒ! Ø³ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§ÙØªÙ‡ Ø§Ø³Øª.';
    lowRiskRate = 7;
    mediumRiskRate = { min: 15, max: 25 };
    highRiskRate = { min: 30, max: 70 };
    economyIcon = 'ğŸ“ˆ';
  } else if (economyState === 'recession') {
    economyStateText = 'ğŸ”» Ø±Ú©ÙˆØ¯ Ø§Ù‚ØªØµØ§Ø¯ÛŒ! Ø³ÙˆØ¯ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ Ú©Ø§Ù‡Ø´ ÛŒØ§ÙØªÙ‡ Ø§Ø³Øª.';
    lowRiskRate = 3;
    mediumRiskRate = { min: 7, max: 15 };
    highRiskRate = { min: 10, max: 30 };
    economyIcon = 'ğŸ“‰';
  } else {
    economyStateText = 'ğŸ“Š ÙˆØ¶Ø¹ÛŒØª Ø§Ù‚ØªØµØ§Ø¯ÛŒ Ø¹Ø§Ø¯ÛŒ';
  }

  const investmentEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ“ˆ Ù…Ù†ÙˆÛŒ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡')
    .setDescription('Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø¨Ø§ Ø³Ø·ÙˆØ­ Ù…Ø®ØªÙ„Ù Ø±ÛŒØ³Ú©ØŒ Ø³ÙˆØ¯ Ù…ØªÙØ§ÙˆØª Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„', value: `**${wallet}** ğŸª™`, inline: true },
      { name: 'ğŸ“Š Ú©Ù„ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ', value: `**${totalInvestment}** ğŸª™`, inline: true },
      { name: `${economyIcon} ÙˆØ¶Ø¹ÛŒØª Ø§Ù‚ØªØµØ§Ø¯ÛŒ`, value: economyStateText, inline: false },
      { name: 'ğŸ“ˆ Ø§Ù†ÙˆØ§Ø¹ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ', value: 
        `**Ú©Ù…â€ŒØ±ÛŒØ³Ú© (Ø§Ù…Ù†)** - Ø³ÙˆØ¯ Ø³Ø§Ù„Ø§Ù†Ù‡: **${lowRiskRate}%** (Ø¨Ø¯ÙˆÙ† Ø±ÛŒØ³Ú©)\n` +
        `  â€¢ Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº: **1,000** ğŸª™ | Ø¯ÙˆØ±Ù‡: 7 Ø±ÙˆØ²\n\n` +
        `**Ø±ÛŒØ³Ú© Ù…ØªÙˆØ³Ø·** - Ø³ÙˆØ¯ Ø¨ÛŒÙ† **${mediumRiskRate.min}%** ØªØ§ **${mediumRiskRate.max}%**\n` +
        `  â€¢ Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº: **5,000** ğŸª™ | Ø¯ÙˆØ±Ù‡: 14 Ø±ÙˆØ²\n` +
        `  â€¢ Ø±ÛŒØ³Ú©: **10%** Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯Ù† **5%** Ø³Ø±Ù…Ø§ÛŒÙ‡\n\n` +
        `**Ù¾Ø±Ø±ÛŒØ³Ú©** - Ø³ÙˆØ¯ Ø¨ÛŒÙ† **${highRiskRate.min}%** ØªØ§ **${highRiskRate.max}%**\n` +
        `  â€¢ Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø¨Ù„Øº: **10,000** ğŸª™ | Ø¯ÙˆØ±Ù‡: 30 Ø±ÙˆØ²\n` +
        `  â€¢ Ø±ÛŒØ³Ú©: **30%** Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯Ù† **15%** Ø³Ø±Ù…Ø§ÛŒÙ‡`
        , inline: false },
      { name: '\u200B', value: investmentsList, inline: false }
    )
    .setFooter({ text: 'ØªÙˆØ¬Ù‡: Ù¾Ø³ Ø§Ø² Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒØŒ ØªØ§ Ø²Ù…Ø§Ù† Ø³Ø±Ø±Ø³ÛŒØ¯ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø±Ø¯Ø§Ø´Øª Ú©Ù†ÛŒØ¯!' });

  const investRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('invest_low_risk')
        .setLabel('Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ú©Ù…â€ŒØ±ÛŒØ³Ú©')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ›¡ï¸'),
      new ButtonBuilder()
        .setCustomId('invest_medium_risk')
        .setLabel('Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø§ Ø±ÛŒØ³Ú© Ù…ØªÙˆØ³Ø·')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('âš–ï¸')
    );
  
  const investRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('invest_high_risk')
        .setLabel('Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù¾Ø±Ø±ÛŒØ³Ú©')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ”¥'),
      new ButtonBuilder()
        .setCustomId('check_investments')
        .setLabel('Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [investmentEmbed], components: [investRow1, investRow2, backRow] });
}

// Games Menu
async function showGamesMenu(interaction) {
  const gamesEmbed = new EmbedBuilder()
    .setColor('#ff5555')
    .setTitle('ğŸ® Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
    .setDescription('Ø¨Ø§ Ø¨Ø§Ø²ÛŒ Ú©Ø±Ø¯Ù† Ùˆ Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ Ø³Ú©Ù‡ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯! Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø®Ø´ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸ¯ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ø§Ø±ØªÛŒ', value: 'Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…Ù‡Ø§Ø±Øª Ùˆ ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø¯Ø§Ø±Ù†Ø¯', inline: true },
      { name: 'ğŸ° Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ø§Ù†Ø³', value: 'Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ø§Ù†Ø³ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯', inline: true },
      { name: 'ğŸ† Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ', value: 'Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ Ø±Ù‚Ø§Ø¨Øª Ø¨ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', inline: true },
      { name: 'ğŸ’ Ø¬Ú©Ù¾Ø§Øª', value: 'Ø´Ø±Ú©Øª Ø¯Ø± Ø¬Ú©Ù¾Ø§Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§ Ø¬ÙˆØ§ÛŒØ² Ø¨Ø²Ø±Ú¯', inline: true },
      { name: 'ğŸŸï¸ Ø¨Ø®Øªâ€ŒØ¢Ø²Ù…Ø§ÛŒÛŒ', value: 'Ø´Ø±Ú©Øª Ø¯Ø± Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡', inline: true }
    )
    .setFooter({ text: 'Ù…Ø±Ø§Ù‚Ø¨ Ø¨Ø§Ø´ÛŒØ¯! Ø¯Ø± Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø³Ú©Ù‡ Ø§Ø² Ø¯Ø³Øª Ø¨Ø¯Ù‡ÛŒØ¯.' });

  const gamesRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('skill_games_menu')
        .setLabel('Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ø§Ø±ØªÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ¯'),
      new ButtonBuilder()
        .setCustomId('chance_games_menu')
        .setLabel('Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ø§Ù†Ø³')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ°'),
      new ButtonBuilder()
        .setCustomId('competitive_games_menu')
        .setLabel('Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ†')
    );

  const gamesRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('jackpot_menu')
        .setLabel('Ø¬Ú©Ù¾Ø§Øª')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ’'),
      new ButtonBuilder()
        .setCustomId('lottery_menu')
        .setLabel('Ø¨Ø®Øªâ€ŒØ¢Ø²Ù…Ø§ÛŒÛŒ')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸŸï¸')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [gamesEmbed], components: [gamesRow1, gamesRow2, backRow] });
}

// Skill Games Menu
async function showSkillGamesMenu(interaction) {
  const skillGamesEmbed = new EmbedBuilder()
    .setColor('#3498db')
    .setTitle('ğŸ¯ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ø§Ø±ØªÛŒ')
    .setDescription('Ø§ÛŒÙ† Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ Ù…Ù‡Ø§Ø±Øª Ùˆ ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±Ù†Ø¯. Ø´Ø§Ù†Ø³ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'âœ‚ï¸ Ø³Ù†Ú¯ Ú©Ø§ØºØ° Ù‚ÛŒÚ†ÛŒ', value: 'Ù…Ø¨Ø§Ø±Ø²Ù‡ Ø¨Ø§ Ø±Ø¨Ø§Øª Ø¯Ø± ÛŒÚ© Ø¨Ø§Ø²ÛŒ Ú©Ù„Ø§Ø³ÛŒÚ©', inline: true },
      { name: 'ğŸ”¢ Ø­Ø¯Ø³ Ø¹Ø¯Ø¯', value: 'ÛŒÚ© Ø¹Ø¯Ø¯ Ø¨ÛŒÙ† 1 ØªØ§ 10 Ø­Ø¯Ø³ Ø¨Ø²Ù†ÛŒØ¯', inline: true },
      { name: 'ğŸ¯ ØªÛŒØ±Ø§Ù†Ø¯Ø§Ø²ÛŒ', value: 'Ù‡Ø¯Ùâ€ŒÚ¯ÛŒØ±ÛŒ Ùˆ Ú©Ø³Ø¨ Ø§Ù…ØªÛŒØ§Ø²', inline: true }
    )
    .setFooter({ text: 'Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù‡Ø§Ø±Øª Ø®ÙˆØ¯ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!' });

  const skillGamesRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_rps_menu')
        .setLabel('Ø³Ù†Ú¯ Ú©Ø§ØºØ° Ù‚ÛŒÚ†ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('âœ‚ï¸'),
      new ButtonBuilder()
        .setCustomId('show_guess_menu')
        .setLabel('Ø­Ø¯Ø³ Ø¹Ø¯Ø¯')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ”¢'),
      new ButtonBuilder()
        .setCustomId('show_shooting_menu')
        .setLabel('ØªÛŒØ±Ø§Ù†Ø¯Ø§Ø²ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ¯')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [skillGamesEmbed], components: [skillGamesRow, backRow] });
}

// Chance Games Menu
async function showChanceGamesMenu(interaction) {
  const chanceGamesEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('ğŸ° Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ø§Ù†Ø³')
    .setDescription('Ø§ÛŒÙ† Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ø§Ù†Ø³ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯. Ø¨Ø®Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¨ÛŒØ§Ø²Ù…Ø§ÛŒÛŒØ¯!')
    .addFields(
      { name: 'ğŸª™ Ø´ÛŒØ± ÛŒØ§ Ø®Ø·', value: 'Ø´Ø§Ù†Ø³ 50/50 Ø¨Ø±Ø§ÛŒ Ø¯Ùˆ Ø¨Ø±Ø§Ø¨Ø± Ú©Ø±Ø¯Ù† Ø³Ú©Ù‡â€ŒÙ‡Ø§', inline: true },
      { name: 'ğŸ² ØªØ§Ø³', value: 'Ø­Ø¯Ø³ Ø¨Ø²Ù†ÛŒØ¯ ØªØ§Ø³ Ú†Ù‡ Ø¹Ø¯Ø¯ÛŒ Ù…ÛŒâ€ŒØ¢ÙˆØ±Ø¯ (Ø´Ø´ Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø±Ø¯)', inline: true },
      { name: 'ğŸ° Ø§Ø³Ù„Ø§Øª', value: 'Ù…Ø§Ø´ÛŒÙ† Ø§Ø³Ù„Ø§Øª Ø¨Ø§ Ø¬ÙˆØ§ÛŒØ² Ù…ØªÙ†ÙˆØ¹', inline: true },
      { name: 'ğŸ•µï¸ Ø¯Ø²Ø¯ÛŒ', value: 'Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø± (Ø¨Ø§ Ø±ÛŒØ³Ú© Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ)', inline: true }
    )
    .setFooter({ text: 'Ù…Ø±Ø§Ù‚Ø¨ Ø¨Ø§Ø´ÛŒØ¯! Ø¯Ø± Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ø§Ù†Ø³ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø³Ú©Ù‡ Ø§Ø² Ø¯Ø³Øª Ø¨Ø¯Ù‡ÛŒØ¯.' });

  const chanceGamesRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_coinflip_menu')
        .setLabel('Ø´ÛŒØ± ÛŒØ§ Ø®Ø·')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸª™'),
      new ButtonBuilder()
        .setCustomId('show_dice_menu')
        .setLabel('ØªØ§Ø³')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ²')
    );

  const chanceGamesRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_slot_menu')
        .setLabel('Ø§Ø³Ù„Ø§Øª')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ°'),
      new ButtonBuilder()
        .setCustomId('show_rob_menu')
        .setLabel('Ø¯Ø²Ø¯ÛŒ')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ•µï¸')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [chanceGamesEmbed], components: [chanceGamesRow1, chanceGamesRow2, backRow] });
}

// Competitive Games Menu
async function showCompetitiveGamesMenu(interaction) {
  const competitiveGamesEmbed = new EmbedBuilder()
    .setColor('#2ecc71')
    .setTitle('ğŸ† Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ')
    .setDescription('Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø± Ø±Ù‚Ø§Ø¨Øª Ú©Ù†ÛŒØ¯ Ùˆ Ø¬ÙˆØ§ÛŒØ² Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ÛŒ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!')
    .addFields(
      { name: 'âš”ï¸ Ø¯ÙˆØ¦Ù„', value: 'Ù…Ø¨Ø§Ø±Ø²Ù‡ ÛŒÚ© Ø¨Ù‡ ÛŒÚ© Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø±', inline: true },
      { name: 'ğŸ Ù…Ø³Ø§Ø¨Ù‚Ù‡', value: 'Ø´Ø±Ú©Øª Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ú¯Ø±ÙˆÙ‡ÛŒ', inline: true },
      { name: 'ğŸ¤¼ ØªÙˆØ±Ù†Ù…Ù†Øª', value: 'Ø´Ø±Ú©Øª Ø¯Ø± ØªÙˆØ±Ù†Ù…Ù†Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§ Ø¬ÙˆØ§ÛŒØ² Ø¨Ø²Ø±Ú¯', inline: true }
    )
    .setFooter({ text: 'Ø¨Ø§ Ø´Ú©Ø³Øª Ø¯Ø§Ø¯Ù† Ø±Ù‚Ø¨Ø§ØŒ Ø³Ú©Ù‡ Ùˆ Ø§Ø¹ØªØ¨Ø§Ø± Ø¨ÛŒØ´ØªØ±ÛŒ Ú©Ø³Ø¨ Ú©Ù†ÛŒØ¯!' });

  const competitiveGamesRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('start_duel')
        .setLabel('Ø¯ÙˆØ¦Ù„')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('âš”ï¸'),
      new ButtonBuilder()
        .setCustomId('start_race')
        .setLabel('Ù…Ø³Ø§Ø¨Ù‚Ù‡')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ'),
      new ButtonBuilder()
        .setCustomId('start_tournament')
        .setLabel('ØªÙˆØ±Ù†Ù…Ù†Øª')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ¤¼')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [competitiveGamesEmbed], components: [competitiveGamesRow, backRow] });
}

// Shop Menu
async function showShopMenu(interaction) {
  const shopEmbed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle('ğŸ›’ Ù…Ù†ÙˆÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
    .setDescription('Ø¨Ù‡ØªØ±ÛŒÙ† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ùˆ Ø§Ù…Ú©Ø§Ù†Ø§Øª ÙˆÛŒÚ˜Ù‡ Ø¯Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù…Ø§! Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø±ÛŒØ¯ Ùˆ ÙØ±ÙˆØ´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸ›ï¸ ÙØ±ÙˆØ´Ú¯Ø§Ù‡', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯', inline: true },
      { name: 'ğŸ’ Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡', inline: true },
      { name: 'ğŸ”„ Ø®Ø±ÛŒØ¯ Ùˆ ÙØ±ÙˆØ´', value: 'Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ ÛŒØ§ ÙØ±ÙˆØ´ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯', inline: true },
      { name: 'ğŸ† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡', value: 'Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ', inline: true }
    )
    .setFooter({ text: 'Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø¨Ù‡ Ø´Ù…Ø§ Ù…Ø²ÛŒØªâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡â€ŒØ§ÛŒ Ø¨Ø¯Ù‡Ù†Ø¯!' });

  const shopRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_shop_items')
        .setLabel('ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ›ï¸'),
      new ButtonBuilder()
        .setCustomId('show_inventory')
        .setLabel('Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ’')
    );
  
  const shopRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_buy_menu')
        .setLabel('Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ’°'),
      new ButtonBuilder()
        .setCustomId('show_sell_menu')
        .setLabel('ÙØ±ÙˆØ´ Ø¢ÛŒØªÙ…')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ”„'),
      new ButtonBuilder()
        .setCustomId('show_special_items')
        .setLabel('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ†')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [shopEmbed], components: [shopRow, shopRow2, backRow] });
}

// Sell Items Menu
async function showSellMenu(interaction) {
  const userId = interaction.user.id;
  const inventory = await db.get(`inventory_${userId}`) || [];
  
  let itemsList = '';
  
  if (inventory.length > 0) {
    itemsList = '**Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ:**\n';
    inventory.forEach((item, index) => {
      const sellPrice = Math.floor(item.price * 0.7); // 70% Ù‚ÛŒÙ…Øª Ø®Ø±ÛŒØ¯
      itemsList += `${index + 1}. ${item.icon} **${item.name}** - Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´: **${sellPrice}** ğŸª™\n`;
    });
  } else {
    itemsList = '**Ø´Ù…Ø§ Ù‡ÛŒÚ† Ø¢ÛŒØªÙ…ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´ Ù†Ø¯Ø§Ø±ÛŒØ¯.**';
  }

  const sellEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('ğŸ”„ ÙØ±ÙˆØ´ Ø¢ÛŒØªÙ…')
    .setDescription('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¨ÙØ±ÙˆØ´ÛŒØ¯ Ùˆ Ø³Ú©Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ÙØ±ÙˆØ´', value: 'Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´ Ø¢ÛŒØªÙ… Ø§Ø² Ø¯Ø³ØªÙˆØ± `/sell [Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ…]` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.', inline: false },
      { name: '\u200B', value: itemsList, inline: false },
      { name: 'âš ï¸ ØªÙˆØ¬Ù‡', value: 'Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ø§ **70%** Ù‚ÛŒÙ…Øª Ø®Ø±ÛŒØ¯ ÙØ±ÙˆØ®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯!', inline: false }
    )
    .setFooter({ text: 'Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´ØŒ Ø¢ÛŒØªÙ… Ø§Ø² Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ Ø´Ù…Ø§ Ø­Ø°Ù Ù…ÛŒâ€ŒØ´ÙˆØ¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('shop_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [sellEmbed], components: [backRow] });
}

// Special Items Menu
async function showSpecialItems(interaction) {
  const specialItemsEmbed = new EmbedBuilder()
    .setColor('#f1c40f')
    .setTitle('ğŸ† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡')
    .setDescription('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ!')
    .addFields(
      { name: 'ğŸ‘‘ ØªØ§Ø¬ Ø³Ù„Ø·Ù†ØªÛŒ', value: '**Ù‚ÛŒÙ…Øª: 25,000** ğŸª™\nÙ†Ø´Ø§Ù† ÙˆÛŒÚ˜Ù‡ Ø¯Ø± Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ùˆ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§Ù…Ú©Ø§Ù†Ø§Øª Ø§Ø®ØªØµØ§ØµÛŒ', inline: true },
      { name: 'ğŸ›¡ï¸ Ø³Ù¾Ø± Ø§Ù„Ù…Ø§Ø³', value: '**Ù‚ÛŒÙ…Øª: 15,000** ğŸª™\nÙ…Ø­Ø§ÙØ¸Øª Ú©Ø§Ù…Ù„ Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø¯Ø²Ø¯ÛŒ Ø¨Ù‡ Ù…Ø¯Øª 7 Ø±ÙˆØ²', inline: true },
      { name: 'ğŸ”® ØªÙˆÚ©Ù† Ø´Ø§Ù†Ø³', value: '**Ù‚ÛŒÙ…Øª: 5,000** ğŸª™\nØ§ÙØ²Ø§ÛŒØ´ 2 Ø¨Ø±Ø§Ø¨Ø±ÛŒ Ø´Ø§Ù†Ø³ Ø¨Ø±Ø¯ Ø¯Ø± ØªÙ…Ø§Ù… Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ Ù…Ø¯Øª 3 Ø±ÙˆØ²', inline: true },
      { name: 'â±ï¸ ØªØ³Ø±ÛŒØ¹â€ŒÚ©Ù†Ù†Ø¯Ù‡ Ø²Ù…Ø§Ù†', value: '**Ù‚ÛŒÙ…Øª: 7,500** ğŸª™\nÚ©Ø§Ù‡Ø´ 50% Ú©ÙˆÙ„Ø¯Ø§ÙˆÙ†â€ŒÙ‡Ø§ÛŒ ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ù‡ Ù…Ø¯Øª 5 Ø±ÙˆØ²', inline: true },
      { name: 'ğŸ’ Ø§Ù„Ù…Ø§Ø³ Ø¬Ø§Ø¯ÙˆÛŒÛŒ', value: '**Ù‚ÛŒÙ…Øª: 10,000** ğŸª™\nØ§ÙØ²Ø§ÛŒØ´ 50% ØªÙ…Ø§Ù… Ø¯Ø±Ø¢Ù…Ø¯Ù‡Ø§ Ø¨Ù‡ Ù…Ø¯Øª 3 Ø±ÙˆØ²', inline: true }
    )
    .setFooter({ text: 'Ø§ÛŒÙ† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ ÙÙ‚Ø· Ø¯Ø± Ù…Ù†Ø§Ø³Ø¨Øªâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ Ù‚Ø§Ø¨Ù„ Ø®Ø±ÛŒØ¯ Ù‡Ø³ØªÙ†Ø¯!' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('shop_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [specialItemsEmbed], components: [backRow] });
}

// Profile Menu
async function showProfileMenu(interaction) {
  const userId = interaction.user.id;
  const userLevel = await db.get(`level_${userId}`) || 1;
  const userXP = await db.get(`xp_${userId}`) || 0;
  const userJob = await db.get(`job_${userId}`) || 'none';
  const userSkills = await db.get(`skills_${userId}`) || [];
  
  // ØªØ¹ÛŒÛŒÙ† Ù†Ø§Ù… Ø´ØºÙ„
  let jobDisplay = 'Ø¨Ø¯ÙˆÙ† Ø´ØºÙ„';
  if (userJob === 'thief') jobDisplay = 'ğŸ¦¹â€â™‚ï¸ Ø¯Ø²Ø¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ';
  else if (userJob === 'trader') jobDisplay = 'ğŸ§™â€â™‚ï¸ ØªØ§Ø¬Ø±';
  else if (userJob === 'investor') jobDisplay = 'ğŸ’¼ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±';
  else if (userJob === 'warrior') jobDisplay = 'âš”ï¸ Ø¬Ù†Ú¯Ø¬Ùˆ';
  else if (userJob === 'mastermind') jobDisplay = 'ğŸ§  Ø°Ù‡Ù† Ù…Ø¯Ø¨Ø±';
  else if (userJob === 'gambler') jobDisplay = 'ğŸ² Ù‚Ù…Ø§Ø±Ø¨Ø§Ø²';
  
  const profileEmbed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('ğŸ‘¤ Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„')
    .setDescription('Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø®ÙˆØ¯ Ùˆ Ø³Ø§ÛŒØ± Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸªª Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ù†', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø®ÙˆØ¯', inline: true },
      { name: 'ğŸ… Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø«Ø±ÙˆØªÙ…Ù†Ø¯ØªØ±ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³Ø±ÙˆØ±', inline: true },
      { name: 'ğŸ“Š Ø¢Ù…Ø§Ø± Ù…Ù†', value: 'Ø¢Ù…Ø§Ø± Ø¯Ù‚ÛŒÙ‚ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§ Ø¯Ø± Ø³ÛŒØ³ØªÙ…', inline: true },
      { name: 'ğŸ‘” Ø´ØºÙ„ ÙØ¹Ù„ÛŒ', value: jobDisplay, inline: true },
      { name: 'ğŸ“‹ Ø³Ø·Ø­', value: `${userLevel} (XP: ${userXP})`, inline: true },
      { name: 'ğŸ† Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§', value: 'Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ú©Ø³Ø¨ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ø´Ù…Ø§', inline: true }
    )
    .setFooter({ text: 'Ø¨Ø§ ÙØ¹Ø§Ù„ÛŒØª Ø¨ÛŒØ´ØªØ±ØŒ Ø±ØªØ¨Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯ Ø¨Ø§Ù„Ø§ Ø¨Ø¨Ø±ÛŒØ¯!' });

  const profileRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_profile')
        .setLabel('Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ù…Ù†')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸªª'),
      new ButtonBuilder()
        .setCustomId('show_leaderboard')
        .setLabel('Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ…'),
      new ButtonBuilder()
        .setCustomId('show_statistics')
        .setLabel('Ø¢Ù…Ø§Ø± Ù…Ù†')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ“Š')
    );
    
  const profileRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_jobs')
        .setLabel('Ø³ÛŒØ³ØªÙ… Ø´ØºÙ„â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ‘”'),
      new ButtonBuilder()
        .setCustomId('show_skills')
        .setLabel('Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ù†')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ§ '),
      new ButtonBuilder()
        .setCustomId('show_achievements')
        .setLabel('Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ†')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [profileEmbed], components: [profileRow1, profileRow2, backRow] });
}

// Quests Menu
async function showQuestsMenu(interaction) {
  const questsEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ¯ Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
    .setDescription('Ø¨Ø§ Ø§Ù†Ø¬Ø§Ù… Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„ÙØŒ Ø¬ÙˆØ§ÛŒØ² Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'ğŸ“† Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡', value: 'Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ Ú©Ù‡ Ù‡Ø± Ø±ÙˆØ² ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯', inline: true },
      { name: 'ğŸ“… Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙØªÚ¯ÛŒ', value: 'Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ú†Ø§Ù„Ø´ÛŒâ€ŒØªØ± Ø¨Ø§ Ø¬ÙˆØ§ÛŒØ² Ø¨ÛŒØ´ØªØ±', inline: true },
      { name: 'ğŸ† Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡', value: 'Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ Ø¨Ø§ Ø¬ÙˆØ§ÛŒØ² Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯', inline: true },
      { name: 'ğŸ”„ ÙˆØ¶Ø¹ÛŒØª Ù¾ÛŒØ´Ø±ÙØª', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾ÛŒØ´Ø±ÙØª Ø¯Ø± Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ', inline: true }
    )
    .setFooter({ text: 'Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ ÛŒÚ©ÛŒ Ø§Ø² Ø¨Ù‡ØªØ±ÛŒÙ† Ø±Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø³Ø¨ Ø¯Ø±Ø¢Ù…Ø¯ Ù‡Ø³ØªÙ†Ø¯!' });

  const questsRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_daily_quests')
        .setLabel('Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ“œ'),
      new ButtonBuilder()
        .setCustomId('claim_quest_reward')
        .setLabel('Ø¯Ø±ÛŒØ§ÙØª Ø¬ÙˆØ§ÛŒØ²')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ†'),
      new ButtonBuilder()
        .setCustomId('refresh_quests')
        .setLabel('Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”„')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [questsEmbed], components: [questsRow, backRow] });
}

// Refresh Quests
async function refreshQuests(interaction) {
  const refreshQuestsEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
    .setDescription('Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯!')
    .addFields(
      { name: 'âœ… Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', value: 'Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ØŒ Ø¨Ù‡ Ø¨Ø®Ø´ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ Ø¨Ø±ÙˆÛŒØ¯.', inline: false }
    )
    .setFooter({ text: 'Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡ Ù‡Ø± Û²Û´ Ø³Ø§Ø¹Øª Ùˆ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙØªÚ¯ÛŒ Ù‡Ø± Û· Ø±ÙˆØ² Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('quests_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [refreshQuestsEmbed], components: [backRow] });
}

// Duel Menu
async function showDuelMenu(interaction) {
  const duelEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('âš”ï¸ Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„ Ùˆ Ø±Ù‚Ø§Ø¨Øªâ€ŒÙ‡Ø§')
    .setDescription('Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø± Ù…Ø¨Ø§Ø±Ø²Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ø±ÙˆÛŒ Ù†ØªÛŒØ¬Ù‡ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ Ø´Ø±Ø· Ø¨Ø¨Ù†Ø¯ÛŒØ¯!')
    .addFields(
      { name: 'âš”ï¸ Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¦Ù„', value: 'Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¯ÙˆØ¦Ù„ Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø±', inline: true },
      { name: 'ğŸ… Ø¨Ø±ØªØ±ÛŒÙ†â€ŒÙ‡Ø§', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„ÛŒØ³Øª Ø¨Ø±ØªØ±ÛŒÙ† Ø¯ÙˆØ¦Ù„â€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù†', inline: true },
      { name: 'ğŸ² Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ Ø±ÙˆÛŒ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§', value: 'Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ Ø±ÙˆÛŒ Ù†ØªÛŒØ¬Ù‡ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±Ø§Ù†', inline: true },
      { name: 'ğŸ“Š Ø¢Ù…Ø§Ø± Ø¯ÙˆØ¦Ù„', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø±Ø¯ Ùˆ Ø¨Ø§Ø®Øªâ€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§', inline: true }
    )
    .setFooter({ text: 'Ù‡ÛŒØ¬Ø§Ù†â€ŒØ§Ù†Ú¯ÛŒØ²ØªØ±ÛŒÙ† Ø¨Ø®Ø´ Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ Ù…Ø§!' });

  const duelRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('start_duel')
        .setLabel('Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¦Ù„')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('âš”ï¸'),
      new ButtonBuilder()
        .setCustomId('show_leaderboard_duels')
        .setLabel('Ø¨Ø±ØªØ±ÛŒÙ†â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ…')
    );

  const duelRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('show_active_duels')
        .setLabel('Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ‘ï¸'),
      new ButtonBuilder()
        .setCustomId('place_bet')
        .setLabel('Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ²'),
      new ButtonBuilder()
        .setCustomId('duel_stats')
        .setLabel('Ø¢Ù…Ø§Ø± Ù…Ù†')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ“Š')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [duelEmbed], components: [duelRow, duelRow2, backRow] });
}

// Duel Stats
async function showDuelStats(interaction) {
  const userId = interaction.user.id;
  const wins = await db.get(`duelWins_${userId}`) || 0;
  const losses = await db.get(`duelLosses_${userId}`) || 0;
  const totalDuels = wins + losses;
  const winrate = totalDuels > 0 ? Math.floor((wins / totalDuels) * 100) : 0;
  
  const statsEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle(`ğŸ“Š Ø¢Ù…Ø§Ø± Ø¯ÙˆØ¦Ù„ ${interaction.user.username}`)
    .setThumbnail(interaction.user.displayAvatarURL())
    .addFields(
      { name: 'ğŸ† ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø±Ø¯', value: `**${wins}**`, inline: true },
      { name: 'âŒ ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø§Ø®Øª', value: `**${losses}**`, inline: true },
      { name: 'ğŸ® Ú©Ù„ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§', value: `**${totalDuels}**`, inline: true },
      { name: 'ğŸ“ˆ Ø¯Ø±ØµØ¯ Ø¨Ø±Ø¯', value: `**${winrate}%**`, inline: true },
      { name: 'ğŸ’° Ø³Ú©Ù‡ Ú©Ø³Ø¨ Ø´Ø¯Ù‡ Ø§Ø² Ø¯ÙˆØ¦Ù„', value: `**${await db.get(`duelCoins_${userId}`) || 0}** ğŸª™`, inline: true }
    )
    .setFooter({ text: 'Ø¨Ø§ Ø´Ú©Ø³Øª Ø¯Ø§Ø¯Ù† Ø±Ù‚Ø¨Ø§ÛŒ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ØªØ±ØŒ Ø§Ù…ØªÛŒØ§Ø² Ùˆ Ø¬ÙˆØ§ÛŒØ² Ø¨ÛŒØ´ØªØ±ÛŒ Ú©Ø³Ø¨ Ú©Ù†ÛŒØ¯!' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('duel_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [statsEmbed], components: [backRow] });
}

// Jackpot Menu
async function showJackpotMenu(interaction) {
  const jackpotEmbed = new EmbedBuilder()
    .setColor('#f1c40f')
    .setTitle('ğŸ° Ù…Ù†ÙˆÛŒ Ø¬Ú©Ù¾Ø§Øª Ùˆ Ø¨Ø®Øªâ€ŒØ¢Ø²Ù…Ø§ÛŒÛŒ')
    .setDescription('Ø´Ø§Ù†Ø³ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯ Ùˆ Ø¬ÙˆØ§ÛŒØ² Ù‡Ù†Ú¯ÙØª Ø¨Ø¨Ø±ÛŒØ¯!')
    .addFields(
      { name: 'ğŸ’° Ø´Ø±Ú©Øª Ø¯Ø± Ø¬Ú©Ù¾Ø§Øª', value: 'Ø´Ø±Ú©Øª Ø¯Ø± Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ø¨Ø²Ø±Ú¯ Ùˆ Ø´Ø§Ù†Ø³ Ø¨Ø±Ø¯Ù† Ø¬Ø§ÛŒØ²Ù‡â€ŒÛŒ Ø§ØµÙ„ÛŒ', inline: true },
      { name: 'ğŸŸï¸ Ø®Ø±ÛŒØ¯ Ø¨Ù„ÛŒØ· Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ', value: 'Ø®Ø±ÛŒØ¯ Ø¨Ù„ÛŒØ· Ø¨Ø±Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ø´Ø§Ù†Ø³ Ø¨Ø±Ø¯Ù† Ø¬ÙˆØ§ÛŒØ² ÙˆÛŒÚ˜Ù‡', inline: true },
      { name: 'ğŸ† Ø¨Ø±Ù†Ø¯Ú¯Ø§Ù† Ø§Ø®ÛŒØ±', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„ÛŒØ³Øª Ø¨Ø±Ù†Ø¯Ú¯Ø§Ù† Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒâ€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ', inline: true },
      { name: 'â± Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡', value: 'Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡ ØªØ§ Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ø¨Ø¹Ø¯ÛŒ', inline: true }
    )
    .setFooter({ text: 'Ø¨Ø§ Ù‡Ø± Ø¨Ù„ÛŒØ·ØŒ Ø´Ø§Ù†Ø³ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø´Ù…Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯!' });

  const jackpotRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('join_jackpot')
        .setLabel('Ø´Ø±Ú©Øª Ø¯Ø± Ø¬Ú©Ù¾Ø§Øª')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ’°'),
      new ButtonBuilder()
        .setCustomId('buy_ticket')
        .setLabel('Ø®Ø±ÛŒØ¯ Ø¨Ù„ÛŒØ· Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸŸï¸'),
      new ButtonBuilder()
        .setCustomId('jackpot_winners')
        .setLabel('Ø¨Ø±Ù†Ø¯Ú¯Ø§Ù† Ø§Ø®ÛŒØ±')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ†')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [jackpotEmbed], components: [jackpotRow, backRow] });
}

// Join Jackpot
async function joinJackpot(interaction) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const jackpotAmount = await db.get('jackpot_amount') || 10000;
  const entryFee = 500; // Ù…Ù‚Ø¯Ø§Ø± ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø¬Ú©Ù¾Ø§Øª
  
  if (wallet < entryFee) {
    const errorEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('âŒ Ø®Ø·Ø§')
      .setDescription(`Ø´Ù…Ø§ Ø¨Ø±Ø§ÛŒ Ø´Ø±Ú©Øª Ø¯Ø± Ø¬Ú©Ù¾Ø§Øª Ø­Ø¯Ø§Ù‚Ù„ Ø¨Ù‡ **${entryFee}** ğŸª™ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯.`);
      
    const backRow = new ActionRowBuilder()
      .addComponents(
        new ButtonBuilder()
          .setCustomId('jackpot_menu')
          .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¬Ú©Ù¾Ø§Øª')
          .setStyle(ButtonStyle.Secondary)
          .setEmoji('â¬…ï¸')
      );
      
    return await interaction.update({ embeds: [errorEmbed], components: [backRow] });
  }
  
  // Ú©Ù… Ú©Ø±Ø¯Ù† Ù‡Ø²ÛŒÙ†Ù‡ ÙˆØ±ÙˆØ¯ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
  await db.sub(`wallet_${userId}`, entryFee);
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ù„ÛŒØ³Øª Ø´Ø±Ú©Øªâ€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù†
  const participants = await db.get('jackpot_participants') || [];
  participants.push(userId);
  await db.set('jackpot_participants', participants);
  
  // Ø§ÙØ²Ø§ÛŒØ´ Ù…Ø¨Ù„Øº Ø¬Ú©Ù¾Ø§Øª
  await db.add('jackpot_amount', entryFee * 0.8); // 80% Ù…Ø¨Ù„Øº Ø¨Ù‡ Ø¬Ú©Ù¾Ø§Øª Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
  
  const successEmbed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('âœ… Ø´Ø±Ú©Øª Ø¯Ø± Ø¬Ú©Ù¾Ø§Øª')
    .setDescription(`Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¬Ú©Ù¾Ø§Øª Ø´Ø±Ú©Øª Ú©Ø±Ø¯ÛŒØ¯!\nÙ…Ø¨Ù„Øº ÙØ¹Ù„ÛŒ Ø¬Ú©Ù¾Ø§Øª: **${jackpotAmount + (entryFee * 0.8)}** ğŸª™`)
    .addFields(
      { name: 'ğŸŸï¸ ØªØ¹Ø¯Ø§Ø¯ Ø´Ø±Ú©Øªâ€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù†', value: `**${participants.length}** Ù†ÙØ±`, inline: true },
      { name: 'ğŸ° Ø´Ø§Ù†Ø³ Ø¨Ø±Ø¯ Ø´Ù…Ø§', value: `**${(1 / participants.length * 100).toFixed(2)}%**`, inline: true },
      { name: 'â± Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡', value: 'Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒ Ø¨Ø¹Ø¯ÛŒ: **24 Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ø±**', inline: true }
    );
    
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('jackpot_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¬Ú©Ù¾Ø§Øª')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
    
  await interaction.update({ embeds: [successEmbed], components: [backRow] });
}

// Admin Menu
async function showAdminMenu(interaction) {
  // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ†
  const isAdmin = interaction.member.permissions.has('ADMINISTRATOR');
  
  if (!isAdmin) {
    const errorEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('âŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø­Ø¯ÙˆØ¯')
      .setDescription('Ø´Ù…Ø§ Ø¯Ø³ØªØ±Ø³ÛŒ Ù„Ø§Ø²Ù… Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø±Ø§ Ù†Ø¯Ø§Ø±ÛŒØ¯.')
      .setFooter({ text: 'Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…Ø®ØµÙˆØµ Ù…Ø¯ÛŒØ±Ø§Ù† Ø³Ø±ÙˆØ± Ø§Ø³Øª.' });
      
    const backRow = new ActionRowBuilder()
      .addComponents(
        new ButtonBuilder()
          .setCustomId('main_menu')
          .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
          .setStyle(ButtonStyle.Secondary)
          .setEmoji('â¬…ï¸')
      );
      
    return await interaction.update({ embeds: [errorEmbed], components: [backRow] });
  }
  
  const adminEmbed = new EmbedBuilder()
    .setColor('#34495e')
    .setTitle('ğŸ› ï¸ Ù…Ù†ÙˆÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª')
    .setDescription('Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±Ø¨Ø§Øª Ùˆ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸ”‘ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª', value: 'Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØµÙ„ÛŒ Ø±Ø¨Ø§Øª', inline: true },
      { name: 'ğŸ“Š Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', inline: true },
      { name: 'ğŸ’° ØªÙ†Ø¸ÛŒÙ… Ø§Ù‚ØªØµØ§Ø¯', value: 'ØªØºÛŒÛŒØ± Ù†Ø±Ø® Ø³ÙˆØ¯ØŒ Ù…Ø§Ù„ÛŒØ§Øª Ùˆ Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ù‚ØªØµØ§Ø¯ÛŒ', inline: true },
      { name: 'ğŸ”„ Ø±ÛŒØ³Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª', value: 'Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ùˆ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª', inline: true }
    )
    .setFooter({ text: 'ØªÙˆØ¬Ù‡: ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ø¨Ø± Ú©Ù„ Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ ØªØ£Ø«ÛŒØ± Ù…ÛŒâ€ŒÚ¯Ø°Ø§Ø±Ø¯!' });

  const adminRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('admin_panel')
        .setLabel('Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ”‘'),
      new ButtonBuilder()
        .setCustomId('manage_users')
        .setLabel('Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†')
        .setStyle(ButtonStyle.Secondary)

// Ù…Ù†ÙˆÛŒ ÙˆØ§Ù…
async function showLoanMenu(interaction) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const bank = await db.get(`bank_${userId}`) || 0;
  const activeLoan = await db.get(`loan_${userId}`);
  const userLevel = await db.get(`level_${userId}`) || 1;
  
  // Ø§Ú¯Ø± ÙˆØ§Ù… ÙØ¹Ø§Ù„ Ø¯Ø§Ø±Ø¯ØŒ Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù… Ø±Ø§ Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
  if (activeLoan) {
    return showActiveLoanMenu(interaction, activeLoan);
  }
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ Ø¨Ø±Ø§ÛŒ ÙˆØ§Ù… Ú¯Ø±ÙØªÙ†
  const minLevelForLoan = 5;
  if (userLevel < minLevelForLoan) {
    const errorEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('âš ï¸ Ø³Ø·Ø­ Ù†Ø§Ú©Ø§ÙÛŒ')
      .setDescription(`Ø´Ù…Ø§ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ ${minLevelForLoan} Ø¨Ø§Ø´ÛŒØ¯ ØªØ§ Ø¨ØªÙˆØ§Ù†ÛŒØ¯ ÙˆØ§Ù… Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯.`)
      .setFooter({ text: `Ø³Ø·Ø­ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§: ${userLevel}` });
      
    const backRow = new ActionRowBuilder()
      .addComponents(
        new ButtonBuilder()
          .setCustomId('economy_menu')
          .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
          .setStyle(ButtonStyle.Secondary)
          .setEmoji('â¬…ï¸')
      );
      
    return await interaction.update({ embeds: [errorEmbed], components: [backRow] });
  }
  
  // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø­Ø¯Ø§Ú©Ø«Ø± ÙˆØ§Ù… Ù‚Ø§Ø¨Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¨Ø±Ø§Ø³Ø§Ø³ Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø± Ùˆ Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§
  const maxEligibleLoan = Math.min(
    CONFIG.LOAN_TYPES.HIGH.maxAmount,
    Math.floor((wallet + bank) * 2)
  );
  
  // Ø§Ù†ÙˆØ§Ø¹ ÙˆØ§Ù…
  const loanEmbed = new EmbedBuilder()
    .setColor('#1abc9c')
    .setTitle('ğŸ›ï¸ Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÙˆØ§Ù… Ø¨Ø§Ù†Ú©ÛŒ')
    .setDescription('Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³ÛŒØ³ØªÙ… ÙˆØ§Ù…ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ Ø³Ø±Ø¹Øª Ø³Ú©Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯ØŒ Ø§Ù…Ø§ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ø³ÙˆØ¯ Ù…Ø´Ø®Øµ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ', value: `Ú©ÛŒÙ Ù¾ÙˆÙ„: **${wallet}** ğŸª™\nØ¨Ø§Ù†Ú©: **${bank}** ğŸª™\nÙ…Ø¬Ù…ÙˆØ¹: **${wallet + bank}** ğŸª™`, inline: false },
      { name: 'ğŸ“ Ø§Ù†ÙˆØ§Ø¹ ÙˆØ§Ù…', value: 
        `ğŸŸ¢ **ÙˆØ§Ù… Ú©Ù…â€ŒØ±ÛŒØ³Ú©**\n` +
        `â€¢ Ø­Ø¯Ø§Ú©Ø«Ø± Ù…Ù‚Ø¯Ø§Ø±: **${CONFIG.LOAN_TYPES.LOW.maxAmount}** ğŸª™\n` +
        `â€¢ Ù†Ø±Ø® Ø³ÙˆØ¯: **${CONFIG.LOAN_TYPES.LOW.interestRate * 100}%**\n` +
        `â€¢ Ù…Ø¯Øª Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª: **${CONFIG.LOAN_TYPES.LOW.durationDays}** Ø±ÙˆØ²\n\n` +
        
        `ğŸŸ¡ **ÙˆØ§Ù… Ù…ØªÙˆØ³Ø·**\n` +
        `â€¢ Ø­Ø¯Ø§Ú©Ø«Ø± Ù…Ù‚Ø¯Ø§Ø±: **${CONFIG.LOAN_TYPES.MEDIUM.maxAmount}** ğŸª™\n` +
        `â€¢ Ù†Ø±Ø® Ø³ÙˆØ¯: **${CONFIG.LOAN_TYPES.MEDIUM.interestRate * 100}%**\n` +
        `â€¢ Ù…Ø¯Øª Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª: **${CONFIG.LOAN_TYPES.MEDIUM.durationDays}** Ø±ÙˆØ²\n\n` +
        
        `ğŸ”´ **ÙˆØ§Ù… Ù¾Ø±Ø±ÛŒØ³Ú©**\n` +
        `â€¢ Ø­Ø¯Ø§Ú©Ø«Ø± Ù…Ù‚Ø¯Ø§Ø±: **${CONFIG.LOAN_TYPES.HIGH.maxAmount}** ğŸª™\n` +
        `â€¢ Ù†Ø±Ø® Ø³ÙˆØ¯: **${CONFIG.LOAN_TYPES.HIGH.interestRate * 100}%**\n` +
        `â€¢ Ù…Ø¯Øª Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª: **${CONFIG.LOAN_TYPES.HIGH.durationDays}** Ø±ÙˆØ²\n`,
        inline: false 
      },
      { name: 'âš ï¸ Ù‡Ø´Ø¯Ø§Ø±', value: 
        `â€¢ Ø¬Ø±ÛŒÙ…Ù‡ ØªØ£Ø®ÛŒØ±: **${CONFIG.LOAN_PENALTY_RATE * 100}%** Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„\n` +
        `â€¢ Ø­Ø¯Ø§Ú©Ø«Ø± ÙˆØ§Ù… Ù‚Ø§Ø¨Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ø±Ø§ÛŒ Ø´Ù…Ø§: **${maxEligibleLoan}** ğŸª™\n` +
        `â€¢ Ø´Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‡Ù…ÛŒØ´Ù‡ Ø²ÙˆØ¯ØªØ± Ø§Ø² Ù…ÙˆØ¹Ø¯ ÙˆØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†ÛŒØ¯!`,
        inline: false
      }
    )
    .setFooter({ text: 'ÙˆØ§Ù… ÙÙ‚Ø· Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ ÙˆØ§Ø±ÛŒØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ù†Ù‡ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ!' });
  
  // Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†ÙˆØ¹ ÙˆØ§Ù…
  const loanTypeRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('request_loan_low')
        .setLabel('ÙˆØ§Ù… Ú©Ù…â€ŒØ±ÛŒØ³Ú©')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸŸ¢'),
      new ButtonBuilder()
        .setCustomId('request_loan_medium')
        .setLabel('ÙˆØ§Ù… Ù…ØªÙˆØ³Ø·')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸŸ¡'),
      new ButtonBuilder()
        .setCustomId('request_loan_high')
        .setLabel('ÙˆØ§Ù… Ù¾Ø±Ø±ÛŒØ³Ú©')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ”´')
    );
  
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
  
  await interaction.update({ embeds: [loanEmbed], components: [loanTypeRow, backRow] });
}

// Ù†Ù…Ø§ÛŒØ´ Ù…Ù†ÙˆÛŒ ÙˆØ§Ù… ÙØ¹Ø§Ù„
async function showActiveLoanMenu(interaction, loan) {
  const userId = interaction.user.id;
  const now = Date.now();
  const dueDate = new Date(loan.dueDate);
  const daysLeft = Math.ceil((dueDate - now) / (1000 * 60 * 60 * 24));
  
  // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¨Ù„Øº Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ Ø§Ø­ØªØ³Ø§Ø¨ Ø³ÙˆØ¯
  const repaymentAmount = Math.floor(loan.amount * (1 + loan.interestRate));
  
  // ÙˆØ¶Ø¹ÛŒØª ÙˆØ§Ù…
  let statusText = '';
  let statusColor = '#1abc9c';
  
  if (daysLeft > 5) {
    statusText = `ğŸŸ¢ ÙˆØ¶Ø¹ÛŒØª ÙˆØ§Ù…: Ø¹Ø§Ø¯ÛŒ - ${daysLeft} Ø±ÙˆØ² ØªØ§ Ø³Ø±Ø±Ø³ÛŒØ¯`;
  } else if (daysLeft > 0) {
    statusText = `ğŸŸ¡ ÙˆØ¶Ø¹ÛŒØª ÙˆØ§Ù…: Ù†Ø²Ø¯ÛŒÚ© Ø¨Ù‡ Ø³Ø±Ø±Ø³ÛŒØ¯ - ${daysLeft} Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡`;
    statusColor = '#f39c12';
  } else {
    statusText = `ğŸ”´ ÙˆØ¶Ø¹ÛŒØª ÙˆØ§Ù…: Ú¯Ø°Ø´ØªÙ‡ Ø§Ø² Ø³Ø±Ø±Ø³ÛŒØ¯ - ${Math.abs(daysLeft)} Ø±ÙˆØ² Ø¯ÛŒØ±Ú©Ø±Ø¯`;
    statusColor = '#e74c3c';
  }
  
  const loanEmbed = new EmbedBuilder()
    .setColor(statusColor)
    .setTitle('ğŸ›ï¸ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ù… ÙØ¹Ø§Ù„')
    .setDescription(statusText)
    .addFields(
      { name: 'ğŸ’° Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙˆØ§Ù…', value: 
        `Ù†ÙˆØ¹ ÙˆØ§Ù…: **${getReadableLoanType(loan.type)}**\n` +
        `Ù…Ø¨Ù„Øº Ø§ØµÙ„ÛŒ: **${loan.amount}** ğŸª™\n` +
        `Ù†Ø±Ø® Ø³ÙˆØ¯: **${(loan.interestRate * 100).toFixed(0)}%**\n` +
        `Ù…Ø¨Ù„Øº Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª: **${repaymentAmount}** ğŸª™\n` +
        `ØªØ§Ø±ÛŒØ® Ø¯Ø±ÛŒØ§ÙØª: ${new Date(loan.date).toLocaleDateString('fa-IR')}\n` +
        `ØªØ§Ø±ÛŒØ® Ø³Ø±Ø±Ø³ÛŒØ¯: ${dueDate.toLocaleDateString('fa-IR')}`,
        inline: false 
      },
      { name: 'âš ï¸ Ù‡Ø´Ø¯Ø§Ø±', value: 
        `â€¢ Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª ØªØ§ ØªØ§Ø±ÛŒØ® Ø³Ø±Ø±Ø³ÛŒØ¯ØŒ **${CONFIG.LOAN_PENALTY_RATE * 100}%** Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¬Ø±ÛŒÙ…Ù‡ Ú©Ø³Ø± Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.\n` +
        `â€¢ Ù¾Ø³ Ø§Ø² Ø§Ø¹Ù…Ø§Ù„ Ø¬Ø±ÛŒÙ…Ù‡ØŒ Ù…Ù‡Ù„Øª Ø¬Ø¯ÛŒØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª ÙˆØ§Ù… Ø¨Ù‡ Ø´Ù…Ø§ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.`,
        inline: false
      }
    )
    .setFooter({ text: 'ØªÙˆØµÛŒÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ ÙˆØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ù‚Ø¨Ù„ Ø§Ø² Ø³Ø±Ø±Ø³ÛŒØ¯ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†ÛŒØ¯!' });
  
  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª
  const repaymentButtons = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('repay_loan_full')
        .setLabel(`Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ù…Ù„ (${repaymentAmount} ğŸª™)`)
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ’°'),
      new ButtonBuilder()
        .setCustomId('repay_loan_partial')
        .setLabel('Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø®Ø´ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ’²')
    );
  
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
  
  await interaction.update({ embeds: [loanEmbed], components: [repaymentButtons, backRow] });
}

// Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÙˆØ§Ù…
async function processLoanRequest(interaction, loanType) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const bank = await db.get(`bank_${userId}`) || 0;
  const totalAssets = wallet + bank;
  
  // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù†ÙˆØ¹ ÙˆØ§Ù…
  const loanConfig = CONFIG.LOAN_TYPES[loanType.toUpperCase()];
  if (!loanConfig) {
    return await interaction.reply({ content: 'âŒ Ù†ÙˆØ¹ ÙˆØ§Ù… Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª!', ephemeral: true });
  }
  
  // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø­Ø¯Ø§Ú©Ø«Ø± ÙˆØ§Ù… Ù‚Ø§Ø¨Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¨Ø±Ø§Ø³Ø§Ø³ Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
  const maxEligibleByAssets = Math.floor(totalAssets * 2);
  const maxLoanAmount = Math.min(loanConfig.maxAmount, maxEligibleByAssets);
  
  // Ø§ÛŒØ¬Ø§Ø¯ Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ù…
  const modal = new ModalBuilder()
    .setCustomId(`loan_modal_${loanType}`)
    .setTitle(`Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÙˆØ§Ù… ${getReadableLoanType(loanType)}`);
  
  const amountInput = new TextInputBuilder()
    .setCustomId('loan_amount')
    .setLabel(`Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ù… (Ø­Ø¯Ø§Ú©Ø«Ø± ${maxLoanAmount} Ø³Ú©Ù‡)`)
    .setPlaceholder('Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯...')
    .setMinLength(1)
    .setMaxLength(10)
    .setRequired(true)
    .setStyle(TextInputStyle.Short);
  
  const actionRow = new ActionRowBuilder().addComponents(amountInput);
  modal.addComponents(actionRow);
  
  await interaction.showModal(modal);
}

// Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª ÙˆØ§Ù…
async function processLoanRepayment(interaction, fullRepayment = true) {
  const userId = interaction.user.id;
  const loan = await db.get(`loan_${userId}`);
  
  if (!loan) {
    return await interaction.reply({ content: 'âŒ Ø´Ù…Ø§ ÙˆØ§Ù… ÙØ¹Ø§Ù„ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });
  }
  
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const repaymentAmount = Math.floor(loan.amount * (1 + loan.interestRate));
  
  if (fullRepayment) {
    // Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ù…Ù„
    if (wallet < repaymentAmount) {
      return await interaction.reply({ 
        content: `âŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ù†Ø§Ú©Ø§ÙÛŒ Ø§Ø³Øª! Ø´Ù…Ø§ Ø¨Ù‡ ${repaymentAmount} Ø³Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ù…Ù„ Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯ØŒ Ø§Ù…Ø§ ÙÙ‚Ø· ${wallet} Ø³Ú©Ù‡ Ø¯Ø§Ø±ÛŒØ¯.`, 
        ephemeral: true 
      });
    }
    
    // Ú©Ø³Ø± Ù…Ø¨Ù„Øº Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
    await db.sub(`wallet_${userId}`, repaymentAmount);
    // Ø­Ø°Ù ÙˆØ§Ù…
    await db.delete(`loan_${userId}`);
    
    const successEmbed = new EmbedBuilder()
      .setColor('#00ff00')
      .setTitle('âœ… Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚')
      .setDescription(`ÙˆØ§Ù… Ø´Ù…Ø§ Ø¨Ù‡ Ù…Ø¨Ù„Øº **${repaymentAmount}** ğŸª™ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯!\nØ§Ø¹ØªØ¨Ø§Ø± Ø´Ù…Ø§ Ù†Ø²Ø¯ Ø¨Ø§Ù†Ú© Ø§ÙØ²Ø§ÛŒØ´ ÛŒØ§ÙØª.`)
      .setFooter({ text: 'Ø§Ú©Ù†ÙˆÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ÙˆØ§Ù… Ø¬Ø¯ÛŒØ¯ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ú©Ù†ÛŒØ¯.' });
    
    await interaction.reply({ embeds: [successEmbed] });
    
    // Ø§ÙØ²Ø§ÛŒØ´ Ø§Ø¹ØªØ¨Ø§Ø± Ú©Ø§Ø±Ø¨Ø±
    await db.add(`credit_score_${userId}`, 5);
    
  } else {
    // Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø®Ø´ÛŒ - Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¯Ø§Ù„
    const modal = new ModalBuilder()
      .setCustomId('partial_repayment_modal')
      .setTitle('Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø®Ø´ÛŒ Ø§Ø² ÙˆØ§Ù…');
    
    const amountInput = new TextInputBuilder()
      .setCustomId('repayment_amount')
      .setLabel(`Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª (Ø­Ø¯Ø§Ú©Ø«Ø± ${wallet} Ø³Ú©Ù‡)`)
      .setPlaceholder('Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯...')
      .setMinLength(1)
      .setMaxLength(10)
      .setRequired(true)
      .setStyle(TextInputStyle.Short);
    
    const actionRow = new ActionRowBuilder().addComponents(amountInput);
    modal.addComponents(actionRow);
    
    await interaction.showModal(modal);
  }
}

// Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø®Ø´ÛŒ ÙˆØ§Ù…
async function processPartialRepayment(interaction, amount) {
  const userId = interaction.user.id;
  const loan = await db.get(`loan_${userId}`);
  
  if (!loan) {
    return await interaction.reply({ content: 'âŒ Ø´Ù…Ø§ ÙˆØ§Ù… ÙØ¹Ø§Ù„ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });
  }
  
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const repaymentAmount = Math.floor(loan.amount * (1 + loan.interestRate));
  const remainingDebt = repaymentAmount;
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‚Ø¯Ø§Ø± ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡
  if (isNaN(amount) || amount <= 0) {
    return await interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }
  
  if (amount > wallet) {
    return await interaction.reply({ 
      content: `âŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ù†Ø§Ú©Ø§ÙÛŒ Ø§Ø³Øª! Ø´Ù…Ø§ ÙÙ‚Ø· ${wallet} Ø³Ú©Ù‡ Ø¯Ø§Ø±ÛŒØ¯.`, 
      ephemeral: true 
    });
  }
  

// Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
async function showBlackMarketMenu(interaction) {
  const userId = interaction.user.id;
  const userLevel = await db.get(`level_${userId}`) || 1;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø± Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  if (userLevel < CONFIG.BLACK_MARKET_MIN_LEVEL) {
    const errorEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('â›” Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø­Ø¯ÙˆØ¯')
      .setDescription(`Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³Ø·Ø­ ${CONFIG.BLACK_MARKET_MIN_LEVEL}+ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª.`)
      .setFooter({ text: `Ø³Ø·Ø­ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§: ${userLevel}` });
      
    const backRow = new ActionRowBuilder()
      .addComponents(
        new ButtonBuilder()
          .setCustomId('shop_menu')
          .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
          .setStyle(ButtonStyle.Secondary)
          .setEmoji('â¬…ï¸')
      );
      
    return await interaction.update({ embeds: [errorEmbed], components: [backRow] });
  }
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  const blackMarketItems = [
    { 
      id: 501, 
      name: 'ğŸ”« Ø§Ø³Ù„Ø­Ù‡ ØªÙ‚Ù„Ø¨ÛŒ', 
      price: 12000, 
      description: '+20% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒØŒ Ø§Ù…Ø§ 30% Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ!',
      effects: 'Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø¢ÛŒØªÙ…ØŒ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø´Ù…Ø§ Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ 20% Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯ØŒ Ø§Ù…Ø§ Ø±ÛŒØ³Ú© Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ù†ÛŒØ² 30% Ø¨Ø§Ù„Ø§ØªØ± Ù…ÛŒâ€ŒØ±ÙˆØ¯.',
      durability: 5
    },
    { 
      id: 502, 
      name: 'ğŸ’¼ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¬Ø¹Ù„ÛŒ', 
      price: 8000, 
      description: 'Ù…Ø®ÙÛŒâ€ŒØ³Ø§Ø²ÛŒ 50% Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø¯Ø²Ø¯Ù‡Ø§',
      effects: 'Ù‡Ù†Ú¯Ø§Ù… Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø§Ø² Ø´Ù…Ø§ØŒ ÙÙ‚Ø· Ù†ÛŒÙ…ÛŒ Ø§Ø² Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§ Ù‚Ø§Ø¨Ù„ Ø³Ø±Ù‚Øª Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.',
      durability: 3
    },
    { 
      id: 503, 
      name: 'ğŸ¥· Ù„Ø¨Ø§Ø³ Ù†ÛŒÙ†Ø¬Ø§', 
      price: 15000, 
      description: 'Ø§Ù…Ú©Ø§Ù† Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú© Ø§ÙØ±Ø§Ø¯ + Ú©Ø§Ù‡Ø´ 40% Ø§Ø­ØªÙ…Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ',
      effects: 'Ø¨Ø§ Ø§ÛŒÙ† Ù„Ø¨Ø§Ø³ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø§ÙØ±Ø§Ø¯ Ù‡Ù… Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø§Ø­ØªÙ…Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ù…Ø§ 40% Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯.',
      durability: 2
    },
    { 
      id: 504, 
      name: 'ğŸ” Ù‚ÙÙ„ Ø´Ú©Ù† Ù¾ÛŒØ´Ø±ÙØªÙ‡', 
      price: 20000, 
      description: 'Ø§Ù…Ú©Ø§Ù† Ø¯Ø²Ø¯ÛŒ Ø§Ø² ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù…Ø§Ù†Ø§Øª Ø¨Ø§Ù†Ú© Ø¨Ø§ Ø´Ø§Ù†Ø³ Ú©Ù…',
      effects: 'Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ Ø§Ø² ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù…Ø§Ù†Ø§Øª Ø¨Ø§Ù†Ú© Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ ØªØ§ 50,000 Ø³Ú©Ù‡ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!',
      durability: 1
    },
    { 
      id: 505, 
      name: 'ğŸ“¦ Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ²', 
      price: 25000, 
      description: 'Ø­Ø§ÙˆÛŒ Ø¬ÙˆØ§ÛŒØ² Ø¨Ø§ Ø§Ø±Ø²Ø´ ÛŒØ§ Ø®Ø·Ø±Ù†Ø§Ú©!',
      effects: 'Ø¬Ø¹Ø¨Ù‡â€ŒØ§ÛŒ Ø´Ú¯ÙØªâ€ŒØ§Ù†Ú¯ÛŒØ² Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø­Ø§ÙˆÛŒ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ±Ø§ÙˆØ§Ù† ÛŒØ§ Ø¬ÙˆØ§ÛŒØ² ÙˆÛŒÚ˜Ù‡ Ø¨Ø§Ø´Ø¯ØŒ Ø§Ù…Ø§ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø®Ø·Ø±Ù†Ø§Ú© Ø¨Ø§Ø´Ø¯!',
      durability: 1
    }
  ];
  
  // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø¨Ø±
  const affordableItems = blackMarketItems.filter(item => item.price <= wallet);
  
  // Ø³Ø§Ø®Øª Ø±Ù†Ú¯ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø§Ù…Ø¨Ø¯
  const randomHex = () => {
    const darkColors = ['#8e44ad', '#2c3e50', '#c0392b', '#d35400', '#7f8c8d'];
    return darkColors[Math.floor(Math.random() * darkColors.length)];
  };
  
  const blackMarketEmbed = new EmbedBuilder()
    .setColor(randomHex())
    .setTitle('ğŸ´â€â˜ ï¸ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡')
    .setDescription('Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯... Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®Ø§Øµ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ù‚Ø§Ù†ÙˆÙ†ÛŒ! Ù…Ø±Ø§Ù‚Ø¨ Ø¨Ø§Ø´ÛŒØ¯ØŒ Ù‡Ø± Ø®Ø±ÛŒØ¯ Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªÙˆØ¬Ù‡ Ù¾Ù„ÛŒØ³ Ø±Ø§ Ø¬Ù„Ø¨ Ú©Ù†Ø¯...')
    .addFields(
      { name: 'âš ï¸ Ù‡Ø´Ø¯Ø§Ø±', value: `Ù‡Ø± Ø®Ø±ÛŒØ¯ **${CONFIG.BLACK_MARKET_BUST_CHANCE * 100}%** Ø´Ø§Ù†Ø³ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ùˆ Ø²Ù†Ø¯Ø§Ù†ÛŒ Ø´Ø¯Ù† Ø¯Ø§Ø±Ø¯!`, inline: false },
      { name: 'ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø´Ù…Ø§', value: `**${wallet}** ğŸª™`, inline: false }
    )
    .setFooter({ text: 'Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ø¨Ù‡ Ù…Ù†Ø²Ù„Ù‡ Ù‚Ø¨ÙˆÙ„ Ø±ÛŒØ³Ú© Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ø§Ø³Øª!' });
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ù‡ Ø§Ù…Ø¨Ø¯
  blackMarketItems.forEach(item => {
    const affordableText = wallet >= item.price ? 'âœ…' : 'âŒ';
    blackMarketEmbed.addFields({ 
      name: `${item.name} (${item.price} ğŸª™) ${affordableText}`, 
      value: `${item.description}\n**Ø¯ÙˆØ§Ù…:** ${item.durability} Ø¨Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡`, 
      inline: false 
    });
  });
  
  // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ù†ÙˆÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø¢ÛŒØªÙ…
  const selectMenu = new StringSelectMenuBuilder()
    .setCustomId('black_market_select')
    .setPlaceholder('ÛŒÚ© Ø¢ÛŒØªÙ… Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...')
    .addOptions(
      blackMarketItems.map(item => ({
        label: `${item.name} (${item.price} ğŸª™)`,
        value: item.id.toString(),
        description: item.description.substring(0, 100),
        emoji: item.name.split(' ')[0],
        default: false
      }))
    );
  
  // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù…Ù†Ùˆ Ø§Ú¯Ø± Ù‡Ù…Ù‡ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø®Ø±ÛŒØ¯ Ø¨Ø§Ø´Ù†Ø¯
  if (affordableItems.length === 0) {
    selectMenu.setDisabled(true);
    selectMenu.setPlaceholder('Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ù‡ÛŒÚ† Ø¢ÛŒØªÙ…ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯!');
  }
  
  const selectRow = new ActionRowBuilder().addComponents(selectMenu);
  
  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
  const actionRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('view_black_market_inventory')
        .setLabel('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ù…Ù†')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ”'),
      new ButtonBuilder()
        .setCustomId('black_market_info')
        .setLabel('Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â„¹ï¸')
    );
  
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('shop_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
  
  await interaction.update({ embeds: [blackMarketEmbed], components: [selectRow, actionRow, backRow] });
}

// Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
async function processBlackMarketPurchase(interaction, itemId) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  const blackMarketItems = [
    { 
      id: 501, 
      name: 'ğŸ”« Ø§Ø³Ù„Ø­Ù‡ ØªÙ‚Ù„Ø¨ÛŒ', 
      price: 12000, 
      description: '+20% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒØŒ Ø§Ù…Ø§ 30% Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ!',
      effects: 'Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø¢ÛŒØªÙ…ØŒ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø´Ù…Ø§ Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ 20% Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯ØŒ Ø§Ù…Ø§ Ø±ÛŒØ³Ú© Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ù†ÛŒØ² 30% Ø¨Ø§Ù„Ø§ØªØ± Ù…ÛŒâ€ŒØ±ÙˆØ¯.',
      durability: 5
    },
    { 
      id: 502, 
      name: 'ğŸ’¼ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¬Ø¹Ù„ÛŒ', 
      price: 8000, 
      description: 'Ù…Ø®ÙÛŒâ€ŒØ³Ø§Ø²ÛŒ 50% Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø¯Ø²Ø¯Ù‡Ø§',
      effects: 'Ù‡Ù†Ú¯Ø§Ù… Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø§Ø² Ø´Ù…Ø§ØŒ ÙÙ‚Ø· Ù†ÛŒÙ…ÛŒ Ø§Ø² Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§ Ù‚Ø§Ø¨Ù„ Ø³Ø±Ù‚Øª Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.',
      durability: 3
    },
    { 
      id: 503, 
      name: 'ğŸ¥· Ù„Ø¨Ø§Ø³ Ù†ÛŒÙ†Ø¬Ø§', 
      price: 15000, 
      description: 'Ø§Ù…Ú©Ø§Ù† Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú© Ø§ÙØ±Ø§Ø¯ + Ú©Ø§Ù‡Ø´ 40% Ø§Ø­ØªÙ…Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ',
      effects: 'Ø¨Ø§ Ø§ÛŒÙ† Ù„Ø¨Ø§Ø³ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø§ÙØ±Ø§Ø¯ Ù‡Ù… Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø§Ø­ØªÙ…Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ù…Ø§ 40% Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯.',
      durability: 2
    },
    { 
      id: 504, 
      name: 'ğŸ” Ù‚ÙÙ„ Ø´Ú©Ù† Ù¾ÛŒØ´Ø±ÙØªÙ‡', 
      price: 20000, 
      description: 'Ø§Ù…Ú©Ø§Ù† Ø¯Ø²Ø¯ÛŒ Ø§Ø² ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù…Ø§Ù†Ø§Øª Ø¨Ø§Ù†Ú© Ø¨Ø§ Ø´Ø§Ù†Ø³ Ú©Ù…',
      effects: 'Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ Ø§Ø² ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù…Ø§Ù†Ø§Øª Ø¨Ø§Ù†Ú© Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ ØªØ§ 50,000 Ø³Ú©Ù‡ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!',
      durability: 1
    },
    { 
      id: 505, 
      name: 'ğŸ“¦ Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ²', 
      price: 25000, 
      description: 'Ø­Ø§ÙˆÛŒ Ø¬ÙˆØ§ÛŒØ² Ø¨Ø§ Ø§Ø±Ø²Ø´ ÛŒØ§ Ø®Ø·Ø±Ù†Ø§Ú©!',
      effects: 'Ø¬Ø¹Ø¨Ù‡â€ŒØ§ÛŒ Ø´Ú¯ÙØªâ€ŒØ§Ù†Ú¯ÛŒØ² Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø­Ø§ÙˆÛŒ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ±Ø§ÙˆØ§Ù† ÛŒØ§ Ø¬ÙˆØ§ÛŒØ² ÙˆÛŒÚ˜Ù‡ Ø¨Ø§Ø´Ø¯ØŒ Ø§Ù…Ø§ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø®Ø·Ø±Ù†Ø§Ú© Ø¨Ø§Ø´Ø¯!',
      durability: 1
    }
  ];
  
  // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ… Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±
  const item = blackMarketItems.find(item => item.id === parseInt(itemId));
  
  if (!item) {
    return await interaction.reply({ content: 'âŒ Ø¢ÛŒØªÙ… Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯!', ephemeral: true });
  }
  
  if (wallet < item.price) {
    return await interaction.reply({ content: 'âŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§ÛŒÙ† Ø¢ÛŒØªÙ… Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });
  }
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ
  const isBusted = Math.random() < CONFIG.BLACK_MARKET_BUST_CHANCE;
  
  if (isBusted) {
    // Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ú©Ø§Ø±Ø¨Ø±
    const jailDuration = 2 * 60 * 60 * 1000; // 2 Ø³Ø§Ø¹Øª
    const fine = Math.floor(item.price * 0.5); // 50% Ø¬Ø±ÛŒÙ…Ù‡
    
    // Ú©Ø³Ø± Ø¬Ø±ÛŒÙ…Ù‡ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
    await db.sub(`wallet_${userId}`, fine);
    
    // Ø§Ø¹Ù…Ø§Ù„ Ø²Ù†Ø¯Ø§Ù†
    await db.set(`jailed_${userId}`, true);
    await db.set(`jail_release_${userId}`, Date.now() + jailDuration);
    await db.set(`jail_reason_${userId}`, 'Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡');
    
    const bustEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('ğŸš¨ Ø¯Ø³ØªÚ¯ÛŒØ± Ø´Ø¯ÛŒØ¯!')
      .setDescription('Ù¾Ù„ÛŒØ³ Ø±Ø¨Ø§Øª Ø´Ù…Ø§ Ø±Ø§ Ø­ÛŒÙ† Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ø¯Ø³ØªÚ¯ÛŒØ± Ú©Ø±Ø¯!')
      .addFields(
        { name: 'ğŸ’° Ø¬Ø±ÛŒÙ…Ù‡', value: `**${fine}** ğŸª™`, inline: true },
        { name: 'â±ï¸ Ù…Ø¯Øª Ø²Ù†Ø¯Ø§Ù†', value: '2 Ø³Ø§Ø¹Øª', inline: true },
        { name: 'âš ï¸ Ù‡Ø´Ø¯Ø§Ø±', value: 'Ø¯Ø± Ø²Ù…Ø§Ù† Ø²Ù†Ø¯Ø§Ù† Ø§Ù…Ú©Ø§Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ù‚ØªØµØ§Ø¯ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!', inline: false }
      )
      .setFooter({ text: 'Ø¨Ø§Ø± Ø¯ÛŒÚ¯Ø± Ø¯Ø± Ø®Ø±ÛŒØ¯ Ø®ÙˆØ¯ Ø¯Ù‚Øª Ú©Ù†ÛŒØ¯!' });
    
    return await interaction.reply({ embeds: [bustEmbed] });
  }
  
  // Ø®Ø±ÛŒØ¯ Ù…ÙˆÙÙ‚
  // Ú©Ø³Ø± Ù‡Ø²ÛŒÙ†Ù‡ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
  await db.sub(`wallet_${userId}`, item.price);
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ… Ø¨Ù‡ Ø§Ù†Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
  const blackMarketInventory = await db.get(`black_market_inventory_${userId}`) || [];
  blackMarketInventory.push({
    id: item.id,
    name: item.name,
    description: item.description,
    effects: item.effects,
    durability: item.durability,
    purchaseDate: Date.now()
  });
  
  await db.set(`black_market_inventory_${userId}`, blackMarketInventory);
  
  // Ø§Ø¹Ù…Ø§Ù„ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¢ÛŒØªÙ…
  switch (item.id) {
    case 501: // Ø§Ø³Ù„Ø­Ù‡ ØªÙ‚Ù„Ø¨ÛŒ
      await db.set(`fake_gun_${userId}`, true);
      break;
    case 502: // Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¬Ø¹Ù„ÛŒ
      await db.set(`fake_wallet_${userId}`, true);
      break;
    case 503: // Ù„Ø¨Ø§Ø³ Ù†ÛŒÙ†Ø¬Ø§
      await db.set(`ninja_suit_${userId}`, true);
      break;
    case 504: // Ù‚ÙÙ„ Ø´Ú©Ù† Ù¾ÛŒØ´Ø±ÙØªÙ‡
      await db.set(`advanced_lockpick_${userId}`, true);
      break;
    case 505: // Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ²
      // Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¬Ø¹Ø¨Ù‡ Ø¯Ø± ØªØ§Ø¨Ø¹ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡
      return await processBlackMarketMysteryBox(interaction, userId);
  }
  
  const successEmbed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('âœ… Ø®Ø±ÛŒØ¯ Ù…ÙˆÙÙ‚')
    .setDescription(`Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª **${item.name}** Ø±Ø§ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ø±Ø¯ÛŒØ¯!`)
    .addFields(
      { name: 'ğŸ’° Ù‡Ø²ÛŒÙ†Ù‡', value: `**${item.price}** ğŸª™`, inline: true },
      { name: 'ğŸ”„ Ø¯ÙˆØ§Ù…', value: `${item.durability} Ø¨Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡`, inline: true },
      { name: 'ğŸ“ ØªÙˆØ¶ÛŒØ­Ø§Øª', value: item.effects, inline: false }
    )
    .setFooter({ text: 'Ø¢ÛŒØªÙ… Ø¨Ù‡ Ø§Ù†Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ø´Ù…Ø§ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯. Ø§Ø² Ù…Ù†ÙˆÛŒ Ø§Ù†Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¢Ù† Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯.' });
  
  await interaction.reply({ embeds: [successEmbed] });
}

// Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
async function processBlackMarketMysteryBox(interaction, userId) {
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ²
  const mysteryBoxItems = [
    { type: 'coin', min: 10000, max: 50000, chance: 0.30, description: 'Ø³Ú©Ù‡' },
    { type: 'item', item: { id: 506, name: 'ğŸ”® ØªÙˆÙ¾ Ù¾ÛŒØ´Ú¯ÙˆÛŒÛŒ', effects: 'Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ùˆ Ø¨Ø§Ù†Ú© Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ø§ Ø¨Ø¨ÛŒÙ†ÛŒØ¯!' }, chance: 0.15, description: 'ØªÙˆÙ¾ Ù¾ÛŒØ´Ú¯ÙˆÛŒÛŒ' },
    { type: 'item', item: { id: 507, name: 'ğŸ§ª Ø§Ú©Ø³ÛŒØ± Ø¯Ø²Ø¯ÛŒ', effects: '3 Ø¨Ø§Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø±ÙˆØ²Ø§Ù†Ù‡!' }, chance: 0.15, description: 'Ø§Ú©Ø³ÛŒØ± Ø¯Ø²Ø¯ÛŒ' },
    { type: 'item', item: { id: 508, name: 'ğŸª„ Ø¹ØµØ§ÛŒ ÙØ±Ù…Ø§Ù†Ø±ÙˆØ§ÛŒÛŒ', effects: 'Ø³Ø±Ù‚Øª 25% Ø§Ø² Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡ Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÛŒÚ© Ø³Ø±ÙˆØ±!' }, chance: 0.05, description: 'Ø¹ØµØ§ÛŒ ÙØ±Ù…Ø§Ù†Ø±ÙˆØ§ÛŒÛŒ' },
    { type: 'danger', effect: 'jail', duration: 12 * 60 * 60 * 1000, chance: 0.15, description: 'Ø²Ù†Ø¯Ø§Ù† 12 Ø³Ø§Ø¹ØªÙ‡' },
    { type: 'danger', effect: 'robbery', lossPercentage: 0.3, chance: 0.10, description: 'Ø³Ø±Ù‚Øª 30% Ù…ÙˆØ¬ÙˆØ¯ÛŒ' },
    { type: 'danger', effect: 'virus', chance: 0.10, description: 'ÙˆÛŒØ±ÙˆØ³ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ÛŒ' }
  ];
  
  // Ø§Ù†ØªØ®Ø§Ø¨ ØªØµØ§Ø¯ÙÛŒ Ø¢ÛŒØªÙ…
  const result = getRandomItem(mysteryBoxItems);
  
  // Ø§ÛŒØ¬Ø§Ø¯ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø§Ù†ØªØ¸Ø§Ø±
  const waitingEmbed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle('ğŸ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ²...')
    .setDescription('Ù…Ù†ØªØ¸Ø± Ø¨Ø§Ø´ÛŒØ¯...')
    .setFooter({ text: 'Ù‡Ø± Ú†ÛŒØ²ÛŒ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¯Ø§Ø®Ù„ Ø§ÛŒÙ† Ø¬Ø¹Ø¨Ù‡ Ø¨Ø§Ø´Ø¯!' });
  
  await interaction.reply({ embeds: [waitingEmbed] });
  
  // ØªØ£Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù‡ÛŒØ¬Ø§Ù†
  await new Promise(resolve => setTimeout(resolve, 3000));
  
  let resultEmbed;
  
  // Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù†ØªÛŒØ¬Ù‡
  switch (result.type) {
    case 'coin':
      // Ø¯Ø±ÛŒØ§ÙØª Ø³Ú©Ù‡
      const amount = Math.floor(Math.random() * (result.max - result.min + 1) + result.min);
      await db.add(`wallet_${userId}`, amount);
      
      resultEmbed = new EmbedBuilder()
        .setColor('#00ff00')
        .setTitle('ğŸ’° Ú¯Ù†Ø¬ ÛŒØ§ÙØª Ø´Ø¯!')
        .setDescription(`Ø¬Ø¹Ø¨Ù‡ Ø­Ø§ÙˆÛŒ **${amount}** Ø³Ú©Ù‡ Ø¨ÙˆØ¯! Ø§ÛŒÙ† Ø³Ú©Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.`)
        .setFooter({ text: 'Ø®ÙˆØ´ Ø´Ø§Ù†Ø³ÛŒ Ø¨Ø²Ø±Ú¯ÛŒ Ù†ØµÛŒØ¨ Ø´Ù…Ø§ Ø´Ø¯!' });
      break;
      
    case 'item':
      // Ø¯Ø±ÛŒØ§ÙØª Ø¢ÛŒØªÙ… ÙˆÛŒÚ˜Ù‡
      const blackMarketInventory = await db.get(`black_market_inventory_${userId}`) || [];
      blackMarketInventory.push({
        id: result.item.id,
        name: result.item.name,
        effects: result.item.effects,
        durability: 1,
        purchaseDate: Date.now()
      });
      
      await db.set(`black_market_inventory_${userId}`, blackMarketInventory);
      
      // Ø§Ø¹Ù…Ø§Ù„ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¢ÛŒØªÙ…
      switch (result.item.id) {
        case 506: // ØªÙˆÙ¾ Ù¾ÛŒØ´Ú¯ÙˆÛŒÛŒ
          await db.set(`fortune_ball_${userId}`, true);
          break;
        case 507: // Ø§Ú©Ø³ÛŒØ± Ø¯Ø²Ø¯ÛŒ
          await db.set(`theft_elixir_${userId}`, 3); // 3 Ø¨Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡
          break;
        case 508: // Ø¹ØµØ§ÛŒ ÙØ±Ù…Ø§Ù†Ø±ÙˆØ§ÛŒÛŒ
          await db.set(`ruler_wand_${userId}`, true);
          break;
      }
      
      resultEmbed = new EmbedBuilder()
        .setColor('#9b59b6')
        .setTitle('âœ¨ Ø¢ÛŒØªÙ… Ú©Ù…ÛŒØ§Ø¨!')
        .setDescription(`Ø´Ù…Ø§ ${result.item.name} Ø±Ø§ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯ÛŒØ¯!`)
        .addFields({ name: 'ğŸ“ Ù‚Ø§Ø¨Ù„ÛŒØª', value: result.item.effects })
        .setFooter({ text: 'Ø§ÛŒÙ† Ø¢ÛŒØªÙ… Ø¨Ø³ÛŒØ§Ø± Ù†Ø§Ø¯Ø± Ùˆ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ Ø§Ø³Øª!' });
      break;
      
    case 'danger':
      // Ù†ØªÛŒØ¬Ù‡ Ø®Ø·Ø±Ù†Ø§Ú©
      switch (result.effect) {
        case 'jail':
          // Ø²Ù†Ø¯Ø§Ù†ÛŒ Ø´Ø¯Ù†
          await db.set(`jailed_${userId}`, true);
          await db.set(`jail_release_${userId}`, Date.now() + result.duration);
          await db.set(`jail_reason_${userId}`, 'Ø¬Ø¹Ø¨Ù‡ Ø§Ø³Ø±Ø§Ø±Ø¢Ù…ÛŒØ² Ø®Ø·Ø±Ù†Ø§Ú©');
          
          resultEmbed = new EmbedBuilder()
            .setColor('#ff0000')
            .setTitle('âš ï¸ Ø¯Ø§Ù… Ø®Ø·Ø±Ù†Ø§Ú©!')
            .setDescription('Ø¬Ø¹Ø¨Ù‡ Ø­Ø§ÙˆÛŒ ÛŒÚ© ØªÙ„Ù‡ Ø¨ÙˆØ¯! Ø´Ù…Ø§ Ø¯Ø³ØªÚ¯ÛŒØ± Ùˆ Ø²Ù†Ø¯Ø§Ù†ÛŒ Ø´Ø¯ÛŒØ¯!')
            .addFields({ name: 'â±ï¸ Ù…Ø¯Øª Ø²Ù†Ø¯Ø§Ù†', value: '12 Ø³Ø§Ø¹Øª', inline: true })
            .setFooter({ text: 'Ø¯Ø± Ø²Ù…Ø§Ù† Ø²Ù†Ø¯Ø§Ù† Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ù‚ØªØµØ§Ø¯ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯!' });
          break;
          
        case 'robbery':
          // Ø³Ø±Ù‚Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ
          const wallet = await db.get(`wallet_${userId}`) || 0;
          const robbedAmount = Math.floor(wallet * result.lossPercentage);
          
          if (robbedAmount > 0) {
            await db.sub(`wallet_${userId}`, robbedAmount);
          }
          
          resultEmbed = new EmbedBuilder()
            .setColor('#ff0000')
            .setTitle('ğŸ’¥ Ø³Ø±Ù‚Øª!')
            .setDescription(`Ø¬Ø¹Ø¨Ù‡ Ø­Ø§ÙˆÛŒ ÛŒÚ© Ø³Ø§Ø±Ù‚ Ø¨ÙˆØ¯! **${robbedAmount}** Ø³Ú©Ù‡ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ø¯Ø²Ø¯ÛŒØ¯Ù‡ Ø´Ø¯!`)
            .setFooter({ text: 'Ù…Ø±Ø§Ù‚Ø¨ Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ú©ÙˆÚ© Ø¨Ø§Ø´ÛŒØ¯!' });
          break;
          
        case 'virus':
          // ÙˆÛŒØ±ÙˆØ³ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ÛŒ
          // Ø§Ø«Ø±Ø§Øª ØªØµØ§Ø¯ÙÛŒ Ù…Ø®ØªÙ„Ù
          const virusEffects = [
            { effect: 'lockInventory', duration: 24 * 60 * 60 * 1000, description: 'Ø§Ù†Ø¨Ø§Ø± Ø´Ù…Ø§ Ù‚ÙÙ„ Ø´Ø¯! Ø¨Ù‡ Ù…Ø¯Øª 24 Ø³Ø§Ø¹Øª Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.' },
            { effect: 'doubleRobChance', duration: 48 * 60 * 60 * 1000, description: 'Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø²Ø¯ÛŒØ¯Ù‡ Ø´Ø¯Ù† Ø§Ø² Ø´Ù…Ø§ 2 Ø¨Ø±Ø§Ø¨Ø± Ø´Ø¯Ù‡ Ø§Ø³Øª! Ø§ÛŒÙ† Ø§Ø«Ø± 48 Ø³Ø§Ø¹Øª Ø·ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ø´Ø¯.' },
            { effect: 'dailyReward', lossPercentage: 0.5, duration: 72 * 60 * 60 * 1000, description: 'Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø´Ù…Ø§ 50% Ú©Ø§Ù‡Ø´ ÛŒØ§ÙØªÙ‡ Ø§Ø³Øª! Ø§ÛŒÙ† Ø§Ø«Ø± 3 Ø±ÙˆØ² Ø·ÙˆÙ„ Ù…ÛŒâ€ŒÚ©Ø´Ø¯.' }
          ];
          
          const virusEffect = virusEffects[Math.floor(Math.random() * virusEffects.length)];
          
          // Ø§Ø¹Ù…Ø§Ù„ Ø§Ø«Ø± ÙˆÛŒØ±ÙˆØ³
          await db.set(`virus_${userId}`, {
            type: virusEffect.effect,
            startTime: Date.now(),
            duration: virusEffect.duration,
            params: virusEffect.effect === 'dailyReward' ? { lossPercentage: virusEffect.lossPercentage } : {}
          });
          
          resultEmbed = new EmbedBuilder()
            .setColor('#ff0000')
            .setTitle('ğŸ¦  ÙˆÛŒØ±ÙˆØ³ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ÛŒ!')
            .setDescription(`Ø¬Ø¹Ø¨Ù‡ Ø¢Ù„ÙˆØ¯Ù‡ Ø¨Ù‡ ÙˆÛŒØ±ÙˆØ³ Ø¨ÙˆØ¯! ${virusEffect.description}`)
            .setFooter({ text: 'Ø§ÛŒÙ† ÙˆÛŒØ±ÙˆØ³ ØªÙˆØ³Ø· Ù…ØªØ®ØµØµØ§Ù† Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ Ø§Ø³Øª!' });
          break;
      }
      break;
  }
  
  await interaction.editReply({ embeds: [resultEmbed] });
}

// Helper function to get random item
function getRandomItem(items) {
  let randomValue = Math.random();
  let cumulativeProbability = 0;
  
  for (const item of items) {
    cumulativeProbability += item.chance;
    
    if (randomValue <= cumulativeProbability) {
      return item;
    }
  }
  
  // Ø§Ú¯Ø± Ø¨Ù‡ Ù‡Ø± Ø¯Ù„ÛŒÙ„ÛŒ Ù‡ÛŒÚ† Ø¢ÛŒØªÙ…ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯ØŒ Ø¢ÛŒØªÙ… Ø§ÙˆÙ„ Ø±Ø§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†
  return items[0];
}

// Ù†Ù…Ø§ÛŒØ´ Ø§Ù†Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡
async function showBlackMarketInventory(interaction) {
  const userId = interaction.user.id;
  const blackMarketInventory = await db.get(`black_market_inventory_${userId}`) || [];
  
  if (blackMarketInventory.length === 0) {
    const emptyEmbed = new EmbedBuilder()
      .setColor('#808080')
      .setTitle('ğŸ´â€â˜ ï¸ Ø§Ù†Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡')
      .setDescription('Ø´Ù…Ø§ Ù‡ÛŒÚ† Ø¢ÛŒØªÙ…ÛŒ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ù†Ø¯Ø§Ø±ÛŒØ¯.')
      .setFooter({ text: 'Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯.' });
      
    const backRow = new ActionRowBuilder()
      .addComponents(
        new ButtonBuilder()
          .setCustomId('blackmarket')
          .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡')
          .setStyle(ButtonStyle.Secondary)
          .setEmoji('â¬…ï¸')
      );
      
    return await interaction.update({ embeds: [emptyEmbed], components: [backRow] });
  }
  
  const inventoryEmbed = new EmbedBuilder()
    .setColor('#8e44ad')
    .setTitle('ğŸ´â€â˜ ï¸ Ø§Ù†Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡')
    .setDescription('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡:')
    .setFooter({ text: 'Ø§ÛŒÙ† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ ØµØ±ÙØ§Ù‹ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø®ØµÛŒ Ø§Ø³Øª Ùˆ Ù…Ø¹Ø§Ù…Ù„Ù‡ Ù…Ø¬Ø¯Ø¯ Ø¢Ù†Ù‡Ø§ Ù…Ù…Ù†ÙˆØ¹ Ø§Ø³Øª!' });
  
  // Ú¯Ø±ÙˆÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹
  const groupedItems = {};
  
  blackMarketInventory.forEach(item => {
    if (!groupedItems[item.id]) {
      groupedItems[item.id] = { 
        name: item.name, 
        effects: item.effects, 
        count: 1, 
        durabilities: [item.durability]
      };
    } else {
      groupedItems[item.id].count++;
      groupedItems[item.id].durabilities.push(item.durability);
    }
  });
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ù‡ embed
  Object.values(groupedItems).forEach(itemGroup => {
    const totalDurability = itemGroup.durabilities.reduce((sum, cur) => sum + cur, 0);
    inventoryEmbed.addFields({ 
      name: `${itemGroup.name} (${itemGroup.count}Ã—)`, 
      value: `${itemGroup.effects}\n**Ø¯ÙˆØ§Ù… Ú©Ù„:** ${totalDurability} Ø¨Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡`, 
      inline: false 
    });
  });
  
  // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ù†ÙˆÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø¢ÛŒØªÙ… Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡
  const selectMenu = new StringSelectMenuBuilder()
    .setCustomId('use_black_market_item')
    .setPlaceholder('ÛŒÚ© Ø¢ÛŒØªÙ… Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...')
    .addOptions(
      Object.entries(groupedItems).map(([id, itemGroup]) => ({
        label: itemGroup.name,
        value: id,
        description: `Ø¯ÙˆØ§Ù… Ú©Ù„: ${itemGroup.durabilities.reduce((sum, cur) => sum + cur, 0)} Ø¨Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡`,
        emoji: itemGroup.name.split(' ')[0],
        default: false
      }))
    );
  
  const selectRow = new ActionRowBuilder().addComponents(selectMenu);
  
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('blackmarket')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
  
  await interaction.update({ embeds: [inventoryEmbed], components: [selectRow, backRow] });
}

  if (amount >= remainingDebt) {
    // Ø§Ú¯Ø± Ù…Ù‚Ø¯Ø§Ø± Ø¨ÛŒØ´ØªØ± ÛŒØ§ Ø¨Ø±Ø§Ø¨Ø± Ú©Ù„ Ø¨Ø¯Ù‡ÛŒ Ø§Ø³ØªØŒ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ù…Ù„
    return await processLoanRepayment(interaction, true);
  }
  
  // Ú©Ø³Ø± Ù…Ø¨Ù„Øº Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
  await db.sub(`wallet_${userId}`, amount);
  
  // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¨Ø¯Ù‡ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡ Ùˆ Ø§ÛŒØ¬Ø§Ø¯ ÙˆØ§Ù… Ø¬Ø¯ÛŒØ¯
  const remainingRatio = (remainingDebt - amount) / remainingDebt;
  const newLoanAmount = Math.floor(loan.amount * remainingRatio);
  
  // Ø¢Ù¾Ø¯ÛŒØª ÙˆØ§Ù…
  await db.set(`loan_${userId}`, {
    ...loan,
    amount: newLoanAmount,
    partialPayments: [...(loan.partialPayments || []), {
      amount: amount,
      date: Date.now()
    }]
  });
  
  const successEmbed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('âœ… Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø®Ø´ÛŒ Ù…ÙˆÙÙ‚')
    .setDescription(`Ø´Ù…Ø§ **${amount}** ğŸª™ Ø§Ø² ÙˆØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø±Ø¯ÛŒØ¯!`)
    .addFields(
      { name: 'ğŸ’° Ø¨Ø¯Ù‡ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡', value: `**${remainingDebt - amount}** ğŸª™`, inline: true },
      { name: 'ğŸ“… Ø³Ø±Ø±Ø³ÛŒØ¯', value: `${new Date(loan.dueDate).toLocaleDateString('fa-IR')}`, inline: true }
    )
    .setFooter({ text: 'Ø¨Ø§ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ù‡ Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ø¹ØªØ¨Ø§Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¨Ø¨Ø®Ø´ÛŒØ¯!' });
  
  await interaction.reply({ embeds: [successEmbed] });
  
  // Ø§ÙØ²Ø§ÛŒØ´ Ú©Ù…ÛŒ Ø§Ø¹ØªØ¨Ø§Ø± Ú©Ø§Ø±Ø¨Ø±
  await db.add(`credit_score_${userId}`, 1);
}

// Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ø±Ø³ÛŒØ¯ Ø´Ø¯Ù‡ Ùˆ Ø§Ø¹Ù…Ø§Ù„ Ø¬Ø±ÛŒÙ…Ù‡
async function checkOverdueLoanPayments() {
  const loanKeys = await db.all(`loan_*`);
  const now = Date.now();
  
  for (const key of loanKeys) {
    const userId = key.id.replace('loan_', '');
    const loan = key.value;
    
    // Ø§Ú¯Ø± ØªØ§Ø±ÛŒØ® Ø³Ø±Ø±Ø³ÛŒØ¯ Ú¯Ø°Ø´ØªÙ‡ Ùˆ ÙˆØ§Ù… Ø¬Ø±ÛŒÙ…Ù‡ Ù†Ø´Ø¯Ù‡
    if (loan.dueDate < now && !loan.penaltyApplied) {
      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¬Ø±ÛŒÙ…Ù‡
      const wallet = await db.get(`wallet_${userId}`) || 0;
      const penalty = Math.floor(wallet * CONFIG.LOAN_PENALTY_RATE);
      
      if (wallet > 0) {
        // Ú©Ø³Ø± Ø¬Ø±ÛŒÙ…Ù‡ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
        await db.sub(`wallet_${userId}`, penalty);
        
        // Ø«Ø¨Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¬Ø±ÛŒÙ…Ù‡
        await db.set(`loan_${userId}`, {
          ...loan,
          penaltyApplied: true,
          penaltyAmount: penalty,
          penaltyDate: now,
          // ØªÙ…Ø¯ÛŒØ¯ Ù…Ù‡Ù„Øª Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø±Ø§ÛŒ 7 Ø±ÙˆØ² Ø¯ÛŒÚ¯Ø±
          dueDate: now + (7 * 24 * 60 * 60 * 1000)
        });
        
        // Ú©Ø§Ù‡Ø´ Ø§Ø¹ØªØ¨Ø§Ø± Ú©Ø§Ø±Ø¨Ø±
        await db.sub(`credit_score_${userId}`, 10);
        
        // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± ØµÙˆØ±Øª Ø§Ù…Ú©Ø§Ù†
        try {
          const user = await client.users.fetch(userId);
          const penaltyEmbed = new EmbedBuilder()
            .setColor('#ff0000')
            .setTitle('âš ï¸ Ø¬Ø±ÛŒÙ…Ù‡ Ø¯ÛŒØ±Ú©Ø±Ø¯ ÙˆØ§Ù…')
            .setDescription(`Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø¹Ø¯Ù… Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ù‡ Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù…ØŒ **${penalty}** ğŸª™ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¬Ø±ÛŒÙ…Ù‡ Ú©Ø³Ø± Ø´Ø¯.`)
            .addFields(
              { name: 'ğŸ’° Ø¨Ø¯Ù‡ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡', value: `**${Math.floor(loan.amount * (1 + loan.interestRate))}** ğŸª™`, inline: true },
              { name: 'ğŸ“… Ù…Ù‡Ù„Øª Ø¬Ø¯ÛŒØ¯', value: `${new Date(now + (7 * 24 * 60 * 60 * 1000)).toLocaleDateString('fa-IR')}`, inline: true }
            )
            .setFooter({ text: 'Ù„Ø·ÙØ§Ù‹ Ø¯Ø± Ø§Ø³Ø±Ø¹ ÙˆÙ‚Øª Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª ÙˆØ§Ù… Ø®ÙˆØ¯ Ø§Ù‚Ø¯Ø§Ù… Ú©Ù†ÛŒØ¯!' });
          
          await user.send({ embeds: [penaltyEmbed] });
        } catch (error) {
          console.error(`Could not send penalty message to user ${userId}:`, error);
        }
      }
    }
  }
}

        .setEmoji('ğŸ“Š')
    );

  const adminRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_settings')
        .setLabel('ØªÙ†Ø¸ÛŒÙ… Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ’°'),
      new ButtonBuilder()
        .setCustomId('reset_data')
        .setLabel('Ø±ÛŒØ³Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ”„')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('main_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [adminEmbed], components: [adminRow, adminRow2, backRow] });
}

// Admin Panel
async function showAdminPanel(interaction) {
  const adminPanelEmbed = new EmbedBuilder()
    .setColor('#34495e')
    .setTitle('ğŸ”‘ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª')
    .setDescription('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ØµÙ„ÛŒ Ø±Ø¨Ø§Øª Ø±Ø§ Ø§Ø² Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: 'ğŸ¤– ÙˆØ¶Ø¹ÛŒØª Ø±Ø¨Ø§Øª', value: 'Ø¢Ù†Ù„Ø§ÛŒÙ† | Ø²Ù…Ø§Ù† Ú©Ø§Ø±Ú©Ø±Ø¯: 12:34:56', inline: true },
      { name: 'ğŸ‘¥ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', value: '152 Ú©Ø§Ø±Ø¨Ø±', inline: true },
      { name: 'ğŸ’° Ú©Ù„ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ú¯Ø±Ø¯Ø´', value: '1,234,567 Ø³Ú©Ù‡', inline: true },
      { name: 'âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¹Ù…ÙˆÙ…ÛŒ', value: 'ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ù„ÛŒ Ø±Ø¨Ø§Øª', inline: true },
      { name: 'ğŸ“Š Ø¢Ù…Ø§Ø± Ø±Ø¨Ø§Øª', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¢Ù…Ø§Ø± Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø±Ø¨Ø§Øª', inline: true },
      { name: 'ğŸ”” Ø§Ø¹Ù„Ø§Ù†Ø§Øª', value: 'Ø§Ø±Ø³Ø§Ù„ Ø§Ø¹Ù„Ø§Ù† Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†', inline: true }
    )
    .setFooter({ text: 'Ø§Ø² Ø¯Ø³ØªÙˆØ±Ù‡Ø§ÛŒ Ø§Ø³Ù„Ø´ Ù…Ø®ØµÙˆØµ Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø±Ø§ÛŒ ØªØºÛŒÛŒØ± ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('admin_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [adminPanelEmbed], components: [backRow] });
}

// Manage Users
async function showManageUsers(interaction) {
  const manageUsersEmbed = new EmbedBuilder()
    .setColor('#34495e')
    .setTitle('ğŸ“Š Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†')
    .setDescription('Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯ Ùˆ ØªØºÛŒÛŒØ±Ø§Øª Ù„Ø§Ø²Ù… Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: '/give [user] [amount]', value: 'Ø§ÙØ²ÙˆØ¯Ù† Ø³Ú©Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±', inline: true },
      { name: '/take [user] [amount]', value: 'Ú©Ù… Ú©Ø±Ø¯Ù† Ø³Ú©Ù‡ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±', inline: true },
      { name: '/ban-economy [user]', value: 'Ù…Ø­Ø±ÙˆÙ…ÛŒØª Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ', inline: true },
      { name: '/reset-user [user]', value: 'Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ù‚ØªØµØ§Ø¯ÛŒ ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±', inline: true },
      { name: '/set-multiplier [user] [value]', value: 'ØªÙ†Ø¸ÛŒÙ… Ø¶Ø±ÛŒØ¨ Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ø§Ø±Ø¨Ø±', inline: true },
      { name: '/view-user [user]', value: 'Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø±', inline: true }
    )
    .setFooter({ text: 'Ø§Ø² Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ±Ø§Øª Ø¨Ø§ Ø§Ø­ØªÛŒØ§Ø· Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯!' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('admin_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [manageUsersEmbed], components: [backRow] });
}

// Economy Settings
async function showEconomySettings(interaction) {
  const economySettingsEmbed = new EmbedBuilder()
    .setColor('#34495e')
    .setTitle('ğŸ’° ØªÙ†Ø¸ÛŒÙ… Ø§Ù‚ØªØµØ§Ø¯')
    .setDescription('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯.')
    .addFields(
      { name: '/set-daily [amount]', value: 'ØªÙ†Ø¸ÛŒÙ… Ù…Ù‚Ø¯Ø§Ø± Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡', inline: true },
      { name: '/set-interest-rate [percentage]', value: 'ØªÙ†Ø¸ÛŒÙ… Ù†Ø±Ø® Ø³ÙˆØ¯ Ø¨Ø§Ù†Ú©ÛŒ', inline: true },
      { name: '/set-jackpot [amount]', value: 'ØªÙ†Ø¸ÛŒÙ… Ù…Ù‚Ø¯Ø§Ø± Ù¾Ø§ÛŒÙ‡ Ø¬Ú©Ù¾Ø§Øª', inline: true },
      { name: '/set-tax-rate [percentage]', value: 'ØªÙ†Ø¸ÛŒÙ… Ù†Ø±Ø® Ù…Ø§Ù„ÛŒØ§Øª', inline: true },
      { name: '/set-cooldowns', value: 'ØªÙ†Ø¸ÛŒÙ… Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø± Ú©Ø§Ù…Ù†Ø¯Ù‡Ø§', inline: true },
      { name: '/reset-economy', value: 'Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ', inline: true }
    )
    .setFooter({ text: 'ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ÛŒØ¯ Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ùˆ Ø³Ø±Ø¹Øª Ú¯Ø±Ø¯Ø´ Ø§Ù‚ØªØµØ§Ø¯ ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆÙ†Ø¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('admin_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [economySettingsEmbed], components: [backRow] });
}

// Reset Data
async function showResetData(interaction) {
  const resetDataEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('âš ï¸ Ø±ÛŒØ³Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª')
    .setDescription('**Ù‡Ø´Ø¯Ø§Ø±: Ø§ÛŒÙ† Ø¹Ù…Ù„ÛŒØ§Øª ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø³Øª!**')
    .addFields(
      { name: 'ğŸ”„ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø±ÛŒØ³Øª', value: 
        'â€¢ Ø±ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ\n' +
        'â€¢ Ø±ÛŒØ³Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±\n' +
        'â€¢ Ø±ÛŒØ³Øª Ø¬Ú©Ù¾Ø§Øª Ùˆ Ù‚Ø±Ø¹Ù‡â€ŒÚ©Ø´ÛŒâ€ŒÙ‡Ø§\n' +
        'â€¢ Ø±ÛŒØ³Øª Ø¢Ù…Ø§Ø± Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§\n' +
        'â€¢ Ø±ÛŒØ³Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡\n' +
        'â€¢ Ø±ÛŒØ³Øª Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§', 
        inline: false 
      },
      { name: 'âš ï¸ ØªØ°Ú©Ø± Ù…Ù‡Ù…', value: 'Ù¾ÛŒØ´ Ø§Ø² Ø§Ù†Ø¬Ø§Ù… Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ø±ÛŒØ³ØªØŒ Ø­ØªÙ…Ø§Ù‹ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù†Ø³Ø®Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù† ØªÙ‡ÛŒÙ‡ Ú©Ù†ÛŒØ¯!', inline: false }
    )
    .setFooter({ text: 'Ø¨Ø±Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø±ÛŒØ³Øª Ø§Ø² Ø¯Ø³ØªÙˆØ±Ø§Øª Ø§Ø³Ù„Ø´ Ù…Ø¯ÛŒØ±ÛŒØªÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('admin_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );

  await interaction.update({ embeds: [resetDataEmbed], components: [backRow] });
}

// Ø²ÛŒØ±Ù…Ù†ÙˆÙ‡Ø§ Ùˆ Ø¹Ù…Ù„ÛŒØ§Øª Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¨Ø®Ø´
// Ø³ÛŒØ³ØªÙ… Ø´ØºÙ„â€ŒÙ‡Ø§ (Job System)
async function showJobsMenu(interaction) {
  const userId = interaction.user.id;
  const currentJob = await db.get(`job_${userId}`) || 'none';
  const lastJobChange = await db.get(`lastJobChange_${userId}`) || 0;
  const now = Date.now();
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø¢ÛŒØ§ Ø§Ù…Ú©Ø§Ù† ØªØºÛŒÛŒØ± Ø´ØºÙ„ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
  const canChangeJob = (now - lastJobChange >= 7 * 24 * 60 * 60 * 1000) || (lastJobChange === 0);
  const nextChangeDate = new Date(lastJobChange + 7 * 24 * 60 * 60 * 1000);
  
  let jobChangeText = '';
  if (!canChangeJob) {
    const daysLeft = Math.ceil((nextChangeDate - now) / (1000 * 60 * 60 * 24));
    jobChangeText = `â±ï¸ Ø´Ù…Ø§ Ø¨Ø§ÛŒØ¯ **${daysLeft}** Ø±ÙˆØ² Ø¯ÛŒÚ¯Ø± ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨ØªÙˆØ§Ù†ÛŒØ¯ Ø´ØºÙ„ Ø®ÙˆØ¯ Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯.`;
  }
  
  // Ù„ÛŒØ³Øª Ø´ØºÙ„â€ŒÙ‡Ø§ Ùˆ ØªÙˆØ¶ÛŒØ­Ø§Øª
  const jobs = [
    { 
      id: 'thief', 
      name: 'ğŸ¦¹â€â™‚ï¸ Ø¯Ø²Ø¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ', 
      description: 'â€¢ Ø§ÙØ²Ø§ÛŒØ´ 15% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ\nâ€¢ Ú©Ø§Ù‡Ø´ 20% Ø¬Ø±ÛŒÙ…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ\nâ€¢ Ø§Ù…Ú©Ø§Ù† Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©',
      minLevel: 10
    },
    { 
      id: 'trader', 
      name: 'ğŸ§™â€â™‚ï¸ ØªØ§Ø¬Ø±', 
      description: 'â€¢ 10% ØªØ®ÙÛŒÙ Ø¯Ø± Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§\nâ€¢ 10% Ø³ÙˆØ¯ Ø¨ÛŒØ´ØªØ± Ø¯Ø± ÙØ±ÙˆØ´ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§\nâ€¢ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡',
      minLevel: 5
    },
    { 
      id: 'investor', 
      name: 'ğŸ’¼ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±', 
      description: 'â€¢ 20% Ø³ÙˆØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø¨Ø§Ù†Ú©\nâ€¢ 10% Ø³ÙˆØ¯ Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§\nâ€¢ Ú©Ø§Ù‡Ø´ Ø±ÛŒØ³Ú© Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø®Ø·Ø±',
      minLevel: 8
    },
    { 
      id: 'warrior', 
      name: 'âš”ï¸ Ø¬Ù†Ú¯Ø¬Ùˆ', 
      description: 'â€¢ 25% Ù¾Ø§Ø¯Ø§Ø´ Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§\nâ€¢ 15% Ø´Ø§Ù†Ø³ Ø¨ÛŒØ´ØªØ± Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯ Ø¯Ø± Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§\nâ€¢ ØªÙˆØ§Ù†Ø§ÛŒÛŒ Ú†Ø§Ù„Ø´ Ú©Ø´ÛŒØ¯Ù† Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§ØªØ±',
      minLevel: 7
    },
    { 
      id: 'mastermind', 
      name: 'ğŸ§  Ø°Ù‡Ù† Ù…Ø¯Ø¨Ø±', 
      description: 'â€¢ Ø§ÙØ²Ø§ÛŒØ´ 20% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¹Ù…Ù„ÛŒØ§Øª Ù¾ÛŒÚ†ÛŒØ¯Ù‡\nâ€¢ 15% Ú©Ø§Ù‡Ø´ Ú©ÙˆÙ„Ø¯Ø§ÙˆÙ† ØªÙ…Ø§Ù… ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§\nâ€¢ ØªÙˆØ§Ù†Ø§ÛŒÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒØ±ÛŒØ²ÛŒ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©',
      minLevel: 15
    },
    { 
      id: 'gambler', 
      name: 'ğŸ² Ù‚Ù…Ø§Ø±Ø¨Ø§Ø²', 
      description: 'â€¢ 25% Ø§ÙØ²Ø§ÛŒØ´ Ø¬Ø§ÛŒØ²Ù‡ Ø¯Ø± Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø´Ø§Ù†Ø³\nâ€¢ 10% Ø´Ø§Ù†Ø³ Ø¬Ø¨Ø±Ø§Ù† Ø¨Ø§Ø®Øªâ€ŒÙ‡Ø§\nâ€¢ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ',
      minLevel: 3
    }
  ];
  
  // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ø´ØºÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø·Ø­ Ú©Ø§Ø±Ø¨Ø±
  const userLevel = await db.get(`level_${userId}`) || 1;
  const availableJobs = jobs.filter(job => userLevel >= job.minLevel);
  
  // Ø³Ø§Ø®Øª embed
  const jobsEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ§° Ø³ÛŒØ³ØªÙ… Ø´ØºÙ„â€ŒÙ‡Ø§')
    .setDescription('Ø¨Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ø´ØºÙ„ Ù…Ù†Ø§Ø³Ø¨ØŒ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ùˆ Ø¨ÙˆÙ†ÙˆØ³â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'ğŸ“ Ø´ØºÙ„ ÙØ¹Ù„ÛŒ', value: currentJob === 'none' ? '**Ø¨Ø¯ÙˆÙ† Ø´ØºÙ„**' : `**${jobs.find(j => j.id === currentJob)?.name || 'Ù†Ø§Ù…Ø´Ø®Øµ'}**`, inline: false }
    );
  
  if (jobChangeText) {
    jobsEmbed.addFields({ name: 'â³ Ø²Ù…Ø§Ù† ØªØºÛŒÛŒØ± Ø´ØºÙ„', value: jobChangeText, inline: false });
  }
  
  if (availableJobs.length === 0) {
    jobsEmbed.addFields({ name: 'âš ï¸ Ø´ØºÙ„ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ', value: `Ø´Ù…Ø§ Ù‡Ù†ÙˆØ² Ø¨Ù‡ Ø³Ø·Ø­ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ù‡ÛŒÚ† Ø´ØºÙ„ÛŒ Ù†Ø±Ø³ÛŒØ¯Ù‡â€ŒØ§ÛŒØ¯. Ø¨Ù‡ Ø³Ø·Ø­ 3 Ø¨Ø±Ø³ÛŒØ¯ ØªØ§ Ø§ÙˆÙ„ÛŒÙ† Ø´ØºÙ„ Ø±Ø§ Ø¢Ø²Ø§Ø¯ Ú©Ù†ÛŒØ¯.`, inline: false });
  } else {
    jobsEmbed.addFields({ name: 'ğŸ‘” Ø´ØºÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ', value: `Ø´Ù…Ø§ Ø¨Ù‡ Ø³Ø·Ø­ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ ${availableJobs.length} Ø´ØºÙ„ Ø±Ø³ÛŒØ¯Ù‡â€ŒØ§ÛŒØ¯:`, inline: false });
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù‡Ø± Ø´ØºÙ„ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ÛŒÚ© ÙÛŒÙ„Ø¯ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡
    availableJobs.forEach(job => {
      jobsEmbed.addFields({ 
        name: `${job.name} ${currentJob === job.id ? '(ÙØ¹Ø§Ù„)' : ''}`, 
        value: job.description + `\n**Ø³Ø·Ø­ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:** ${job.minLevel}`, 
        inline: true 
      });
    });
  }
  
  jobsEmbed.setFooter({ text: 'Ù‡Ø± Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù‡Ø± 7 Ø±ÙˆØ² ÛŒÚ©Ø¨Ø§Ø± Ø´ØºÙ„ Ø®ÙˆØ¯ Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡Ø¯. Ø´ØºÙ„â€ŒÙ‡Ø§ÛŒ Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§ØªØ± Ø¨Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø·Ø­ Ø´Ù…Ø§ Ø¢Ø²Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.' });
  
  // Ø³Ø§Ø®Øª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
  let jobButtons = [];
  
  // ÙÙ‚Ø· Ø´ØºÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ø±Ø§ Ø¨Ù‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
  if (canChangeJob) {
    const jobRows = [];
    let currentRow = new ActionRowBuilder();
    let buttonCount = 0;
    
    availableJobs.forEach((job, index) => {
      // Ø­Ø¯Ø§Ú©Ø«Ø± 3 Ø¯Ú©Ù…Ù‡ Ø¯Ø± Ù‡Ø± Ø±Ø¯ÛŒÙ
      if (buttonCount % 3 === 0 && buttonCount > 0) {
        jobRows.push(currentRow);
        currentRow = new ActionRowBuilder();
      }
      
      currentRow.addComponents(
        new ButtonBuilder()
          .setCustomId(`select_job_${job.id}`)
          .setLabel(job.name.split(' ')[1]) // ÙÙ‚Ø· Ù†Ø§Ù… Ø¨Ø¯ÙˆÙ† Ø§ÛŒÙ…ÙˆØ¬ÛŒ
          .setStyle(currentJob === job.id ? ButtonStyle.Success : ButtonStyle.Primary)
          .setEmoji(job.name.split(' ')[0]) // Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ø§Ø² Ù†Ø§Ù…
          .setDisabled(currentJob === job.id) // Ø§Ú¯Ø± Ø´ØºÙ„ ÙØ¹Ù„ÛŒ Ø§Ø³ØªØŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ù†
      );
      
      buttonCount++;
    });
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢Ø®Ø±ÛŒÙ† Ø±Ø¯ÛŒÙ
    if (currentRow.components.length > 0) {
      jobRows.push(currentRow);
    }
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ÛŒ Ø¯Ú©Ù…Ù‡ Ø¨Ù‡ Ù„ÛŒØ³Øª Ù†Ù‡Ø§ÛŒÛŒ
    jobButtons = jobRows;
  }
  
  // Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª Ù‡Ù…ÛŒØ´Ù‡ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('profile_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¢Ø±Ø§ÛŒÙ‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
  jobButtons.push(backRow);
  
  await interaction.update({ embeds: [jobsEmbed], components: jobButtons });
}

// Ù…Ù†ÙˆÛŒ ÙˆØ§Ø±ÛŒØ²
async function showDepositMenu(interaction) {
  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;

  const depositEmbed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ’± ÙˆØ§Ø±ÛŒØ² Ø¨Ù‡ Ø¨Ø§Ù†Ú©')
    .setDescription(`Ø´Ù…Ø§ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± **${wallet}** ğŸª™ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ø¯Ø§Ø±ÛŒØ¯.\nØ¨Ø±Ø§ÛŒ ÙˆØ§Ø±ÛŒØ² Ø¨Ù‡ Ø¨Ø§Ù†Ú©ØŒ Ø§Ø² Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:`)
    .addFields(
      { name: 'Ø¯Ø³ØªÙˆØ± ÙˆØ§Ø±ÛŒØ²', value: '`/deposit [Ù…Ù‚Ø¯Ø§Ø±]`', inline: false },
      { name: 'Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§', value: '`/deposit 100` - ÙˆØ§Ø±ÛŒØ² 100 Ø³Ú©Ù‡\n`/deposit all` - ÙˆØ§Ø±ÛŒØ² ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ', inline: false }
    )
    .setFooter({ text: 'Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§ Ø¯Ø± Ø¨Ø§Ù†Ú© Ø§Ø² Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ Ø¨Ù‡Ø±Ù‡â€ŒÙ…Ù†Ø¯ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯!' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [depositEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø¨Ø±Ø¯Ø§Ø´Øª
async function showWithdrawMenu(interaction) {
  const userId = interaction.user.id;
  const bank = await db.get(`bank_${userId}`) || 0;

  const withdrawEmbed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ§ Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø¨Ø§Ù†Ú©')
    .setDescription(`Ø´Ù…Ø§ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± **${bank}** ğŸª™ Ø¯Ø± Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø®ÙˆØ¯ Ø¯Ø§Ø±ÛŒØ¯.\nØ¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø¨Ø§Ù†Ú©ØŒ Ø§Ø² Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:`)
    .addFields(
      { name: 'Ø¯Ø³ØªÙˆØ± Ø¨Ø±Ø¯Ø§Ø´Øª', value: '`/withdraw [Ù…Ù‚Ø¯Ø§Ø±]`', inline: false },
      { name: 'Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§', value: '`/withdraw 100` - Ø¨Ø±Ø¯Ø§Ø´Øª 100 Ø³Ú©Ù‡\n`/withdraw all` - Ø¨Ø±Ø¯Ø§Ø´Øª ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ', inline: false }
    )
    .setFooter({ text: 'ØªÙˆØ¬Ù‡: Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø¨Ø§Ù†Ú© Ø¨Ø§Ø¹Ø« Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯Ù† Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ Ø¢Ù† Ù…Ø¨Ù„Øº Ù…ÛŒâ€ŒØ´ÙˆØ¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [withdrawEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡
async function showTransferMenu(interaction) {
  const transferEmbed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ”„ Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡')
    .setDescription('Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø±ØŒ Ø§Ø² Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:')
    .addFields(
      { name: 'Ø¯Ø³ØªÙˆØ± Ø§Ù†ØªÙ‚Ø§Ù„', value: '`/transfer @user [Ù…Ù‚Ø¯Ø§Ø±]`', inline: false },
      { name: 'Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§', value: '`/transfer @user 100` - Ø§Ù†ØªÙ‚Ø§Ù„ 100 Ø³Ú©Ù‡\n`/transfer @user all` - Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ…Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ', inline: false }
    )
    .setFooter({ text: 'ØªÙˆØ¬Ù‡: Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø³Øª!' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§Ù‚ØªØµØ§Ø¯')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [transferEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø´ÛŒØ± ÛŒØ§ Ø®Ø·
async function showCoinFlipMenu(interaction) {
  const coinflipEmbed = new EmbedBuilder()
    .setColor('#ff5555')
    .setTitle('ğŸª™ Ø¨Ø§Ø²ÛŒ Ø´ÛŒØ± ÛŒØ§ Ø®Ø·')
    .setDescription('Ø´Ø§Ù†Ø³ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯! Ø§Ú¯Ø± Ø¯Ø±Ø³Øª Ø­Ø¯Ø³ Ø¨Ø²Ù†ÛŒØ¯ØŒ Ù…Ø¨Ù„Øº Ø´Ø±Ø· Ø´Ù…Ø§ Ø¯Ùˆ Ø¨Ø±Ø§Ø¨Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯.')
    .addFields(
      { name: 'Ø±ÙˆØ´ Ø¨Ø§Ø²ÛŒ', value: 'Ù…Ø¨Ù„Øº Ø´Ø±Ø· Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø®ÙˆØ¯ (Ø´ÛŒØ± ÛŒØ§ Ø®Ø·) Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:', inline: false },
      { name: 'Ø¯Ø³ØªÙˆØ± Ø¨Ø§Ø²ÛŒ', value: '`/coinflip [Ù…Ø¨Ù„Øº] [Ø§Ù†ØªØ®Ø§Ø¨]`', inline: false },
      { name: 'Ù…Ø«Ø§Ù„', value: '`/coinflip 100 Ø´ÛŒØ±`', inline: false }
    )
    .setFooter({ text: 'Ø´Ø§Ù†Ø³ Ø¨Ø±Ø¯: 50%' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [coinflipEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ ØªØ§Ø³
async function showDiceMenu(interaction) {
  const diceEmbed = new EmbedBuilder()
    .setColor('#ff5555')
    .setTitle('ğŸ² Ø¨Ø§Ø²ÛŒ ØªØ§Ø³')
    .setDescription('ÛŒÚ© Ø¹Ø¯Ø¯ Ø¨ÛŒÙ† 1 ØªØ§ 6 Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯. Ø§Ú¯Ø± ØªØ§Ø³ Ù‡Ù…Ø§Ù† Ø¹Ø¯Ø¯ Ø±Ø§ Ù†Ø´Ø§Ù† Ø¯Ù‡Ø¯ØŒ 6 Ø¨Ø±Ø§Ø¨Ø± Ù…Ø¨Ù„Øº Ø´Ø±Ø· Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø±ÙˆØ´ Ø¨Ø§Ø²ÛŒ', value: 'Ù…Ø¨Ù„Øº Ø´Ø±Ø· Ùˆ Ø¹Ø¯Ø¯ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø®ÙˆØ¯ (1-6) Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:', inline: false },
      { name: 'Ø¯Ø³ØªÙˆØ± Ø¨Ø§Ø²ÛŒ', value: '`/dice [Ù…Ø¨Ù„Øº] [Ø¹Ø¯Ø¯]`', inline: false },
      { name: 'Ù…Ø«Ø§Ù„', value: '`/dice 50 3`', inline: false }
    )
    .setFooter({ text: 'Ø´Ø§Ù†Ø³ Ø¨Ø±Ø¯: 16.6%' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [diceEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø³Ù†Ú¯ Ú©Ø§ØºØ° Ù‚ÛŒÚ†ÛŒ
async function showRPSMenu(interaction) {
  // Ø§ÛŒÙ† Ù…Ù†Ùˆ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø¯Ø³ØªÙˆØ± Ø§Ø³Ù„Ø´ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const rpsEmbed = new EmbedBuilder()
    .setColor('#ff5555')
    .setTitle('âœ‚ï¸ Ø¨Ø§Ø²ÛŒ Ø³Ù†Ú¯ Ú©Ø§ØºØ° Ù‚ÛŒÚ†ÛŒ')
    .setDescription('Ø¨Ø§ Ø±Ø¨Ø§Øª ÛŒØ§ Ø¯ÙˆØ³ØªØ§Ù† Ø®ÙˆØ¯ Ø³Ù†Ú¯ Ú©Ø§ØºØ° Ù‚ÛŒÚ†ÛŒ Ø¨Ø§Ø²ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø³Ú©Ù‡ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [rpsEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø­Ø¯Ø³ Ø¹Ø¯Ø¯
async function showGuessNumberMenu(interaction) {
  // Ø§ÛŒÙ† Ù…Ù†Ùˆ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø¯Ø³ØªÙˆØ± Ø§Ø³Ù„Ø´ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const guessEmbed = new EmbedBuilder()
    .setColor('#ff5555')
    .setTitle('ğŸ”¢ Ø¨Ø§Ø²ÛŒ Ø­Ø¯Ø³ Ø¹Ø¯Ø¯')
    .setDescription('ÛŒÚ© Ø¹Ø¯Ø¯ Ø¨ÛŒÙ† 1 ØªØ§ 10 Ø­Ø¯Ø³ Ø¨Ø²Ù†ÛŒØ¯. Ø§Ú¯Ø± Ø¯Ø±Ø³Øª Ø¨Ø§Ø´Ø¯ØŒ 10 Ø¨Ø±Ø§Ø¨Ø± Ù…Ø¨Ù„Øº Ø´Ø±Ø· Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [guessEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø¯Ø²Ø¯ÛŒ
async function showRobMenu(interaction) {
  const userId = interaction.user.id;
  const userLevel = await db.get(`level_${userId}`) || 1;
  const dailyPickpocketCount = await db.get(`dailyPickpocket_${userId}`) || 0;
  const remainingAttempts = 3 - dailyPickpocketCount;
  const userJob = await db.get(`job_${userId}`) || 'none';
  const userReputation = await db.get(`reputation_${userId}`) || 0;
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡
  const isThief = (userJob === 'thief');
  const isMastermind = (userJob === 'mastermind');
  const hasLockpickingSkill = await db.get(`skill_lockpicking_${userId}`) || false;
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­Ø±ÙˆÙ…ÛŒØª Ø§Ø² Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ
  const pickpocketBanned = await db.get(`pickpocketBanned_${userId}`) || false;
  const pickpocketBanExpiry = await db.get(`pickpocketBanExpiry_${userId}`) || 0;
  
  let banStatus = '';
  if (pickpocketBanned && pickpocketBanExpiry > Date.now()) {
    const timeLeft = Math.floor((pickpocketBanExpiry - Date.now()) / (1000 * 60 * 60));
    banStatus = `âš ï¸ **Ø´Ù…Ø§ Ù…Ø­Ø±ÙˆÙ… Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯!**\nØ´Ù…Ø§ Ø¨Ù‡ Ù…Ø¯Øª ${timeLeft} Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ø± Ø§Ø² Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù…Ø­Ø±ÙˆÙ… Ù‡Ø³ØªÛŒØ¯.`;
  }
  
  // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´ØºÙ„ Ùˆ Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§
  let quickSuccess = 70, professionalSuccess = 50, grandSuccess = 30;
  let extraBonusText = '';
  
  if (isThief) {
    quickSuccess += 10;
    professionalSuccess += 15;
    grandSuccess += 10;
    extraBonusText += 'â€¢ ğŸ¦¹â€â™‚ï¸ **Ø¨ÙˆÙ†ÙˆØ³ Ø´ØºÙ„ Ø¯Ø²Ø¯**: Ø§ÙØ²Ø§ÛŒØ´ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª\n';
  }
  
  if (isMastermind) {
    quickSuccess += 5;
    professionalSuccess += 10;
    grandSuccess += 15;
    extraBonusText += 'â€¢ ğŸ§  **Ø¨ÙˆÙ†ÙˆØ³ Ø°Ù‡Ù† Ù…Ø¯Ø¨Ø±**: Ø§ÙØ²Ø§ÛŒØ´ Ø´Ø§Ù†Ø³ Ø¯Ø± Ø¹Ù…Ù„ÛŒØ§Øªâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒÚ†ÛŒØ¯Ù‡\n';
  }
  
  if (hasLockpickingSkill) {
    quickSuccess += 5;
    professionalSuccess += 7;
    grandSuccess += 10;
    extraBonusText += 'â€¢ ğŸ”“ **Ù…Ù‡Ø§Ø±Øª Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ**: Ø§ÙØ²Ø§ÛŒØ´ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª\n';
  }
  
  // ØªÙ†Ø¸ÛŒÙ… Ø­Ø¯Ø§Ú©Ø«Ø± 95% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª
  quickSuccess = Math.min(quickSuccess, 95);
  professionalSuccess = Math.min(professionalSuccess, 95);
  grandSuccess = Math.min(grandSuccess, 95);
  
  const robEmbed = new EmbedBuilder()
    .setColor('#ff5555')
    .setTitle('ğŸ”ª Ø³ÛŒØ³ØªÙ… Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡')
    .setDescription('Ø¨Ø§ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø±ØŒ Ø³Ú©Ù‡â€ŒÙ‡Ø§ÛŒ Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯! Ù‡Ø± Ù†ÙˆØ¹ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø±ÛŒØ³Ú© Ùˆ Ù¾Ø§Ø¯Ø§Ø´ Ù…ØªÙØ§ÙˆØªÛŒ Ø¯Ø§Ø±Ø¯.')
    .addFields(
      { name: 'ğŸƒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø³Ø±ÛŒØ¹ (Ø³Ø·Ø­ 5+)', value: 
        `Ø¯Ø²Ø¯ÛŒ 1-3% Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø±Ø¨Ø§Ù†ÛŒ\n` +
        `Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª: ${quickSuccess}%\n` +
        `Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ú©Ø³Øª: 5% Ù…Ø¨Ù„Øº Ø¯Ø²Ø¯ÛŒ\n` +
        `Ú©ÙˆÙ„Ø¯Ø§Ù†: 2 Ø³Ø§Ø¹Øª`, 
        inline: true 
      },
      { name: 'ğŸ•µï¸ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ (Ø³Ø·Ø­ 10+)', value: 
        `Ø¯Ø²Ø¯ÛŒ 4-7% Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø±Ø¨Ø§Ù†ÛŒ\n` +
        `Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª: ${professionalSuccess}%\n` +
        `Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ú©Ø³Øª: 10% Ù…Ø¨Ù„Øº Ø¯Ø²Ø¯ÛŒ\n` +
        `Ú©ÙˆÙ„Ø¯Ø§Ù†: 4 Ø³Ø§Ø¹Øª`, 
        inline: true 
      },
      { name: 'ğŸ´â€â˜ ï¸ Ø¯Ø²Ø¯ÛŒ Ø¨Ø²Ø±Ú¯ (Ø³Ø·Ø­ 20+)', value: 
        `Ø¯Ø²Ø¯ÛŒ 8-10% Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø±Ø¨Ø§Ù†ÛŒ\n` +
        `Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª: ${grandSuccess}%\n` +
        `Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ú©Ø³Øª: 20% Ù…Ø¨Ù„Øº Ø¯Ø²Ø¯ÛŒ\n` +
        `Ù…Ø­Ø±ÙˆÙ…ÛŒØª 12 Ø³Ø§Ø¹ØªÙ‡\n` +
        `Ú©ÙˆÙ„Ø¯Ø§Ù†: 8 Ø³Ø§Ø¹Øª`, 
        inline: true 
      },
      { name: 'ğŸ¥· Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ', value: 
        'â€¢ **Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾Ù†Ù‡Ø§Ù†ÛŒ** (Ø³Ø·Ø­ 25+): Ø¯Ø²Ø¯ÛŒ Ø¨Ø§ Ø§Ø­ØªÙ…Ø§Ù„ Ú©Ø´Ù Ú©Ù…ØªØ±\n' +
        'â€¢ **Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©** (Ø³Ø·Ø­ 35+): Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø¨Ø§ Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ØªØ±\n' +
        'â€¢ **Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ú¯Ø±ÙˆÙ‡ÛŒ** (Ø³Ø·Ø­ 30+): Ù‡Ù…Ú©Ø§Ø±ÛŒ Ø¨Ø§ Ø¯ÙˆØ³ØªØ§Ù† Ø¨Ø±Ø§ÛŒ Ø¯Ø²Ø¯ÛŒ Ø¨Ø²Ø±Ú¯ØªØ±',
        inline: false 
      },
      { name: 'ğŸ“ Ø¯Ø³ØªÙˆØ± Ø§Ø³ØªÙØ§Ø¯Ù‡', value: 
        '`/pickpocket @user [Ù†ÙˆØ¹]`\n' +
        'Ù…Ø«Ø§Ù„: `/pickpocket @username quick`\n' +
        'Ø¨Ø±Ø§ÛŒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡: `/pickpocket @username stealth`', 
        inline: false 
      },
      { name: 'ğŸ“Š ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ø´Ù…Ø§', value: 
        `Ø³Ø·Ø­: ${userLevel}\n` +
        `Ø´ØºÙ„: ${userJob === 'thief' ? 'ğŸ¦¹â€â™‚ï¸ Ø¯Ø²Ø¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ' : (userJob === 'mastermind' ? 'ğŸ§  Ø°Ù‡Ù† Ù…Ø¯Ø¨Ø±' : 'Ø¨Ø¯ÙˆÙ† Ø´ØºÙ„ Ù…Ø±ØªØ¨Ø·')}\n` +
        `Ø´Ù‡Ø±Øª: ${userReputation} (${userReputation > 0 ? 'Ù…Ø«Ø¨Øª' : (userReputation < 0 ? 'Ù…Ù†ÙÛŒ' : 'Ø®Ù†Ø«ÛŒ')})\n` +
        `ØªÙ„Ø§Ø´â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡ Ø§Ù…Ø±ÙˆØ²: ${remainingAttempts}/3\n` +
        `${banStatus}`, 
        inline: false 
      }
    );
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨ÙˆÙ†ÙˆØ³â€ŒÙ‡Ø§ Ø§Ú¯Ø± ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ù†Ø¯
    if (extraBonusText !== '') {
      robEmbed.addFields({ 
        name: 'ğŸŒŸ Ø¨ÙˆÙ†ÙˆØ³â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§', 
        value: extraBonusText, 
        inline: false 
      });
    }
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§
    robEmbed.addFields({ 
      name: 'ğŸ” Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ', 
      value: 
        'â€¢ ÙÙ‚Ø· Ø§ÙØ±Ø§Ø¯ Ø¨Ø§Ù„Ø§ÛŒ Ø³Ø·Ø­ 5 Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ú©Ù†Ù†Ø¯\n' +
        'â€¢ Ù‡Ø± Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø±ÙˆØ² ÙÙ‚Ø· 3 Ø¨Ø§Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ú©Ù†Ø¯\n' +
        'â€¢ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØªØ§Ø²Ù‡â€ŒÙˆØ§Ø±Ø¯ (Ú©Ù…ØªØ± Ø§Ø² 7 Ø±ÙˆØ²) Ù‚Ø§Ø¨Ù„ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†ÛŒØ³ØªÙ†Ø¯\n' +
        'â€¢ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†ÛŒ Ú©Ù‡ Ø¯Ø± 24 Ø³Ø§Ø¹Øª Ø§Ø®ÛŒØ± Ø¬ÛŒØ¨â€ŒØ´Ø§Ù† Ø²Ø¯Ù‡ Ø´Ø¯Ù‡ØŒ ØªØ§ 12 Ø³Ø§Ø¹Øª Ø§ÛŒÙ…Ù† Ù‡Ø³ØªÙ†Ø¯\n' +
        'â€¢ Ø­Ø¯Ø§Ù‚Ù„ 200 Ø³Ú©Ù‡ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¨Ø±Ø§ÛŒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù„Ø§Ø²Ù… Ø§Ø³Øª\n' +
        'â€¢ Ø´Ù‡Ø±Øª Ù…Ù†ÙÛŒ Ù…ÙˆØ¬Ø¨ Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ø§Ø²Ø¯Ø§Ø´Øª ØªÙˆØ³Ø· Ù¾Ù„ÛŒØ³ Ù…ÛŒâ€ŒØ´ÙˆØ¯', 
      inline: false 
    })
    .setFooter({ text: 'Ø§Ø² Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ù…Ø§Ù†Ù†Ø¯ Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒØŒ Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§ØŒ Ùˆ Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯!' });

  const robRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('quick_rob_info')
        .setLabel('Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø³Ø±ÛŒØ¹')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸƒ'),
      new ButtonBuilder()
        .setCustomId('professional_rob_info')
        .setLabel('Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ•µï¸'),
      new ButtonBuilder()
        .setCustomId('grand_rob_info')
        .setLabel('Ø¯Ø²Ø¯ÛŒ Ø¨Ø²Ø±Ú¯')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ´â€â˜ ï¸')
    );
    
  const robRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('stealth_rob_info')
        .setLabel('Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾Ù†Ù‡Ø§Ù†ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ¥·'),
      new ButtonBuilder()
        .setCustomId('bank_rob_info')
        .setLabel('Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ¦'),
      new ButtonBuilder()
        .setCustomId('view_rob_history')
        .setLabel('ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ“œ')
    );

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [robEmbed], components: [robRow1, robRow2, backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…
async function showBuyItemMenu(interaction) {
  const buyEmbed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle('ğŸ’° Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…')
    .setDescription('Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ… Ø§Ø² ÙØ±ÙˆØ´Ú¯Ø§Ù‡ØŒ Ø§Ø² Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯:')
    .addFields(
      { name: 'Ø¯Ø³ØªÙˆØ± Ø®Ø±ÛŒØ¯', value: '`/buy [Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ…]`', inline: false },
      { name: 'Ù…Ø«Ø§Ù„', value: '`/buy 1` - Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ… Ø´Ù…Ø§Ø±Ù‡ 1', inline: false },
      { name: 'Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ', value: 'Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ù„ÛŒØ³Øª Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ùˆ Ø´Ù…Ø§Ø±Ù‡ Ø¢Ù†â€ŒÙ‡Ø§ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.', inline: false }
    )
    .setFooter({ text: 'Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø¯Ø± Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ Ø´Ù…Ø§ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('shop_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [buyEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡
async function showDailyQuests(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const dailyQuestsEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ“† Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡')
    .setDescription('Ø¨Ø§ Ø§Ù†Ø¬Ø§Ù… Ø§ÛŒÙ† Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ØŒ Ø³Ú©Ù‡ Ùˆ Ø¬ÙˆØ§ÛŒØ² ÙˆÛŒÚ˜Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('quests_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [dailyQuestsEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙØªÚ¯ÛŒ
async function showWeeklyQuests(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const weeklyQuestsEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ“… Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙØªÚ¯ÛŒ')
    .setDescription('Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù‡ÙØªÚ¯ÛŒ Ú†Ø§Ù„Ø´â€ŒØ¨Ø±Ø§Ù†Ú¯ÛŒØ²ØªØ± Ù‡Ø³ØªÙ†Ø¯ Ùˆ Ø¬ÙˆØ§ÛŒØ² Ø¨Ù‡ØªØ±ÛŒ Ø¯Ø§Ø±Ù†Ø¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('quests_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [weeklyQuestsEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø§ÛŒØ²Ù‡ Ù…Ø£Ù…ÙˆØ±ÛŒØª
async function claimQuestReward(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const claimQuestEmbed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle('ğŸ Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø§ÛŒØ²Ù‡ Ù…Ø£Ù…ÙˆØ±ÛŒØª')
    .setDescription('Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù‡ÛŒÚ† Ù…Ø£Ù…ÙˆØ±ÛŒØª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø§ÛŒØ²Ù‡ Ù†Ø¯Ø§Ø±ÛŒØ¯.')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('quests_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [claimQuestEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¦Ù„
async function startDuel(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const startDuelEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('ğŸ¥Š Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¦Ù„')
    .setDescription('Ø¨Ø§ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ø± Ù…Ø¨Ø§Ø±Ø²Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ø³Ú©Ù‡ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('duel_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [startDuelEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„
async function showActiveDuels(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const activeDuelsEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('ğŸ‘ï¸ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„')
    .setDescription('Ù„ÛŒØ³Øª Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø¯Ø± Ø³Ø±ÙˆØ±:')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('duel_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [activeDuelsEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ
async function placeBet(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const placeBetEmbed = new EmbedBuilder()
    .setColor('#e74c3c')
    .setTitle('ğŸ’° Ø´Ø±Ø·â€ŒØ¨Ù†Ø¯ÛŒ')
    .setDescription('Ø±ÙˆÛŒ Ù†ØªÛŒØ¬Ù‡ Ø¯ÙˆØ¦Ù„â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø´Ø±Ø· Ø¨Ø¨Ù†Ø¯ÛŒØ¯ Ùˆ Ø³Ú©Ù‡ Ø¨Ù‡ Ø¯Ø³Øª Ø¢ÙˆØ±ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('duel_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¯ÙˆØ¦Ù„')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [placeBetEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ø§ÛŒØ¬Ø§Ø¯ ØªÛŒÙ…
async function showCreateTeamMenu(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const createTeamEmbed = new EmbedBuilder()
    .setColor('#3498db')
    .setTitle('ğŸ†• Ø§ÛŒØ¬Ø§Ø¯ ØªÛŒÙ…')
    .setDescription('ØªÛŒÙ… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø§ Ù†Ø§Ù… Ø¯Ù„Ø®ÙˆØ§Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('teams_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ØªÛŒÙ…â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [createTeamEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ù¾ÛŒÙˆØ³ØªÙ† Ø¨Ù‡ ØªÛŒÙ…
async function showJoinTeamMenu(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const joinTeamEmbed = new EmbedBuilder()
    .setColor('#3498db')
    .setTitle('â• Ù¾ÛŒÙˆØ³ØªÙ† Ø¨Ù‡ ØªÛŒÙ…')
    .setDescription('Ø¨Ù‡ ÛŒÚ©ÛŒ Ø§Ø² ØªÛŒÙ…â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ù¾ÛŒÙˆÙ†Ø¯ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('teams_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ØªÛŒÙ…â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [joinTeamEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ØªÛŒÙ…
async function showManageTeamMenu(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const manageTeamEmbed = new EmbedBuilder()
    .setColor('#3498db')
    .setTitle('âš™ï¸ Ù…Ø¯ÛŒØ±ÛŒØª ØªÛŒÙ…')
    .setDescription('ØªÛŒÙ… Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('teams_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ØªÛŒÙ…â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [manageTeamEmbed], components: [backRow] });
}

// Ù…Ù†ÙˆÛŒ Ú†Ø§Ù„Ø´ ØªÛŒÙ…ÛŒ
async function showTeamChallengeMenu(interaction) {
  // Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ø§ÛŒØ¯ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´ÙˆØ¯
  const teamChallengeEmbed = new EmbedBuilder()
    .setColor('#3498db')
    .setTitle('ğŸ† Ú†Ø§Ù„Ø´ ØªÛŒÙ…ÛŒ')
    .setDescription('Ø¨Ø§ ØªÛŒÙ… Ø®ÙˆØ¯ Ø¯Ø± Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø´Ø±Ú©Øª Ú©Ù†ÛŒØ¯!')
    .addFields(
      { name: 'Ø§ÛŒÙ† ÙˆÛŒÚ˜Ú¯ÛŒ Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯!', value: 'Ù…Ù†ØªØ¸Ø± Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø¨Ø§Ø´ÛŒØ¯...', inline: false }
    )
    .setFooter({ text: 'Ø¯Ø± Ø­Ø§Ù„ ØªÙˆØ³Ø¹Ù‡...' });

  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('teams_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ ØªÛŒÙ…â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );

  await interaction.update({ embeds: [teamChallengeEmbed], components: [backRow] });
}
// Button interaction handling
client.on(Events.InteractionCreate, async interaction => {
  if (interaction.isButton()) {
    await handleButton(interaction);
  }

  if (!interaction.isChatInputCommand()) return;

  const { commandName, options } = interaction;

  // Handle commands
  try {
    switch(commandName) {
      case 'menu':
        await showMainMenu(interaction);
        break;
      case 'wallet':
      case 'bank':
        await checkBalance(interaction);
        break;
      case 'daily':
        await claimDaily(interaction);
        break;
      case 'deposit':
        await depositMoney(interaction, options.getString('amount'));
        break;
      case 'withdraw':
        await withdrawMoney(interaction, options.getString('amount'));
        break;
      case 'rob':
        await robUser(interaction, options.getUser('target'));
        break;
      case 'pickpocket':
        await robUser(interaction, options.getUser('target'));
        break;
      case 'coinflip':
        await playCoinFlip(interaction, options.getString('amount'), options.getString('choice'));
        break;
      case 'dice':
        await playDice(interaction, options.getString('amount'), options.getInteger('number'));
        break;
      case 'shop':
        await showShop(interaction);
        break;
      case 'buy':
        await buyItem(interaction, options.getInteger('item'));
        break;
      case 'inventory':
        await showInventory(interaction);
        break;
      case 'profile':
        await showProfile(interaction);
        break;
      case 'leaderboard':
        await showLeaderboard(interaction);
        break;
      case 'transfer':
        await transferMoney(interaction, options.getUser('target'), options.getString('amount'));
        break;
    }
  } catch (error) {
    console.error(error);
    if (interaction.replied || interaction.deferred) {
      await interaction.followUp({ content: 'âŒ Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯! Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.', ephemeral: true });
    } else {
      await interaction.reply({ content: 'âŒ Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯! Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.', ephemeral: true });
    }
  }
});

// Command functions
async function checkBalance(interaction) {
  const userId = interaction.user.id;

  const wallet = await db.get(`wallet_${userId}`) || 0;
  const bank = await db.get(`bank_${userId}`) || 0;

  const embed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle(`ğŸ’° Ú©ÛŒÙ Ù¾ÙˆÙ„ ${interaction.user.username}`)
    .setThumbnail(interaction.user.displayAvatarURL())
    .addFields(
      { name: 'ğŸ‘› Ú©ÛŒÙ Ù¾ÙˆÙ„', value: `${wallet} ğŸª™`, inline: true },
      { name: 'ğŸ¦ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ', value: `${bank} ğŸª™`, inline: true },
      { name: 'ğŸ’² Ù…Ø¬Ù…ÙˆØ¹', value: `${wallet + bank} ğŸª™`, inline: true }
    )
    .setFooter({ text: 'Ø³ÛŒØ³ØªÙ… Ø§Ù‚ØªØµØ§Ø¯ÛŒ Holi Coin' })
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

async function claimDaily(interaction) {
  const userId = interaction.user.id;
  const lastDaily = await db.get(`lastDaily_${userId}`);
  const now = Date.now();

  if (lastDaily && now - lastDaily < 24 * 60 * 60 * 1000) {
    const timeLeft = 24 * 60 * 60 * 1000 - (now - lastDaily);
    const hours = Math.floor(timeLeft / (60 * 60 * 1000));
    const minutes = Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000));

    return interaction.reply({ content: `âŒ Ø´Ù…Ø§ Ù‚Ø¨Ù„Ø§Ù‹ Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! ${hours} Ø³Ø§Ø¹Øª Ùˆ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¯ÛŒÚ¯Ø± Ø¨Ø±Ú¯Ø±Ø¯ÛŒØ¯.`, ephemeral: true });
  }

  await db.add(`wallet_${userId}`, DAILY_AMOUNT);
  await db.set(`lastDaily_${userId}`, now);

  const embed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('ğŸ Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡')
    .setDescription(`Ø´Ù…Ø§ ${DAILY_AMOUNT} ğŸª™ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯ÛŒØ¯!`)
    .setFooter({ text: 'Ù‡Ø± Û²Û´ Ø³Ø§Ø¹Øª ÛŒÚ©Ø¨Ø§Ø± Ø¬Ø§ÛŒØ²Ù‡ Ø¨Ú¯ÛŒØ±ÛŒØ¯!' })
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

async function depositMoney(interaction, amountStr) {
  const userId = interaction.user.id;
  let amount = amountStr;

  const wallet = await db.get(`wallet_${userId}`) || 0;

  if (!amount) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø±ÛŒ Ø±Ø§ Ø¨Ø±Ø§ÛŒ ÙˆØ§Ø±ÛŒØ² ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  if (amount === 'all') {
    amount = wallet;
  } else {
    amount = parseInt(amount);
    if (isNaN(amount)) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }

  if (amount <= 0) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ù‚Ø¯Ø§Ø± ØµÙØ± ÛŒØ§ Ù…Ù†ÙÛŒ ÙˆØ§Ø±ÛŒØ² Ú©Ù†ÛŒØ¯!', ephemeral: true });
  if (amount > wallet) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });

  await db.sub(`wallet_${userId}`, amount);
  await db.add(`bank_${userId}`, amount);

  const embed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ¦ ÙˆØ§Ø±ÛŒØ² Ù…ÙˆÙÙ‚')
    .setDescription(`Ø´Ù…Ø§ ${amount} ğŸª™ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø®ÙˆØ¯ ÙˆØ§Ø±ÛŒØ² Ú©Ø±Ø¯ÛŒØ¯!`)
    .setFooter({ text: 'Ø§Ø² Ø³Ù¾Ø±Ø¯Ù‡ Ø®ÙˆØ¯ Ø³ÙˆØ¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯!' })
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

async function withdrawMoney(interaction, amountStr) {
  const userId = interaction.user.id;
  let amount = amountStr;

  const bank = await db.get(`bank_${userId}`) || 0;

  if (!amount) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø±ÛŒ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø¯Ø§Ø´Øª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  if (amount === 'all') {
    amount = bank;
  } else {
    amount = parseInt(amount);
    if (isNaN(amount)) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }

  if (amount <= 0) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ù‚Ø¯Ø§Ø± ØµÙØ± ÛŒØ§ Ù…Ù†ÙÛŒ Ø¨Ø±Ø¯Ø§Ø´Øª Ú©Ù†ÛŒØ¯!', ephemeral: true });
  if (amount > bank) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ø¯Ø± Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø®ÙˆØ¯ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });

  await db.sub(`bank_${userId}`, amount);
  await db.add(`wallet_${userId}`, amount);

  const embed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ¦ Ø¨Ø±Ø¯Ø§Ø´Øª Ù…ÙˆÙÙ‚')
    .setDescription(`Ø´Ù…Ø§ ${amount} ğŸª™ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù†Ú©ÛŒ Ø®ÙˆØ¯ Ø¨Ø±Ø¯Ø§Ø´Øª Ú©Ø±Ø¯ÛŒØ¯!`)
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

async function robUser(interaction, targetUser) {
  const robber = interaction.user.id;

  if (!targetUser) 
    return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø¯Ø²Ø¯ÛŒ Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  const victim = targetUser.id;
  
  // Check presence of type option (to support old command format)
  const typeOption = interaction.options.getString('type');
  const pickpocketType = typeOption || 'quick'; // Default to 'quick' if not specified

  // Cannot rob yourself
  if (victim === robber) 
    return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø®ÙˆØ¯ØªØ§Ù† Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  // Cannot rob bots
  if (targetUser.bot) 
    return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø±Ø¨Ø§Øªâ€ŒÙ‡Ø§ Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯!', ephemeral: true });
    
  // Get user level
  const userLevel = await db.get(`level_${robber}`) || 1;
  
  // Check if user meets the minimum level requirements
  if (userLevel < 5) {
    return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ 5 Ø¨Ø§Ø´ÛŒØ¯ ØªØ§ Ø¨ØªÙˆØ§Ù†ÛŒØ¯ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }
  
  // Check level requirements for each type of pickpocketing
  if (pickpocketType === 'professional' && userLevel < 10) {
    return interaction.reply({ content: 'âŒ Ø¨Ø±Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ 10 Ø¨Ø§Ø´ÛŒØ¯!', ephemeral: true });
  }
  
  if (pickpocketType === 'grand' && userLevel < 20) {
    return interaction.reply({ content: 'âŒ Ø¨Ø±Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ø²Ø¯ÛŒ Ø¨Ø²Ø±Ú¯ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ 20 Ø¨Ø§Ø´ÛŒØ¯!', ephemeral: true });
  }
  
  // Check daily limit
  const dailyPickpocketCount = await db.get(`dailyPickpocket_${robber}`) || 0;
  
  if (dailyPickpocketCount >= 3) {
    return interaction.reply({ content: 'ğŸš« | Ø´Ù…Ø§ Ø§Ù…Ø±ÙˆØ² Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ø¬ÛŒØ¨ Ø²Ø¯Ù‡â€ŒØ§ÛŒØ¯! ÙØ±Ø¯Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.', ephemeral: true });
  }
  
  // Check if victim is a new user (less than 7 days in server)
  const targetJoinedAt = interaction.guild.members.cache.get(victim)?.joinedTimestamp || 0;
  const now = Date.now();
  
  if (now - targetJoinedAt < 7 * 24 * 60 * 60 * 1000) {
    return interaction.reply({ content: 'âŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ØªØ§Ø²Ù‡â€ŒÙˆØ§Ø±Ø¯ (Ú©Ù…ØªØ± Ø§Ø² 7 Ø±ÙˆØ² Ø­Ø¶ÙˆØ± Ø¯Ø± Ø³Ø±ÙˆØ±) Ù‚Ø§Ø¨Ù„ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†ÛŒØ³ØªÙ†Ø¯!', ephemeral: true });
  }
  
  // Check if victim has been pickpocketed recently (12 hour immunity)
  const lastPickpocketed = await db.get(`lastPickpocketed_${victim}`) || 0;
  
  if (now - lastPickpocketed < 12 * 60 * 60 * 1000) {
    return interaction.reply({ content: 'âŒ Ø§ÛŒÙ† Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± 12 Ø³Ø§Ø¹Øª Ú¯Ø°Ø´ØªÙ‡ Ù…ÙˆØ±Ø¯ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù‚Ø±Ø§Ø± Ú¯Ø±ÙØªÙ‡ Ùˆ ÙØ¹Ù„Ø§Ù‹ Ø§ÛŒÙ…Ù† Ø§Ø³Øª!', ephemeral: true });
  }
  
  // Check victim's wallet balance
  const victimWallet = await db.get(`wallet_${victim}`) || 0;
  
  if (victimWallet < 200) {
    return interaction.reply({ content: 'âŒ Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ú©Ø§Ø±Ø¨Ø± Ú©Ù…ØªØ± Ø§Ø² 200 Ø³Ú©Ù‡ Ø¨Ø§Ø´Ø¯ØŒ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø±ÙˆÛŒ Ø§Ùˆ Ù‚ÙÙ„ Ø§Ø³Øª!', ephemeral: true });
  }
  
  // Check cooldown based on pickpocket type
  const lastPickpocket = await db.get(`lastPickpocket_${robber}`) || 0;
  let cooldown, successChance, stealMinPercent, stealMaxPercent, failPenaltyPercent;
  
  switch (pickpocketType) {
    case 'quick':
      cooldown = 2 * 60 * 60 * 1000; // 2 hours
      successChance = 0.7; // 70%
      stealMinPercent = 0.01; // 1%
      stealMaxPercent = 0.03; // 3%
      failPenaltyPercent = 0.05; // 5%
      break;
      
    case 'professional':
      cooldown = 4 * 60 * 60 * 1000; // 4 hours
      successChance = 0.5; // 50%
      stealMinPercent = 0.04; // 4%
      stealMaxPercent = 0.07; // 7%
      failPenaltyPercent = 0.1; // 10%
      break;
      
    case 'grand':
      cooldown = 8 * 60 * 60 * 1000; // 8 hours
      successChance = 0.3; // 30%
      stealMinPercent = 0.08; // 8%
      stealMaxPercent = 0.1; // 10%
      failPenaltyPercent = 0.2; // 20%
      break;
      
    default:
      return interaction.reply({ content: 'âŒ Ù†ÙˆØ¹ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª!', ephemeral: true });
  }
  
  // Check if user cooldown has passed
  if (now - lastPickpocket < cooldown) {
    const timeLeft = cooldown - (now - lastPickpocket);
    const hours = Math.floor(timeLeft / (1000 * 60 * 60));
    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
    
    return interaction.reply({ 
      content: `âŒ Ø´Ù…Ø§ Ø¨Ø§ÛŒØ¯ ${hours} Ø³Ø§Ø¹Øª Ùˆ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¯ÛŒÚ¯Ø± ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨ØªÙˆØ§Ù†ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ú©Ù†ÛŒØ¯!`, 
      ephemeral: true 
    });
  }
  
  // Check if victim has anti-theft insurance
  const hasInsurance = await db.get(`insurance_${victim}`) || false;
  const insuranceExpiry = await db.get(`insuranceExpiry_${victim}`) || 0;
  
  if (hasInsurance && insuranceExpiry > now) {
    successChance *= 0.5; // 50% less chance of success if victim has insurance
  }
  
  // Check if robber has thief's dagger
  const hasDagger = await db.get(`thief_dagger_${robber}`) || false;
  
  if (hasDagger) {
    successChance += 0.1; // +10% success chance with dagger
  }
  
  // Check if robber has ninja mask
  const hasNinjaMask = await db.get(`ninja_mask_${robber}`) || false;
  
  // Calculate chance of success (random)
  const isSuccess = Math.random() < successChance;
  
  // Calculate theft amount (percent of victim's wallet)
  const stealPercent = Math.random() * (stealMaxPercent - stealMinPercent) + stealMinPercent;
  const maxPossibleSteal = Math.floor(victimWallet * stealMaxPercent); // Cap at 10% of wallet
  const calculatedStealAmount = Math.floor(victimWallet * stealPercent);
  const stealAmount = Math.min(calculatedStealAmount, maxPossibleSteal);
  
  // Set cooldown and increment daily count
  await db.set(`lastPickpocket_${robber}`, now);
  await db.add(`dailyPickpocket_${robber}`, 1);
  
  // Handle failed pickpocket attempts
  const failedAttempts = await db.get(`failedPickpocketAttempts_${robber}`) || 0;
  
  if (!isSuccess) {
    // Calculate penalty amount (percentage of what they tried to steal)
    const penaltyAmount = Math.floor(stealAmount * failPenaltyPercent);
    
    // Check if robber has ninja mask to reduce penalty
    const finalPenalty = hasNinjaMask ? Math.floor(penaltyAmount * 0.8) : penaltyAmount; // 20% less penalty
    
    // Transfer penalty from robber to victim
    await db.sub(`wallet_${robber}`, finalPenalty);
    await db.add(`wallet_${victim}`, finalPenalty);
    
    // Record failed attempt
    await db.add(`failedPickpocketAttempts_${robber}`, 1);
    
    let failEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('ğŸš¨ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚!')
      .setDescription(`Ø´Ù…Ø§ Ø¯Ø± Ø­ÛŒÙ† Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø§Ø² <@${victim}> Ú¯ÛŒØ± Ø§ÙØªØ§Ø¯ÛŒØ¯ Ùˆ ${finalPenalty} ğŸª™ Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ø¯ÛŒØ¯!`)
      .setTimestamp();
    
    // Check if user has failed 3 times, ban them from pickpocketing for 24 hours
    if (failedAttempts + 1 >= 3) {
      await db.set(`pickpocketBanned_${robber}`, true);
      await db.set(`pickpocketBanExpiry_${robber}`, now + 24 * 60 * 60 * 1000); // 24 hour ban
      await db.set(`failedPickpocketAttempts_${robber}`, 0); // Reset counter
      
      failEmbed.addFields({ 
        name: 'ğŸš“ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ!', 
        value: 'Ø´Ù…Ø§ 3 Ø¨Ø§Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¯Ø§Ø´ØªÙ‡â€ŒØ§ÛŒØ¯ Ùˆ Ø¨Ø±Ø§ÛŒ 24 Ø³Ø§Ø¹Øª Ø§Ø² Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù…Ø­Ø±ÙˆÙ… Ø´Ø¯ÛŒØ¯!' 
      });
    }
    
    // For grand theft, apply 12 hour pickpocketing ban on failure
    if (pickpocketType === 'grand') {
      await db.set(`pickpocketBanned_${robber}`, true);
      await db.set(`pickpocketBanExpiry_${robber}`, now + 12 * 60 * 60 * 1000); // 12 hour ban
      
      failEmbed.addFields({ 
        name: 'ğŸ‘® Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ù…ÙˆÙ‚Øª!', 
        value: 'Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø´Ú©Ø³Øª Ø¯Ø± Ø¯Ø²Ø¯ÛŒ Ø¨Ø²Ø±Ú¯ØŒ Ø´Ù…Ø§ Ø¨Ø±Ø§ÛŒ 12 Ø³Ø§Ø¹Øª Ø§Ø² Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù…Ø­Ø±ÙˆÙ… Ø´Ø¯ÛŒØ¯!' 
      });
    }
    
    return interaction.reply({ embeds: [failEmbed] });
  }
  
  // Successful pickpocket
  // Mark victim as pickpocketed
  await db.set(`lastPickpocketed_${victim}`, now);
  
  // Transfer stolen amount
  await db.sub(`wallet_${victim}`, stealAmount);
  await db.add(`wallet_${robber}`, stealAmount);
  
  // Reset failed attempts counter on success
  await db.set(`failedPickpocketAttempts_${robber}`, 0);
  
  // Create and send success embed
  const successEmbed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle(`ğŸ’° ${pickpocketType === 'quick' ? 'Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø³Ø±ÛŒØ¹' : (pickpocketType === 'professional' ? 'Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ' : 'Ø¯Ø²Ø¯ÛŒ Ø¨Ø²Ø±Ú¯')} Ù…ÙˆÙÙ‚!`)
    .setDescription(`Ø´Ù…Ø§ ${stealAmount} ğŸª™ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ <@${victim}> Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ú©Ø±Ø¯ÛŒØ¯!`)
    .addFields({ 
      name: `${pickpocketType === 'quick' ? 'ğŸƒâ€â™‚ï¸' : (pickpocketType === 'professional' ? 'ğŸ•µï¸' : 'ğŸ´â€â˜ ï¸')} Ù†ÙˆØ¹ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ`, 
      value: `${pickpocketType === 'quick' ? 'Ø³Ø±ÛŒØ¹' : (pickpocketType === 'professional' ? 'Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ' : 'Ø¨Ø²Ø±Ú¯')}` 
    })
    .setTimestamp();
  
  // Add extra info if user had items
  if (hasDagger || hasNinjaMask) {
    let itemsUsed = '';
    if (hasDagger) itemsUsed += 'ğŸ”ª Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ\n';
    if (hasNinjaMask) itemsUsed += 'ğŸ•¶ï¸ Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§\n';
    
    successEmbed.addFields({ name: 'ğŸ§° Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡', value: itemsUsed });
  }
  
  return interaction.reply({ embeds: [successEmbed] });
}

async function playCoinFlip(interaction, amountStr, choice) {
  if (!amountStr || !choice) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ø´Ø±Ø· Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ø®ÙˆØ¯ (Ø´ÛŒØ±/Ø®Ø·) Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  let amount = amountStr;

  // Validate choice
  if (choice !== 'Ø´ÛŒØ±' && choice !== 'Ø®Ø·') 
    return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø¹ØªØ¨Ø± (Ø´ÛŒØ±/Ø®Ø·) ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;

  // Validate bet amount
  if (amount === 'all') {
    amount = wallet;
  } else {
    amount = parseInt(amount);
    if (isNaN(amount)) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }

  if (amount <= 0) return interaction.reply({ content: 'âŒ Ù…Ù‚Ø¯Ø§Ø± Ø´Ø±Ø· Ø¨Ø§ÛŒØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² ØµÙØ± Ø¨Ø§Ø´Ø¯!', ephemeral: true });
  if (amount > wallet) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });

  // Flip the coin
  const result = Math.random() < 0.5 ? 'Ø´ÛŒØ±' : 'Ø®Ø·';

  // Create embed for result
  const embed = new EmbedBuilder()
    .setTitle('ğŸª™ Ø´ÛŒØ± ÛŒØ§ Ø®Ø·')
    .setDescription(`Ø´Ù…Ø§ **${amount}** ğŸª™ Ø¨Ø± Ø±ÙˆÛŒ **${choice}** Ø´Ø±Ø· Ø¨Ø³ØªÛŒØ¯.`)
    .addFields({ name: 'Ù†ØªÛŒØ¬Ù‡', value: `**${result}**` })
    .setTimestamp();

  // Determine outcome
  if (result === choice) {
    await db.add(`wallet_${userId}`, amount);
    embed.setColor('#00ff00')
      .addFields({ name: 'Ø¨Ø±Ø¯! ğŸ‰', value: `Ø´Ù…Ø§ **${amount * 2}** ğŸª™ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯!` });
  } else {
    await db.sub(`wallet_${userId}`, amount);
    embed.setColor('#ff0000')
      .addFields({ name: 'Ø¨Ø§Ø®Øª! ğŸ˜¢', value: `Ø´Ù…Ø§ **${amount}** ğŸª™ Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯ÛŒØ¯!` });
  }

  await interaction.reply({ embeds: [embed] });
}

async function playDice(interaction, amountStr, choice) {
  if (!amountStr || !choice) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ø´Ø±Ø· Ùˆ Ø¹Ø¯Ø¯ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± (1-6) Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  let amount = amountStr;

  // Validate choice
  if (isNaN(choice) || choice < 1 || choice > 6) 
    return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¹Ø¯Ø¯ Ø¨ÛŒÙ† 1 ØªØ§ 6 Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;

  // Validate bet amount
  if (amount === 'all') {
    amount = wallet;
  } else {
    amount = parseInt(amount);
    if (isNaN(amount)) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }

  if (amount <= 0) return interaction.reply({ content: 'âŒ Ù…Ù‚Ø¯Ø§Ø± Ø´Ø±Ø· Ø¨Ø§ÛŒØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² ØµÙØ± Ø¨Ø§Ø´Ø¯!', ephemeral: true });
  if (amount > wallet) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });

  // Roll the dice
  const result = Math.floor(Math.random() * 6) + 1;

  // Create embed for result
  const embed = new EmbedBuilder()
    .setTitle('ğŸ² ØªØ§Ø³')
    .setDescription(`Ø´Ù…Ø§ **${amount}** ğŸª™ Ø¨Ø± Ø±ÙˆÛŒ Ø¹Ø¯Ø¯ **${choice}** Ø´Ø±Ø· Ø¨Ø³ØªÛŒØ¯.`)
    .addFields({ name: 'Ù†ØªÛŒØ¬Ù‡', value: `**${result}**` })
    .setTimestamp();

  // Determine outcome
  if (result === choice) {
    const winnings = amount * 5; // 6x payout (5x profit)
    await db.add(`wallet_${userId}`, amount * 5);
    embed.setColor('#00ff00')
      .addFields({ name: 'Ø¨Ø±Ø¯! ğŸ‰', value: `Ø´Ù…Ø§ **${winnings}** ğŸª™ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯!` });
  } else {
    await db.sub(`wallet_${userId}`, amount);
    embed.setColor('#ff0000')
      .addFields({ name: 'Ø¨Ø§Ø®Øª! ğŸ˜¢', value: `Ø´Ù…Ø§ **${amount}** ğŸª™ Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯ÛŒØ¯!` });
  }

  await interaction.reply({ embeds: [embed] });
}

async function showShop(interaction) {
  const userId = interaction.user.id;
  const userJob = await db.get(`job_${userId}`) || 'none';
  const isTrader = userJob === 'trader';
  const hasVIP = await db.get(`vip_${userId}`) || false;
  const vipExpiry = await db.get(`vipExpiry_${userId}`) || 0;
  const hasActiveVIP = hasVIP && vipExpiry > Date.now();
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¹Ø§Ø¯ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  const shop = [
    { id: 1, name: 'ğŸ›¡ï¸ Ù…Ø­Ø§ÙØ¸ Ø´Ø®ØµÛŒ', price: 1000, description: 'Ø§Ø² Ø¯Ø²Ø¯ÛŒ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Û²Û´ Ø³Ø§Ø¹Øª)' },
    { id: 2, name: 'ğŸ”® ØªÙˆÚ©Ù† VIP', price: 5000, description: 'Ø¨Ù‡ Ù…Ø¯Øª Û· Ø±ÙˆØ² ÙˆØ¶Ø¹ÛŒØª VIP Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯' },
    { id: 3, name: 'ğŸ Ø¬Ø¹Ø¨Ù‡ Ø´Ø§Ù†Ø³', price: 500, description: 'Ù…Ø­ØªÙˆØ§ÛŒ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø§ Ø§Ø±Ø²Ø´ Ø¨Ø§Ù„Ù‚ÙˆÙ‡ Ø¨Ø§Ù„Ø§' },
    { id: 4, name: 'ğŸ’¹ Ø¨ÛŒÙ…Ù‡ Ø¶Ø¯ Ø³Ø±Ù‚Øª', price: 5000, description: '50% Ú©Ø§Ù‡Ø´ Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø±ÙˆÛŒ Ø´Ù…Ø§ (Û· Ø±ÙˆØ²)' },
    { id: 5, name: 'ğŸ† Ù†Ø´Ø§Ù† Ø§ÙØªØ®Ø§Ø±', price: 10000, description: 'ÛŒÚ© Ù†Ø´Ø§Ù† ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù¾Ø±ÙˆÙØ§ÛŒÙ„' },
    { id: 6, name: 'ğŸ”ª Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ', price: 1500, description: 'Ø§ÙØ²Ø§ÛŒØ´ 10% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ' },
    { id: 7, name: 'ğŸ•¶ï¸ Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§', price: 3000, description: 'Ú©Ø§Ù‡Ø´ 20% Ø¬Ø±ÛŒÙ…Ù‡ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚' },
    { id: 8, name: 'ğŸ§¤ Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ', price: 2500, description: 'Ú©Ø§Ù‡Ø´ 25% Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾Ù†Ù‡Ø§Ù†ÛŒ' },
    { id: 9, name: 'ğŸ§  Ú©ØªØ§Ø¨ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ', price: 7500, description: 'Ø¢Ù…ÙˆØ²Ø´ Ù…Ù‡Ø§Ø±Øª Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©' },
    { id: 10, name: 'ğŸ  Ø³Ù†Ø¯ Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Ú©ÙˆÚ†Ú©', price: 20000, description: 'Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡: 100 Ø³Ú©Ù‡ | Ù…Ø­Ø§ÙØ¸Øª Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø¯Ø²Ø¯ÛŒ' }
  ];
  
  // Ù„ÙˆØª Ø¨Ø§Ú©Ø³â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
  const lootboxes = [
    { id: 101, name: 'ğŸ¥‰ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø¨Ø±Ù†Ø²ÛŒ', price: 500, description: 'Ø´Ø§Ù†Ø³ Ø¯Ø±ÛŒØ§ÙØª 200 ØªØ§ 1000 Ø³Ú©Ù‡ ÛŒØ§ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡' },
    { id: 102, name: 'ğŸ¥ˆ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ', price: 2000, description: 'Ø´Ø§Ù†Ø³ Ø¯Ø±ÛŒØ§ÙØª 1000 ØªØ§ 5000 Ø³Ú©Ù‡ ÛŒØ§ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ØªÙˆØ³Ø·' },
    { id: 103, name: 'ğŸ¥‡ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø·Ù„Ø§ÛŒÛŒ', price: 5000, description: 'Ø´Ø§Ù†Ø³ Ø¯Ø±ÛŒØ§ÙØª 5000 ØªØ§ 20000 Ø³Ú©Ù‡ ÛŒØ§ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ø¯Ø±' }
  ];
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ù…Ø®ØµÙˆØµ VIP
  const vipOnlyItems = [
    { id: 201, name: 'ğŸ” Ø¹ÛŒÙ†Ú© Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ', price: 15000, description: 'Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø±Ø¨Ø§Ù†ÛŒ Ù‚Ø¨Ù„ Ø§Ø² Ø¯Ø²Ø¯ÛŒ' },
    { id: 202, name: 'ğŸª„ Ø¹ØµØ§ÛŒ Ø¬Ø§Ø¯ÙˆÛŒÛŒ', price: 25000, description: '20% Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø§Ù†Ø±Ú˜ÛŒ Ùˆ Ú©ÙˆÙ„Ø¯Ø§ÙˆÙ†â€ŒÙ‡Ø§' },
    { id: 203, name: 'ğŸšï¸ Ø³Ù†Ø¯ ÙˆÛŒÙ„Ø§ÛŒ Ù„ÙˆÚ©Ø³', price: 50000, description: 'Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡: 500 Ø³Ú©Ù‡ | Ø§Ù…Ù†ÛŒØª Ú©Ø§Ù…Ù„' }
  ];
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ ØªØ§Ø¬Ø±Ù‡Ø§
  const traderOnlyItems = [
    { id: 301, name: 'ğŸ“ˆ Ø¬Ø¯ÙˆÙ„ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±', price: 3000, description: 'Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ùˆ Ø¨Ù‡ØªØ±ÛŒÙ† Ù…Ø¹Ø§Ù…Ù„Ø§Øª' },
    { id: 302, name: 'ğŸ§ª Ø§Ú©Ø³ÛŒØ± ØªØ§Ø¬Ø±', price: 8000, description: '30% Ø§ÙØ²Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´ Ø¨Ø±Ø§ÛŒ 24 Ø³Ø§Ø¹Øª' }
  ];

  // Ø§Ø¹Ù…Ø§Ù„ ØªØ®ÙÛŒÙ Ø¨Ø±Ø§ÛŒ ØªØ§Ø¬Ø±Ù‡Ø§
  const applyDiscount = (price) => {
    let finalPrice = price;
    
    if (isTrader) {
      finalPrice = Math.floor(price * 0.9); // 10% ØªØ®ÙÛŒÙ
    }
    
    if (hasActiveVIP) {
      finalPrice = Math.floor(finalPrice * 0.95); // 5% ØªØ®ÙÛŒÙ Ø§Ø¶Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ VIP
    }
    
    return finalPrice;
  };

  // Ù…ØªÙ† ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  let shopText = '';
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¹Ø§Ø¯ÛŒ
  shopText += '**ğŸ›’ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ:**\n\n';
  for (const item of shop) {
    const finalPrice = applyDiscount(item.price);
    const discountText = finalPrice < item.price ? ` (ØªØ®ÙÛŒÙ: **${item.price - finalPrice}** ğŸª™)` : '';
    
    shopText += `**${item.id}.** ${item.name} - **${finalPrice}** ğŸª™${discountText}\n${item.description}\n\n`;
  }
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÙˆØª Ø¨Ø§Ú©Ø³â€ŒÙ‡Ø§
  shopText += '**ğŸ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³â€ŒÙ‡Ø§:**\n\n';
  for (const box of lootboxes) {
    const finalPrice = applyDiscount(box.price);
    const discountText = finalPrice < box.price ? ` (ØªØ®ÙÛŒÙ: **${box.price - finalPrice}** ğŸª™)` : '';
    
    shopText += `**${box.id}.** ${box.name} - **${finalPrice}** ğŸª™${discountText}\n${box.description}\n\n`;
  }
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ VIP Ø¯Ø± ØµÙˆØ±Øª Ø¯Ø§Ø´ØªÙ† VIP
  if (hasActiveVIP) {
    shopText += '**ğŸ‘‘ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ VIP:**\n\n';
    for (const item of vipOnlyItems) {
      const finalPrice = applyDiscount(item.price);
      const discountText = finalPrice < item.price ? ` (ØªØ®ÙÛŒÙ: **${item.price - finalPrice}** ğŸª™)` : '';
      
      shopText += `**${item.id}.** ${item.name} - **${finalPrice}** ğŸª™${discountText}\n${item.description}\n\n`;
    }
  }
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ ØªØ§Ø¬Ø±
  if (isTrader) {
    shopText += '**ğŸ§™â€â™‚ï¸ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ ØªØ§Ø¬Ø±:**\n\n';
    for (const item of traderOnlyItems) {
      const finalPrice = applyDiscount(item.price);
      const discountText = finalPrice < item.price ? ` (ØªØ®ÙÛŒÙ: **${item.price - finalPrice}** ğŸª™)` : '';
      
      shopText += `**${item.id}.** ${item.name} - **${finalPrice}** ğŸª™${discountText}\n${item.description}\n\n`;
    }
  }

  const embed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle(`ğŸ›’ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ ${hasActiveVIP ? 'ğŸ‘‘ VIP' : ''}`)
    .setDescription(shopText)
    .setFooter({ 
      text: isTrader 
        ? 'Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ØªØ§Ø¬Ø±ØŒ Ø´Ù…Ø§ 10% ØªØ®ÙÛŒÙ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯! Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¯Ø³ØªÙˆØ± /buy Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯'
        : (hasActiveVIP 
          ? 'Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ú©Ø§Ø±Ø¨Ø± VIP Ø´Ù…Ø§ 5% ØªØ®ÙÛŒÙ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯! Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¯Ø³ØªÙˆØ± /buy Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯'
          : 'Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§Ø² Ø¯Ø³ØªÙˆØ± /buy Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯') 
    })
    .setTimestamp();

  // Ø³Ø§Ø®Øª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©ØªÚ¯ÙˆØ±ÛŒâ€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  const shopCategoryRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('shop_general')
        .setLabel('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ›’'),
      new ButtonBuilder()
        .setCustomId('shop_lootboxes')
        .setLabel('Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³â€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ'),
      new ButtonBuilder()
        .setCustomId('shop_vip')
        .setLabel('Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ VIP')
        .setStyle(hasActiveVIP ? ButtonStyle.Success : ButtonStyle.Secondary)
        .setEmoji('ğŸ‘‘')
        .setDisabled(!hasActiveVIP),
      new ButtonBuilder()
        .setCustomId('shop_black_market')
        .setLabel('Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡')
        .setStyle(isTrader ? ButtonStyle.Danger : ButtonStyle.Secondary)
        .setEmoji('ğŸ•µï¸')
        .setDisabled(!isTrader)
    );

  if (interaction.replied || interaction.deferred) {
    await interaction.editReply({ embeds: [embed], components: [shopCategoryRow] });
  } else {
    await interaction.reply({ embeds: [embed], components: [shopCategoryRow] });
  }
}

// Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú© (Bank Heist)
async function showBankHeistMenu(interaction) {
  const userId = interaction.user.id;
  const userLevel = await db.get(`level_${userId}`) || 1;
  const hasLockpickingSkill = await db.get(`skill_lockpicking_${userId}`) || false;
  const userJob = await db.get(`job_${userId}`) || 'none';
  const isMastermind = userJob === 'mastermind';
  const isThief = userJob === 'thief';
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø±Ø§ÛŒØ· Ø§ÙˆÙ„ÛŒÙ‡
  if (userLevel < 15) {
    const errorEmbed = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('âš ï¸ Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø­Ø¯ÙˆØ¯')
      .setDescription(`Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú© ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø³Ø·Ø­ 15 Ø¨Ù‡ Ø¨Ø§Ù„Ø§ ÙØ¹Ø§Ù„ Ø§Ø³Øª. Ø´Ù…Ø§ Ø³Ø·Ø­ ${userLevel} Ù‡Ø³ØªÛŒØ¯.`)
      .setFooter({ text: 'Ø¨Ø§ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ùˆ Ø´Ø±Ú©Øª Ø¯Ø± Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§ØŒ Ø³Ø·Ø­ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯!' });
      
    return await interaction.update({ embeds: [errorEmbed], components: [] });
  }
  
  // Ú†Ú© Ú©Ø±Ø¯Ù† Ú©ÙˆÙ„Ø¯Ø§ÙˆÙ†
  const lastBankHeist = await db.get(`lastBankHeist_${userId}`) || 0;
  const now = Date.now();
  const cooldown = 24 * 60 * 60 * 1000; // 24 Ø³Ø§Ø¹Øª
  
  if (now - lastBankHeist < cooldown) {
    const timeLeft = cooldown - (now - lastBankHeist);
    const hours = Math.floor(timeLeft / (1000 * 60 * 60));
    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
    
    const cooldownEmbed = new EmbedBuilder()
      .setColor('#ff9900')
      .setTitle('â³ Ú©ÙˆÙ„Ø¯Ø§ÙˆÙ† ÙØ¹Ø§Ù„')
      .setDescription(`Ø´Ù…Ø§ Ø¨Ø§ÛŒØ¯ ${hours} Ø³Ø§Ø¹Øª Ùˆ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡ Ø¯ÛŒÚ¯Ø± ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨ØªÙˆØ§Ù†ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú© Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯.`)
      .setFooter({ text: 'Ù¾Ù„ÛŒØ³ Ù‡Ù†ÙˆØ² Ø¯Ø± Ø¬Ø³ØªØ¬ÙˆÛŒ Ø´Ù…Ø§Ø³Øª!' });
      
    return await interaction.update({ embeds: [cooldownEmbed], components: [] });
  }
  
  // ØªØ¹Ø±ÛŒÙ Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©
  const heistTypes = [
    {
      id: 'solo',
      name: 'ğŸ•µï¸ Ø¯Ø²Ø¯ÛŒ Ø§Ù†ÙØ±Ø§Ø¯ÛŒ',
      description: 'Ø¨Ù‡ ØªÙ†Ù‡Ø§ÛŒÛŒ Ø§Ø² Ø´Ø¹Ø¨Ù‡ Ú©ÙˆÚ†Ú© Ø¨Ø§Ù†Ú© Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯',
      minPlayers: 1,
      maxPlayers: 1,
      minReward: 1000,
      maxReward: 5000,
      successChance: isMastermind ? 40 : (isThief ? 35 : 30), // Ø¯Ø±ØµØ¯ Ù…ÙˆÙÙ‚ÛŒØª
      requirement: 'Ø³Ø·Ø­ 15+',
      penalty: 'Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ú©Ø³Øª: 2000 Ø³Ú©Ù‡'
    },
    {
      id: 'small',
      name: 'ğŸ‘¥ Ø¯Ø²Ø¯ÛŒ Ú¯Ø±ÙˆÙ‡ Ú©ÙˆÚ†Ú©',
      description: 'Ø¨Ø§ 2-3 Ù†ÙØ± Ø§Ø² Ø´Ø¹Ø¨Ù‡ Ù…ØªÙˆØ³Ø· Ø¨Ø§Ù†Ú© Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯',
      minPlayers: 2,
      maxPlayers: 3,
      minReward: 5000,
      maxReward: 15000,
      successChance: isMastermind ? 55 : (isThief ? 50 : 45), // Ø¯Ø±ØµØ¯ Ù…ÙˆÙÙ‚ÛŒØª
      requirement: 'Ø³Ø·Ø­ 20+',
      penalty: 'Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ú©Ø³Øª: 5000 Ø³Ú©Ù‡'
    },
    {
      id: 'large',
      name: 'ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦ Ø¯Ø²Ø¯ÛŒ Ú¯Ø±ÙˆÙ‡ Ø¨Ø²Ø±Ú¯',
      description: 'Ø¨Ø§ 4-5 Ù†ÙØ± Ø§Ø² Ø´Ø¹Ø¨Ù‡ Ù…Ø±Ú©Ø²ÛŒ Ø¨Ø§Ù†Ú© Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯',
      minPlayers: 4,
      maxPlayers: 5,
      minReward: 20000,
      maxReward: 50000,
      successChance: isMastermind ? 70 : (isThief ? 65 : 60), // Ø¯Ø±ØµØ¯ Ù…ÙˆÙÙ‚ÛŒØª
      requirement: 'Ø³Ø·Ø­ 25+',
      penalty: 'Ø¬Ø±ÛŒÙ…Ù‡ Ø´Ú©Ø³Øª: 10000 Ø³Ú©Ù‡'
    }
  ];
  
  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨ÙˆÙ†ÙˆØ³ Ù…Ù‡Ø§Ø±Øª Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ
  if (hasLockpickingSkill) {
    heistTypes.forEach(heist => {
      heist.successChance += 10; // Ø§ÙØ²Ø§ÛŒØ´ 10 Ø¯Ø±ØµØ¯ÛŒ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª
    });
  }
  
  // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø²Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„
  const activeHeists = await db.get('active_heists') || [];
  const activeHeistsText = activeHeists.length > 0 
    ? activeHeists.map(h => `â€¢ ${h.type === 'small' ? 'ğŸ‘¥' : (h.type === 'large' ? 'ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦' : 'ğŸ•µï¸')} Ø¯Ø²Ø¯ÛŒ ${h.type === 'small' ? 'Ú¯Ø±ÙˆÙ‡ Ú©ÙˆÚ†Ú©' : (h.type === 'large' ? 'Ú¯Ø±ÙˆÙ‡ Ø¨Ø²Ø±Ú¯' : 'Ø§Ù†ÙØ±Ø§Ø¯ÛŒ')}: ${h.participants.length}/${h.type === 'small' ? 3 : (h.type === 'large' ? 5 : 1)} Ù†ÙØ± (Ø±Ù‡Ø¨Ø±: <@${h.leader}>)`).join('\n')
    : '**Ù‡ÛŒÚ† Ø¯Ø²Ø¯ÛŒ ÙØ¹Ø§Ù„ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.**';
  
  const bankHeistEmbed = new EmbedBuilder()
    .setColor('#ff0000')
    .setTitle('ğŸ¦ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©')
    .setDescription('ÛŒÚ©ÛŒ Ø§Ø² Ù…Ø®Ø§Ø·Ø±Ù‡â€ŒØ¢Ù…ÛŒØ²ØªØ±ÛŒÙ† Ùˆ Ù¾Ø±Ø³ÙˆØ¯ØªØ±ÛŒÙ† ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ù…Ú©Ù†! Ø¨Ø§ Ù‡Ù…Ø±Ø§Ù‡ÛŒ Ø¯ÙˆØ³ØªØ§Ù† Ø®ÙˆØ¯ØŒ Ø§Ø² Ø¨Ø§Ù†Ú© Ø¯Ø²Ø¯ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø«Ø±ÙˆØªÙ…Ù†Ø¯ Ø´ÙˆÛŒØ¯.')
    .addFields(
      { name: 'ğŸ“ Ø§Ù†ÙˆØ§Ø¹ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©', value: 
        heistTypes.map(h => 
          `**${h.name}**\n${h.description}\n` +
          `Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª: **${h.successChance}%**\n` +
          `Ø¬Ø§ÛŒØ²Ù‡: **${h.minReward}** ØªØ§ **${h.maxReward}** ğŸª™\n` +
          `${h.requirement} | ${h.penalty}`
        ).join('\n\n'), 
        inline: false 
      },
      { name: 'ğŸ” Ø´Ø±Ø§ÛŒØ· Ø´Ø±Ú©Øª', value: 
        `â€¢ Ø­Ø¯Ø§Ù‚Ù„ Ø³Ø·Ø­ 15 Ø¨Ø±Ø§ÛŒ Ø´Ø±Ú©Øª Ø¯Ø± Ø¯Ø²Ø¯ÛŒ\n` +
        `â€¢ Ù‡Ø± Ú©Ø§Ø±Ø¨Ø± ÙÙ‚Ø· Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ù‡Ø± 24 Ø³Ø§Ø¹Øª ÛŒÚ©Ø¨Ø§Ø± Ø´Ø±Ú©Øª Ú©Ù†Ø¯\n` +
        `â€¢ Ø¯Ø± ØµÙˆØ±Øª Ø´Ú©Ø³ØªØŒ ØªÙ…Ø§Ù… Ø´Ø±Ú©Øªâ€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù† Ø¬Ø±ÛŒÙ…Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯\n` +
        `â€¢ Ù…Ù‡Ø§Ø±Øª Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ (+10% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª)` +
        (hasLockpickingSkill ? ' âœ…' : ' âŒ'), 
        inline: false 
      },
      { name: 'ğŸƒâ€â™‚ï¸ Ø¯Ø²Ø¯ÛŒâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„', value: activeHeistsText, inline: false }
    )
    .setFooter({ text: isMastermind ? 'Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø°Ù‡Ù† Ù…Ø¯Ø¨Ø±ØŒ Ø´Ù…Ø§ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¨ÛŒØ´ØªØ±ÛŒ Ø¯Ø§Ø±ÛŒØ¯!' : (isThief ? 'Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø¯Ø²Ø¯ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒØŒ Ø´Ù…Ø§ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¨ÛŒØ´ØªØ±ÛŒ Ø¯Ø§Ø±ÛŒØ¯!' : 'Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù…Ù‡Ø§Ø±Øª Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒØŒ Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø®ÙˆØ¯ Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯!') });
  
  // Ø³Ø§Ø®Øª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
  const heistRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('start_solo_heist')
        .setLabel('Ø¯Ø²Ø¯ÛŒ Ø§Ù†ÙØ±Ø§Ø¯ÛŒ')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ•µï¸'),
      new ButtonBuilder()
        .setCustomId('start_small_heist')
        .setLabel('Ø¯Ø²Ø¯ÛŒ Ú¯Ø±ÙˆÙ‡ Ú©ÙˆÚ†Ú©')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ‘¥'),
      new ButtonBuilder()
        .setCustomId('start_large_heist')
        .setLabel('Ø¯Ø²Ø¯ÛŒ Ú¯Ø±ÙˆÙ‡ Ø¨Ø²Ø±Ú¯')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦â€ğŸ‘¦')
    );
    
  const actionRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('join_heist')
        .setLabel('Ù¾ÛŒÙˆØ³ØªÙ† Ø¨Ù‡ Ø¯Ø²Ø¯ÛŒ')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ¤')
        .setDisabled(activeHeists.length === 0),
      new ButtonBuilder()
        .setCustomId('view_heist_history')
        .setLabel('ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¯Ø²Ø¯ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ“œ')
    );
  
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('games_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('ğŸ”™')
    );
  
  await interaction.update({ embeds: [bankHeistEmbed], components: [heistRow, actionRow, backRow] });
}

async function buyItem(interaction, itemId) {
  if (!itemId) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ…ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¨Ø®Ø±ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });

  const userId = interaction.user.id;
  const userJob = await db.get(`job_${userId}`) || 'none';
  const isTrader = userJob === 'trader';
  const hasVIP = await db.get(`vip_${userId}`) || false;
  const vipExpiry = await db.get(`vipExpiry_${userId}`) || 0;
  const hasActiveVIP = hasVIP && vipExpiry > Date.now();
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¹Ø§Ø¯ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
  const shop = [
    { id: 1, name: 'ğŸ›¡ï¸ Ù…Ø­Ø§ÙØ¸ Ø´Ø®ØµÛŒ', price: 1000, description: 'Ø§Ø² Ø¯Ø²Ø¯ÛŒ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Û²Û´ Ø³Ø§Ø¹Øª)' },
    { id: 2, name: 'ğŸ”® ØªÙˆÚ©Ù† VIP', price: 5000, description: 'Ø¨Ù‡ Ù…Ø¯Øª Û· Ø±ÙˆØ² ÙˆØ¶Ø¹ÛŒØª VIP Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯' },
    { id: 3, name: 'ğŸ Ø¬Ø¹Ø¨Ù‡ Ø´Ø§Ù†Ø³', price: 500, description: 'Ù…Ø­ØªÙˆØ§ÛŒ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø§ Ø§Ø±Ø²Ø´ Ø¨Ø§Ù„Ù‚ÙˆÙ‡ Ø¨Ø§Ù„Ø§' },
    { id: 4, name: 'ğŸ’¹ Ø¨ÛŒÙ…Ù‡ Ø¶Ø¯ Ø³Ø±Ù‚Øª', price: 5000, description: '50% Ú©Ø§Ù‡Ø´ Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø±ÙˆÛŒ Ø´Ù…Ø§ (Û· Ø±ÙˆØ²)' },
    { id: 5, name: 'ğŸ† Ù†Ø´Ø§Ù† Ø§ÙØªØ®Ø§Ø±', price: 10000, description: 'ÛŒÚ© Ù†Ø´Ø§Ù† ÙˆÛŒÚ˜Ù‡ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ù¾Ø±ÙˆÙØ§ÛŒÙ„' },
    { id: 6, name: 'ğŸ”ª Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ', price: 1500, description: 'Ø§ÙØ²Ø§ÛŒØ´ 10% Ø´Ø§Ù†Ø³ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ' },
    { id: 7, name: 'ğŸ•¶ï¸ Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§', price: 3000, description: 'Ú©Ø§Ù‡Ø´ 20% Ø¬Ø±ÛŒÙ…Ù‡ Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù†Ø§Ù…ÙˆÙÙ‚' },
    { id: 8, name: 'ğŸ§¤ Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ', price: 2500, description: 'Ú©Ø§Ù‡Ø´ 25% Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø³ØªÚ¯ÛŒØ±ÛŒ Ø¯Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù¾Ù†Ù‡Ø§Ù†ÛŒ' },
    { id: 9, name: 'ğŸ§  Ú©ØªØ§Ø¨ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ', price: 7500, description: 'Ø¢Ù…ÙˆØ²Ø´ Ù…Ù‡Ø§Ø±Øª Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ø¨Ø§Ù†Ú©' },
    { id: 10, name: 'ğŸ  Ø³Ù†Ø¯ Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Ú©ÙˆÚ†Ú©', price: 20000, description: 'Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡: 100 Ø³Ú©Ù‡ | Ù…Ø­Ø§ÙØ¸Øª Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ø¯Ø²Ø¯ÛŒ' }
  ];
  
  // Ù„ÙˆØª Ø¨Ø§Ú©Ø³â€ŒÙ‡Ø§
  const lootboxes = [
    { id: 101, name: 'ğŸ¥‰ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø¨Ø±Ù†Ø²ÛŒ', price: 500, description: 'Ø´Ø§Ù†Ø³ Ø¯Ø±ÛŒØ§ÙØª 200 ØªØ§ 1000 Ø³Ú©Ù‡ ÛŒØ§ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡' },
    { id: 102, name: 'ğŸ¥ˆ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ', price: 2000, description: 'Ø´Ø§Ù†Ø³ Ø¯Ø±ÛŒØ§ÙØª 1000 ØªØ§ 5000 Ø³Ú©Ù‡ ÛŒØ§ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ØªÙˆØ³Ø·' },
    { id: 103, name: 'ğŸ¥‡ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø·Ù„Ø§ÛŒÛŒ', price: 5000, description: 'Ø´Ø§Ù†Ø³ Ø¯Ø±ÛŒØ§ÙØª 5000 ØªØ§ 20000 Ø³Ú©Ù‡ ÛŒØ§ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ø¯Ø±' }
  ];
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ VIP
  const vipItems = [
    { id: 201, name: 'ğŸ” Ø¹ÛŒÙ†Ú© Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ', price: 15000, description: 'Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‚Ø±Ø¨Ø§Ù†ÛŒ Ù‚Ø¨Ù„ Ø§Ø² Ø¯Ø²Ø¯ÛŒ' },
    { id: 202, name: 'ğŸª„ Ø¹ØµØ§ÛŒ Ø¬Ø§Ø¯ÙˆÛŒÛŒ', price: 25000, description: '20% Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø§Ù†Ø±Ú˜ÛŒ Ùˆ Ú©ÙˆÙ„Ø¯Ø§ÙˆÙ†â€ŒÙ‡Ø§' },
    { id: 203, name: 'ğŸšï¸ Ø³Ù†Ø¯ ÙˆÛŒÙ„Ø§ÛŒ Ù„ÙˆÚ©Ø³', price: 50000, description: 'Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡: 500 Ø³Ú©Ù‡ | Ø§Ù…Ù†ÛŒØª Ú©Ø§Ù…Ù„' }
  ];
  
  // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªØ§Ø¬Ø±
  const traderItems = [
    { id: 301, name: 'ğŸ“ˆ Ø¬Ø¯ÙˆÙ„ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±', price: 3000, description: 'Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³ÛŒØ§Ù‡ Ùˆ Ø¨Ù‡ØªØ±ÛŒÙ† Ù…Ø¹Ø§Ù…Ù„Ø§Øª' },
    { id: 302, name: 'ğŸ§ª Ø§Ú©Ø³ÛŒØ± ØªØ§Ø¬Ø±', price: 8000, description: '30% Ø§ÙØ²Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´ Ø¨Ø±Ø§ÛŒ 24 Ø³Ø§Ø¹Øª' }
  ];
  
  // ØªØ±Ú©ÛŒØ¨ ØªÙ…Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡â€ŒÙ‡Ø§
  const allItems = [
    ...shop,
    ...lootboxes,
    ...(hasActiveVIP ? vipItems : []),
    ...(isTrader ? traderItems : [])
  ];
  
  // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…
  const item = allItems.find(i => i.id === itemId);
  if (!item) return interaction.reply({ content: 'âŒ Ø¢ÛŒØªÙ… Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø¯Ø± ÙØ±ÙˆØ´Ú¯Ø§Ù‡ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!', ephemeral: true });
  
  // Ø§Ø¹Ù…Ø§Ù„ ØªØ®ÙÛŒÙ Ø¨Ø±Ø§ÛŒ ØªØ§Ø¬Ø±Ù‡Ø§ Ùˆ VIP
  let finalPrice = item.price;
  if (isTrader) {
    finalPrice = Math.floor(finalPrice * 0.9); // 10% ØªØ®ÙÛŒÙ
  }
  if (hasActiveVIP) {
    finalPrice = Math.floor(finalPrice * 0.95); // 5% ØªØ®ÙÛŒÙ Ø§Ø¶Ø§ÙÛŒ
  }
  
  // Ø¨Ø±Ø±Ø³ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„
  const wallet = await db.get(`wallet_${userId}`) || 0;
  if (wallet < finalPrice) return interaction.reply({ content: `âŒ Ø´Ù…Ø§ Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø§ÛŒÙ† Ø¢ÛŒØªÙ… Ù†Ø¯Ø§Ø±ÛŒØ¯! (Ù‚ÛŒÙ…Øª: ${finalPrice} ğŸª™)`, ephemeral: true });
  
  // Ú©Ø³Ø± Ø³Ú©Ù‡ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
  await db.sub(`wallet_${userId}`, finalPrice);
  
  // Ø§Ø¹Ù…Ø§Ù„ Ø§Ø«Ø±Ø§Øª Ø¢ÛŒØªÙ… Ø¨Ø± Ø§Ø³Ø§Ø³ ID
  if (item.id === 1) { // Ù…Ø­Ø§ÙØ¸ Ø´Ø®ØµÛŒ
    await db.set(`protection_${userId}`, true);
    await db.set(`protectionExpiry_${userId}`, Date.now() + 24 * 60 * 60 * 1000);
  } 
  else if (item.id === 2) { // ØªÙˆÚ©Ù† VIP
    await db.set(`vip_${userId}`, true);
    await db.set(`vipExpiry_${userId}`, Date.now() + 7 * 24 * 60 * 60 * 1000);
  } 
  else if (item.id === 3) { // Ø¬Ø¹Ø¨Ù‡ Ø´Ø§Ù†Ø³ Ù‚Ø¯ÛŒÙ…ÛŒ
    const rewards = [
      { amount: 100, chance: 0.4 },
      { amount: 300, chance: 0.3 },
      { amount: 800, chance: 0.2 },
      { amount: 2000, chance: 0.08 },
      { amount: 5000, chance: 0.02 }
    ];

    let random = Math.random();
    let reward;
    let sum = 0;

    for (const r of rewards) {
      sum += r.chance;
      if (random <= sum) {
        reward = r.amount;
        break;
      }
    }

    await db.add(`wallet_${userId}`, reward);

    const embed = new EmbedBuilder()
      .setColor('#ffd700')
      .setTitle('ğŸ Ø¬Ø¹Ø¨Ù‡ Ø´Ø§Ù†Ø³')
      .setDescription(`Ø´Ù…Ø§ Ø¬Ø¹Ø¨Ù‡ Ø±Ø§ Ø¨Ø§Ø² Ú©Ø±Ø¯ÛŒØ¯ Ùˆ **${reward}** ğŸª™ Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯ÛŒØ¯!`)
      .setTimestamp();

    return interaction.reply({ embeds: [embed] });
  } 
  else if (item.id === 4) { // Ø¨ÛŒÙ…Ù‡ Ø¶Ø¯ Ø³Ø±Ù‚Øª
    await db.set(`insurance_${userId}`, true);
    await db.set(`insuranceExpiry_${userId}`, Date.now() + 7 * 24 * 60 * 60 * 1000);
  } 
  else if (item.id === 5) { // Ù†Ø´Ø§Ù† Ø§ÙØªØ®Ø§Ø±
    const badges = await db.get(`badges_${userId}`) || [];
    badges.push('ğŸ†');
    await db.set(`badges_${userId}`, badges);
  } 
  else if (item.id === 6) { // Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ
    await db.set(`thief_dagger_${userId}`, true);
    const inventory = await db.get(`inventory_${userId}`) || [];
    inventory.push({
      name: 'Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ',
      icon: 'ğŸ”ª',
      durability: 10,
      price: item.price
    });
    await db.set(`inventory_${userId}`, inventory);
  } 
  else if (item.id === 7) { // Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§
    await db.set(`ninja_mask_${userId}`, true);
    const inventory = await db.get(`inventory_${userId}`) || [];
    inventory.push({
      name: 'Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§',
      icon: 'ğŸ•¶ï¸',
      durability: 5,
      price: item.price
    });
    await db.set(`inventory_${userId}`, inventory);
  }
  else if (item.id === 8) { // Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ
    await db.set(`invisible_gloves_${userId}`, true);
    const inventory = await db.get(`inventory_${userId}`) || [];
    inventory.push({
      name: 'Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ',
      icon: 'ğŸ§¤',
      durability: 3,
      price: item.price
    });
    await db.set(`inventory_${userId}`, inventory);
  }
  else if (item.id === 9) { // Ú©ØªØ§Ø¨ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ
    await db.set(`skill_lockpicking_${userId}`, true);
    const skills = await db.get(`skills_${userId}`) || [];
    skills.push({
      name: 'Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ',
      icon: 'ğŸ”“',
      level: 1,
      xp: 0
    });
    await db.set(`skills_${userId}`, skills);
  }
  else if (item.id === 10) { // Ø³Ù†Ø¯ Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Ú©ÙˆÚ†Ú©
    const properties = await db.get(`properties_${userId}`) || [];
    properties.push({
      name: 'Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Ú©ÙˆÚ†Ú©',
      icon: 'ğŸ ',
      dailyIncome: 100,
      securityBonus: 20, // Ø¯Ø±ØµØ¯ Ú©Ø§Ù‡Ø´ Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø²Ø¯ÛŒ
      price: item.price,
      purchaseDate: Date.now()
    });
    await db.set(`properties_${userId}`, properties);
  }
  else if (item.id === 101 || item.id === 102 || item.id === 103) { // Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³â€ŒÙ‡Ø§
    return await openLootbox(interaction, item.id);
  }
  else if (item.id === 201) { // Ø¹ÛŒÙ†Ú© Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ
    await db.set(`spy_glasses_${userId}`, true);
    const inventory = await db.get(`inventory_${userId}`) || [];
    inventory.push({
      name: 'Ø¹ÛŒÙ†Ú© Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ',
      icon: 'ğŸ”',
      durability: 5,
      price: item.price
    });
    await db.set(`inventory_${userId}`, inventory);
  }
  else if (item.id === 202) { // Ø¹ØµØ§ÛŒ Ø¬Ø§Ø¯ÙˆÛŒÛŒ
    await db.set(`magic_wand_${userId}`, true);
    const inventory = await db.get(`inventory_${userId}`) || [];
    inventory.push({
      name: 'Ø¹ØµØ§ÛŒ Ø¬Ø§Ø¯ÙˆÛŒÛŒ',
      icon: 'ğŸª„',
      durability: 30, // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ø±Ø§ÛŒ ÛŒÚ© Ù…Ø§Ù‡
      price: item.price
    });
    await db.set(`inventory_${userId}`, inventory);
  }
  else if (item.id === 203) { // Ø³Ù†Ø¯ ÙˆÛŒÙ„Ø§ÛŒ Ù„ÙˆÚ©Ø³
    const properties = await db.get(`properties_${userId}`) || [];
    properties.push({
      name: 'ÙˆÛŒÙ„Ø§ÛŒ Ù„ÙˆÚ©Ø³',
      icon: 'ğŸšï¸',
      dailyIncome: 500,
      securityBonus: 70, // Ø¯Ø±ØµØ¯ Ú©Ø§Ù‡Ø´ Ø§Ø­ØªÙ…Ø§Ù„ Ø¯Ø²Ø¯ÛŒ
      price: item.price,
      purchaseDate: Date.now()
    });
    await db.set(`properties_${userId}`, properties);
  }
  else if (item.id === 301) { // Ø¬Ø¯ÙˆÙ„ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±
    await db.set(`market_analysis_${userId}`, true);
    await db.set(`market_analysis_expiry_${userId}`, Date.now() + 30 * 24 * 60 * 60 * 1000); // 30 Ø±ÙˆØ²
  }
  else if (item.id === 302) { // Ø§Ú©Ø³ÛŒØ± ØªØ§Ø¬Ø±
    await db.set(`trader_elixir_${userId}`, true);
    await db.set(`trader_elixir_expiry_${userId}`, Date.now() + 24 * 60 * 60 * 1000); // 24 Ø³Ø§Ø¹Øª
  }

  const embed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('âœ… Ø®Ø±ÛŒØ¯ Ù…ÙˆÙÙ‚')
    .setDescription(`Ø´Ù…Ø§ **${item.name}** Ø±Ø§ Ø¨Ø§ Ù‚ÛŒÙ…Øª **${finalPrice}** ğŸª™ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ø±Ø¯ÛŒØ¯!`)
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

// Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù„ÙˆØª Ø¨Ø§Ú©Ø³
async function openLootbox(interaction, lootboxId) {
  const userId = interaction.user.id;
  
  // ØªØ¹Ø±ÛŒÙ Ø¬ÙˆØ§ÛŒØ² Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹ Ù„ÙˆØª Ø¨Ø§Ú©Ø³
  let rewards = [];
  let lootboxName = '';
  
  if (lootboxId === 101) { // Ù„ÙˆØª Ø¨Ø§Ú©Ø³ Ø¨Ø±Ù†Ø²ÛŒ
    lootboxName = 'ğŸ¥‰ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø¨Ø±Ù†Ø²ÛŒ';
    rewards = [
      { type: 'coin', min: 200, max: 1000, chance: 0.6 },
      { type: 'item', item: { name: 'ğŸ›¡ï¸ Ù…Ø­Ø§ÙØ¸ Ø´Ø®ØµÛŒ', id: 1 }, chance: 0.2 },
      { type: 'item', item: { name: 'ğŸ”ª Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ', id: 6 }, chance: 0.15 },
      { type: 'nothing', chance: 0.05 } // Ø´Ø§Ù†Ø³ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù†
    ];
  } 
  else if (lootboxId === 102) { // Ù„ÙˆØª Ø¨Ø§Ú©Ø³ Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ
    lootboxName = 'ğŸ¥ˆ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ù†Ù‚Ø±Ù‡â€ŒØ§ÛŒ';
    rewards = [
      { type: 'coin', min: 1000, max: 5000, chance: 0.5 },
      { type: 'item', item: { name: 'ğŸ•¶ï¸ Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§', id: 7 }, chance: 0.2 },
      { type: 'item', item: { name: 'ğŸ’¹ Ø¨ÛŒÙ…Ù‡ Ø¶Ø¯ Ø³Ø±Ù‚Øª', id: 4 }, chance: 0.15 },
      { type: 'item', item: { name: 'ğŸ§¤ Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ', id: 8 }, chance: 0.1 },
      { type: 'nothing', chance: 0.05 } // Ø´Ø§Ù†Ø³ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù†
    ];
  } 
  else if (lootboxId === 103) { // Ù„ÙˆØª Ø¨Ø§Ú©Ø³ Ø·Ù„Ø§ÛŒÛŒ
    lootboxName = 'ğŸ¥‡ Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø·Ù„Ø§ÛŒÛŒ';
    rewards = [
      { type: 'coin', min: 5000, max: 20000, chance: 0.4 },
      { type: 'item', item: { name: 'ğŸ”® ØªÙˆÚ©Ù† VIP', id: 2 }, chance: 0.2 },
      { type: 'item', item: { name: 'ğŸ§  Ú©ØªØ§Ø¨ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ', id: 9 }, chance: 0.15 },
      { type: 'item', item: { name: 'ğŸ† Ù†Ø´Ø§Ù† Ø§ÙØªØ®Ø§Ø±', id: 5 }, chance: 0.15 },
      { type: 'jackpot', chance: 0.05 }, // Ø´Ø§Ù†Ø³ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø¬Ú©Ù¾Ø§Øª
      { type: 'nothing', chance: 0.05 } // Ø´Ø§Ù†Ø³ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù†
    ];
  }
  
  // Ø§Ù†ØªØ®Ø§Ø¨ Ø¬Ø§ÛŒØ²Ù‡ Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ø´Ø§Ù†Ø³
  let random = Math.random();
  let selectedReward = null;
  let sum = 0;
  
  for (const reward of rewards) {
    sum += reward.chance;
    if (random <= sum) {
      selectedReward = reward;
      break;
    }
  }
  
  // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù„ÙˆØª Ø¨Ø§Ú©Ø³
  const loadingEmbed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle(`ğŸ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† ${lootboxName}...`)
    .setDescription('Ù„Ø·ÙØ§Ù‹ ØµØ¨Ø± Ú©Ù†ÛŒØ¯...')
    .setTimestamp();
  
  await interaction.reply({ embeds: [loadingEmbed] });
  
  // ØªØ§Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù‡ÛŒØ¬Ø§Ù†
  await new Promise(resolve => setTimeout(resolve, 3000));
  
  // Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø¬Ø§ÛŒØ²Ù‡
  let resultEmbed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle(`ğŸ ${lootboxName} Ø¨Ø§Ø² Ø´Ø¯!`)
    .setTimestamp();
  
  if (selectedReward.type === 'coin') {
    // Ø¬Ø§ÛŒØ²Ù‡ Ø³Ú©Ù‡
    const amount = Math.floor(Math.random() * (selectedReward.max - selectedReward.min + 1)) + selectedReward.min;
    await db.add(`wallet_${userId}`, amount);
    
    resultEmbed.setDescription(`ğŸ‰ **ØªØ¨Ø±ÛŒÚ©!** Ø´Ù…Ø§ **${amount}** ğŸª™ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯!`);
  } 
  else if (selectedReward.type === 'item') {
    // Ø¬Ø§ÛŒØ²Ù‡ Ø¢ÛŒØªÙ…
    const item = selectedReward.item;
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ… Ø¨Ù‡ Ø§Ù†Ø¨Ø§Ø± Ú©Ø§Ø±Ø¨Ø±
    if (item.id === 1) { // Ù…Ø­Ø§ÙØ¸ Ø´Ø®ØµÛŒ
      await db.set(`protection_${userId}`, true);
      await db.set(`protectionExpiry_${userId}`, Date.now() + 24 * 60 * 60 * 1000);
    } 
    else if (item.id === 2) { // ØªÙˆÚ©Ù† VIP
      await db.set(`vip_${userId}`, true);
      await db.set(`vipExpiry_${userId}`, Date.now() + 7 * 24 * 60 * 60 * 1000);
    } 
    else if (item.id === 4) { // Ø¨ÛŒÙ…Ù‡ Ø¶Ø¯ Ø³Ø±Ù‚Øª
      await db.set(`insurance_${userId}`, true);
      await db.set(`insuranceExpiry_${userId}`, Date.now() + 7 * 24 * 60 * 60 * 1000);
    } 
    else if (item.id === 5) { // Ù†Ø´Ø§Ù† Ø§ÙØªØ®Ø§Ø±
      const badges = await db.get(`badges_${userId}`) || [];
      badges.push('ğŸ†');
      await db.set(`badges_${userId}`, badges);
    } 
    else if (item.id === 6 || item.id === 7 || item.id === 8 || item.id === 9) {
      // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ
      const inventory = await db.get(`inventory_${userId}`) || [];
      
      if (item.id === 6) { // Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ
        await db.set(`thief_dagger_${userId}`, true);
        inventory.push({
          name: 'Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ',
          icon: 'ğŸ”ª',
          durability: 10,
          price: 1500
        });
      } 
      else if (item.id === 7) { // Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§
        await db.set(`ninja_mask_${userId}`, true);
        inventory.push({
          name: 'Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§',
          icon: 'ğŸ•¶ï¸',
          durability: 5,
          price: 3000
        });
      } 
      else if (item.id === 8) { // Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ
        await db.set(`invisible_gloves_${userId}`, true);
        inventory.push({
          name: 'Ø¯Ø³ØªÚ©Ø´ Ù†Ø§Ù…Ø±Ø¦ÛŒ',
          icon: 'ğŸ§¤',
          durability: 3,
          price: 2500
        });
      } 
      else if (item.id === 9) { // Ú©ØªØ§Ø¨ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ
        await db.set(`skill_lockpicking_${userId}`, true);
        const skills = await db.get(`skills_${userId}`) || [];
        skills.push({
          name: 'Ù‚ÙÙ„â€ŒØ´Ú©Ù†ÛŒ',
          icon: 'ğŸ”“',
          level: 1,
          xp: 0
        });
        await db.set(`skills_${userId}`, skills);
      }
      
      await db.set(`inventory_${userId}`, inventory);
    }
    
    resultEmbed.setDescription(`ğŸ‰ **ØªØ¨Ø±ÛŒÚ©!** Ø´Ù…Ø§ Ø¢ÛŒØªÙ… **${item.name}** Ø±Ø§ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯!`);
  } 
  else if (selectedReward.type === 'jackpot') {
    // Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø¬Ú©Ù¾Ø§Øª
    const jackpotAmount = await db.get('jackpot_amount') || 10000;
    await db.add(`wallet_${userId}`, jackpotAmount);
    await db.set('jackpot_amount', 1000); // Ø±ÛŒØ³Øª Ø¬Ú©Ù¾Ø§Øª Ø¨Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ø§ÙˆÙ„ÛŒÙ‡
    
    resultEmbed
      .setColor('#ff0000')
      .setTitle('ğŸ’° **Ø¬Ú©Ù¾Ø§Øª!** ğŸ’°')
      .setDescription(`ğŸŠ **ØªØ¨Ø±ÛŒÚ© ÙˆÛŒÚ˜Ù‡!** Ø´Ù…Ø§ Ø¬Ú©Ù¾Ø§Øª Ø¨Ù‡ Ù…Ù‚Ø¯Ø§Ø± **${jackpotAmount}** ğŸª™ Ø±Ø§ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒØ¯!`)
      .addFields({ name: 'ğŸ¤¯ ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡!', value: 'Ø´Ù…Ø§ Ø®ÙˆØ´â€ŒØ´Ø§Ù†Ø³â€ŒØªØ±ÛŒÙ† Ú©Ø§Ø±Ø¨Ø± Ø§Ù…Ø±ÙˆØ² Ù‡Ø³ØªÛŒØ¯!' });
    
    // Ø§Ø¹Ù„Ø§Ù† Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø¬Ú©Ù¾Ø§Øª
    const globalAnnouncement = new EmbedBuilder()
      .setColor('#ff0000')
      .setTitle('ğŸ”¥ ÛŒÚ© Ù†ÙØ± Ø¬Ú©Ù¾Ø§Øª Ø±Ø§ Ø¨Ø±Ø¯! ğŸ”¥')
      .setDescription(`ğŸŠ ØªØ¨Ø±ÛŒÚ© Ø¨Ù‡ <@${userId}> Ú©Ù‡ Ø¬Ú©Ù¾Ø§Øª Ø¨Ù‡ Ù…Ù‚Ø¯Ø§Ø± **${jackpotAmount}** ğŸª™ Ø±Ø§ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯!`)
      .setTimestamp();
    
    // Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ú©Ø¯ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ù†Ø§Ù„ Ø¹Ù…ÙˆÙ…ÛŒ Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯
  } 
  else if (selectedReward.type === 'nothing') {
    // Ù„ÙˆØª Ø¨Ø§Ú©Ø³ Ø®Ø§Ù„ÛŒ
    resultEmbed
      .setColor('#808080')
      .setDescription('ğŸ˜¢ **Ù…ØªØ£Ø³ÙØ§Ù†Ù‡** Ø§ÛŒÙ† Ù„ÙˆØªâ€ŒØ¨Ø§Ú©Ø³ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯! Ø´Ø§Ù†Ø³ Ø®ÙˆØ¯ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.');
  }
  
  await interaction.editReply({ embeds: [resultEmbed] });
}

// Ø³ÛŒØ³ØªÙ… Ø§Ù…Ù„Ø§Ú©
async function showRealEstateMenu(interaction) {
  const userId = interaction.user.id;
  const properties = await db.get(`properties_${userId}`) || [];
  const wallet = await db.get(`wallet_${userId}`) || 0;
  
  // Ù„ÛŒØ³Øª Ø§Ù…Ù„Ø§Ú© Ù‚Ø§Ø¨Ù„ Ø®Ø±ÛŒØ¯
  const availableProperties = [
    { 
      id: 1, 
      name: 'ğŸ  Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Ú©ÙˆÚ†Ú©', 
      price: 20000, 
      dailyIncome: 100, 
      securityBonus: 20,
      description: 'ÛŒÚ© Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† Ú©ÙˆÚ†Ú© Ùˆ Ø³Ø§Ø¯Ù‡'
    },
    { 
      id: 2, 
      name: 'ğŸ¡ Ø®Ø§Ù†Ù‡ ÙˆÛŒÙ„Ø§ÛŒÛŒ', 
      price: 50000, 
      dailyIncome: 250, 
      securityBonus: 40,
      description: 'ÛŒÚ© Ø®Ø§Ù†Ù‡ ÙˆÛŒÙ„Ø§ÛŒÛŒ Ø¯Ù†Ø¬ Ø¨Ø§ Ø­ÛŒØ§Ø· Ú©ÙˆÚ†Ú©'
    },
    { 
      id: 3, 
      name: 'ğŸ˜ï¸ Ù…Ø¬ØªÙ…Ø¹ Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù†ÛŒ', 
      price: 100000, 
      dailyIncome: 600, 
      securityBonus: 30,
      description: 'Ù…Ø¬Ù…ÙˆØ¹Ù‡â€ŒØ§ÛŒ Ø§Ø² Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù†â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø§Ø±Ù‡'
    },
    { 
      id: 4, 
      name: 'ğŸšï¸ ÙˆÛŒÙ„Ø§ÛŒ Ù„ÙˆÚ©Ø³', 
      price: 250000, 
      dailyIncome: 1500, 
      securityBonus: 70,
      description: 'ÙˆÛŒÙ„Ø§ÛŒ Ù„ÙˆÚ©Ø³ Ø¨Ø§ Ù…Ø­ÙˆØ·Ù‡ Ø§Ø®ØªØµØ§ØµÛŒ Ùˆ Ø§Ø³ØªØ®Ø±'
    },
    { 
      id: 5, 
      name: 'ğŸ¢ Ø³Ø§Ø®ØªÙ…Ø§Ù† ØªØ¬Ø§Ø±ÛŒ', 
      price: 500000, 
      dailyIncome: 3000, 
      securityBonus: 50,
      description: 'Ø³Ø§Ø®ØªÙ…Ø§Ù† ØªØ¬Ø§Ø±ÛŒ Ø¨Ø§ Ù…ØºØ§Ø²Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªØ¹Ø¯Ø¯'
    }
  ];
  
  // Ù„ÛŒØ³Øª Ø§Ù…Ù„Ø§Ú© Ú©Ø§Ø±Ø¨Ø±
  let userPropertiesList = '';
  let totalDailyIncome = 0;
  let totalSecurityBonus = 0;
  
  if (properties.length > 0) {
    userPropertiesList = '**Ø§Ù…Ù„Ø§Ú© Ø´Ù…Ø§:**\n\n';
    properties.forEach((prop, index) => {
      const purchaseDate = new Date(prop.purchaseDate);
      const daysOwned = Math.floor((Date.now() - prop.purchaseDate) / (1000 * 60 * 60 * 24));
      userPropertiesList += `${index + 1}. ${prop.icon} **${prop.name}**\n` +
        `Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡: **${prop.dailyIncome}** ğŸª™\n` +
        `Ø§Ù…Ù†ÛŒØª: **${prop.securityBonus}%**\n` +
        `Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡ Ø¯Ø±: ${purchaseDate.toLocaleDateString('fa-IR')}\n` +
        `Ù…Ø§Ù„Ú©ÛŒØª: **${daysOwned}** Ø±ÙˆØ²\n\n`;
        
      totalDailyIncome += prop.dailyIncome;
      totalSecurityBonus += prop.securityBonus;
    });
    
    // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ø¨ÙˆÙ†ÙˆØ³ Ø§Ù…Ù†ÛŒØªÛŒ Ø¨Ù‡ Ø­Ø¯Ø§Ú©Ø«Ø± 90%
    totalSecurityBonus = Math.min(totalSecurityBonus, 90);
  } else {
    userPropertiesList = '**Ø´Ù…Ø§ Ù‡Ù†ÙˆØ² Ù‡ÛŒÚ† Ù…Ù„Ú©ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯!**\n\n';
  }
  
  // Ø³Ø§Ø®Øª embed
  const realEstateEmbed = new EmbedBuilder()
    .setColor('#2ecc71')
    .setTitle('ğŸ˜ï¸ Ø³ÛŒØ³ØªÙ… Ø§Ù…Ù„Ø§Ú©')
    .setDescription('Ø§Ù…Ù„Ø§Ú© Ø¨Ø®Ø±ÛŒØ¯ØŒ Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡ Ú©Ø³Ø¨ Ú©Ù†ÛŒØ¯ Ùˆ Ø§Ø² Ø§Ù…Ù†ÛŒØª Ø¨ÛŒØ´ØªØ± Ø¨Ù‡Ø±Ù‡â€ŒÙ…Ù†Ø¯ Ø´ÙˆÛŒØ¯!')
    .addFields(
      { name: 'ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„', value: `**${wallet}** ğŸª™`, inline: true },
      { name: 'ğŸ“Š Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø§Ø² Ø§Ù…Ù„Ø§Ú©', value: `**${totalDailyIncome}** ğŸª™`, inline: true },
      { name: 'ğŸ›¡ï¸ Ø¨ÙˆÙ†ÙˆØ³ Ø§Ù…Ù†ÛŒØªÛŒ', value: `**${totalSecurityBonus}%**`, inline: true },
      { name: '\u200B', value: userPropertiesList, inline: false },
      { name: 'ğŸ¢ Ø§Ù…Ù„Ø§Ú© Ù‚Ø§Ø¨Ù„ Ø®Ø±ÛŒØ¯', value: 
        availableProperties.map(p => 
          `**${p.id}.** ${p.name} - **${p.price}** ğŸª™\n` +
          `Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡: **${p.dailyIncome}** ğŸª™ | Ø§Ù…Ù†ÛŒØª: **${p.securityBonus}%**\n` +
          `${p.description}`
        ).join('\n\n'), 
        inline: false 
      }
    )
    .setFooter({ text: 'Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ù…Ù„Ú©ØŒ Ø§Ø² Ø¯Ø³ØªÙˆØ± /buy-property [Ø´Ù…Ø§Ø±Ù‡ Ù…Ù„Ú©] Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ | Ø¯Ø±Ø¢Ù…Ø¯ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø´Ù…Ø§ ÙˆØ§Ø±ÛŒØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯.' });
  
  // Ø³Ø§Ø®Øª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
  const propertyRow1 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('collect_property_income')
        .setLabel('Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø±Ø¢Ù…Ø¯')
        .setStyle(ButtonStyle.Success)
        .setEmoji('ğŸ’°')
        .setDisabled(totalDailyIncome === 0),
      new ButtonBuilder()
        .setCustomId('view_property_details')
        .setLabel('Ø¬Ø²Ø¦ÛŒØ§Øª Ø§Ù…Ù„Ø§Ú©')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ”')
        .setDisabled(properties.length === 0)
    );
  
  const propertyRow2 = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('buy_property_menu')
        .setLabel('Ø®Ø±ÛŒØ¯ Ù…Ù„Ú©')
        .setStyle(ButtonStyle.Primary)
        .setEmoji('ğŸ '),
      new ButtonBuilder()
        .setCustomId('sell_property_menu')
        .setLabel('ÙØ±ÙˆØ´ Ù…Ù„Ú©')
        .setStyle(ButtonStyle.Danger)
        .setEmoji('ğŸ’±')
        .setDisabled(properties.length === 0)
    );
  
  const backRow = new ActionRowBuilder()
    .addComponents(
      new ButtonBuilder()
        .setCustomId('economy_menu')
        .setLabel('Ø¨Ø§Ø²Ú¯Ø´Øª')
        .setStyle(ButtonStyle.Secondary)
        .setEmoji('â¬…ï¸')
    );
  
  await interaction.update({ embeds: [realEstateEmbed], components: [propertyRow1, propertyRow2, backRow] });
}

async function showInventory(interaction) {
  const userId = interaction.user.id;

  // Check for active items
  const hasProtection = await db.get(`protection_${userId}`) || false;
  const protectionExpiry = await db.get(`protectionExpiry_${userId}`) || 0;

  const hasVIP = await db.get(`vip_${userId}`) || false;
  const vipExpiry = await db.get(`vipExpiry_${userId}`) || 0;

  const hasInsurance = await db.get(`insurance_${userId}`) || false;
  const insuranceExpiry = await db.get(`insuranceExpiry_${userId}`) || 0;

  const hasDagger = await db.get(`thief_dagger_${userId}`) || false;
  const hasNinjaMask = await db.get(`ninja_mask_${userId}`) || false;

  const badges = await db.get(`badges_${userId}`) || [];
  const inventory = await db.get(`inventory_${userId}`) || [];

  // Create inventory description
  let description = '**Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„:**\n\n';

  if (hasProtection && protectionExpiry > Date.now()) {
    const timeLeft = Math.floor((protectionExpiry - Date.now()) / (1000 * 60 * 60));
    description += `ğŸ›¡ï¸ **Ù…Ø­Ø§ÙØ¸ Ø´Ø®ØµÛŒ** - Ù…Ù†Ù‚Ø¶ÛŒ Ø¯Ø± ${timeLeft} Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ø±\n`;
  }

  if (hasVIP && vipExpiry > Date.now()) {
    const timeLeft = Math.floor((vipExpiry - Date.now()) / (1000 * 60 * 60 * 24));
    description += `ğŸ”® **ØªÙˆÚ©Ù† VIP** - Ù…Ù†Ù‚Ø¶ÛŒ Ø¯Ø± ${timeLeft} Ø±ÙˆØ² Ø¯ÛŒÚ¯Ø±\n`;
  }

  if (hasInsurance && insuranceExpiry > Date.now()) {
    const timeLeft = Math.floor((insuranceExpiry - Date.now()) / (1000 * 60 * 60 * 24));
    description += `ğŸ’¹ **Ø¨ÛŒÙ…Ù‡ Ø¶Ø¯ Ø³Ø±Ù‚Øª** - Ù…Ù†Ù‚Ø¶ÛŒ Ø¯Ø± ${timeLeft} Ø±ÙˆØ² Ø¯ÛŒÚ¯Ø±\n`;
  }

  // Add pickpocketing items
  // Find dagger in inventory and display durability
  const daggerItem = inventory.find(item => item.name === 'Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ');
  if (hasDagger && daggerItem) {
    description += `ğŸ”ª **Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ** - Ø¯ÙˆØ§Ù…: ${daggerItem.durability}/10 Ø§Ø³ØªÙØ§Ø¯Ù‡\n`;
  }

  // Find ninja mask in inventory and display durability
  const maskItem = inventory.find(item => item.name === 'Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§');
  if (hasNinjaMask && maskItem) {
    description += `ğŸ•¶ï¸ **Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§** - Ø¯ÙˆØ§Ù…: ${maskItem.durability}/5 Ø§Ø³ØªÙØ§Ø¯Ù‡\n`;
  }

  // Add section for other items
  if (inventory.length > 0) {
    const otherItems = inventory.filter(item => 
      item.name !== 'Ú†Ø§Ù‚ÙˆÛŒ Ø¬ÛŒØ¨â€ŒØ¨Ø±ÛŒ' && 
      item.name !== 'Ù…Ø§Ø³Ú© Ù†ÛŒÙ†Ø¬Ø§'
    );
    
    if (otherItems.length > 0) {
      description += '\n**Ø³Ø§ÛŒØ± Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯:**\n';
      otherItems.forEach((item, index) => {
        description += `${item.icon} **${item.name}**`;
        if (item.durability) {
          description += ` - Ø¯ÙˆØ§Ù…: ${item.durability} Ø§Ø³ØªÙØ§Ø¯Ù‡`;
        }
        description += '\n';
      });
    }
  }

  if (badges.length > 0) {
    description += `\n**Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø§ÙØªØ®Ø§Ø±:**\n${badges.join(' ')}`;
  }

  // Check if user has been banned from pickpocketing
  const pickpocketBanned = await db.get(`pickpocketBanned_${userId}`) || false;
  const pickpocketBanExpiry = await db.get(`pickpocketBanExpiry_${userId}`) || 0;
  
  if (pickpocketBanned && pickpocketBanExpiry > Date.now()) {
    const timeLeft = Math.floor((pickpocketBanExpiry - Date.now()) / (1000 * 60 * 60));
    description += `\n\nâš ï¸ **Ù…Ø­Ø±ÙˆÙ…ÛŒØª Ø§Ø² Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ:**\nØ´Ù…Ø§ Ø¨Ù‡ Ù…Ø¯Øª ${timeLeft} Ø³Ø§Ø¹Øª Ø¯ÛŒÚ¯Ø± Ø§Ø² Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ù…Ø­Ø±ÙˆÙ… Ù‡Ø³ØªÛŒØ¯.`;
  }

  // Display daily pickpocket attempts
  const dailyPickpocketCount = await db.get(`dailyPickpocket_${userId}`) || 0;
  if (dailyPickpocketCount > 0) {
    description += `\n\nğŸ“Š **Ø¢Ù…Ø§Ø± Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø§Ù…Ø±ÙˆØ²:**\n${dailyPickpocketCount}/3 Ø¬ÛŒØ¨â€ŒØ²Ù†ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡`;
  }

  if (description === '**Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„:**\n\n') {
    description += 'Ø´Ù…Ø§ Ù‡ÛŒÚ† Ø¢ÛŒØªÙ… ÙØ¹Ø§Ù„ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯.';
  }

  const embed = new EmbedBuilder()
    .setColor('#9b59b6')
    .setTitle(`ğŸ’ Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ ${interaction.user.username}`)
    .setDescription(description)
    .setThumbnail(interaction.user.displayAvatarURL())
    .setFooter({ text: 'Ø§Ø² ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ø®Ø±ÛŒØ¯!' })
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

async function showProfile(interaction) {
  const userId = interaction.user.id;

  // Get user data
  const wallet = await db.get(`wallet_${userId}`) || 0;
  const bank = await db.get(`bank_${userId}`) || 0;
  const hasVIP = await db.get(`vip_${userId}`) || false;
  const vipExpiry = await db.get(`vipExpiry_${userId}`) || 0;
  const badges = await db.get(`badges_${userId}`) || [];

  // Create basic profile
  const embed = new EmbedBuilder()
    .setColor(hasVIP && vipExpiry > Date.now() ? '#ffd700' : '#0099ff')
    .setTitle(`${hasVIP && vipExpiry > Date.now() ? 'ğŸ‘‘ ' : ''}Ù¾Ø±ÙˆÙØ§ÛŒÙ„ ${interaction.user.username}`)
    .setThumbnail(interaction.user.displayAvatarURL())
    .addFields(
      { name: 'ğŸ’° Ù…Ø¬Ù…ÙˆØ¹ Ø¯Ø§Ø±Ø§ÛŒÛŒ', value: `${wallet + bank} ğŸª™`, inline: true },
      { name: 'ğŸ‘› Ú©ÛŒÙ Ù¾ÙˆÙ„', value: `${wallet} ğŸª™`, inline: true },
      { name: 'ğŸ¦ Ø¨Ø§Ù†Ú©', value: `${bank} ğŸª™`, inline: true }
    )
    .setTimestamp();

  // Add badges if any
  if (badges.length > 0) {
    embed.addFields({ name: 'ğŸ† Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§', value: badges.join(' ') });
  }

  // Add VIP status if active
  if (hasVIP && vipExpiry > Date.now()) {
    const timeLeft = Math.floor((vipExpiry - Date.now()) / (1000 * 60 * 60 * 24));
    embed.addFields({ name: 'ğŸ‘‘ ÙˆØ¶Ø¹ÛŒØª VIP', value: `ÙØ¹Ø§Ù„ (${timeLeft} Ø±ÙˆØ² Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡)` });
  }

  await interaction.reply({ embeds: [embed] });
}

async function showLeaderboard(interaction) {
  // Get all user IDs from the database with wallet and bank
  const walletEntries = await db.all();

  // Filter wallet entries and calculate total balance
  const walletPattern = /^wallet_(\d+)$/;
  const userBalances = [];

  for (const entry of walletEntries) {
    const match = entry.id.match(walletPattern);
    if (match) {
      const userId = match[1];
      const wallet = entry.value || 0;
      const bank = await db.get(`bank_${userId}`) || 0;
      const total = wallet + bank;

      if (total > 0) {
        userBalances.push({ userId, total });
      }
    }
  }

  // Sort by total balance, descending
  userBalances.sort((a, b) => b.total - a.total);

  // Create the leaderboard embed
  const embed = new EmbedBuilder()
    .setColor('#ffd700')
    .setTitle('ğŸ’° Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯ Ø«Ø±ÙˆØªÙ…Ù†Ø¯ØªØ±ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±Ø§Ù†')
    .setTimestamp();

  // Add top 10 users to the leaderboard
  let description = '';

  for (let i = 0; i < Math.min(10, userBalances.length); i++) {
    const { userId, total } = userBalances[i];

    try {
      const user = await client.users.fetch(userId);
      description += `**${i + 1}.** ${user.tag} - **${total}** ğŸª™\n`;
    } catch (error) {
      description += `**${i + 1}.** Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³ - **${total}** ğŸª™\n`;
    }
  }

// Helper function to reset daily pickpocket counters
async function resetDailyPickpocketCounters() {
  const dailyCounters = await db.all();
  const dailyPickpocketPattern = /^dailyPickpocket_(\d+)$/;

  for (const entry of dailyCounters) {
    const match = entry.id.match(dailyPickpocketPattern);
    if (match) {
      await db.delete(entry.id);
      console.log(`Reset daily pickpocket counter for user ${match[1]}`);
    }
  }

  console.log('All daily pickpocket counters have been reset.');
}


  if (description === '') {
    description = 'Ù‡Ù†ÙˆØ² Ù‡ÛŒÚ† Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø³Ú©Ù‡â€ŒØ§ÛŒ Ù†Ø¯Ø§Ø±Ø¯!';
  }

  embed.setDescription(description);
  await interaction.reply({ embeds: [embed] });
}

async function transferMoney(interaction, targetUser, amountStr) {
  if (!targetUser || !amountStr) {
    return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ú©Ø§Ø±Ø¨Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ùˆ Ù…Ù‚Ø¯Ø§Ø± Ø§Ù†ØªÙ‚Ø§Ù„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }

  let amount = amountStr;

  // Cannot transfer to yourself or bots
  if (targetUser.id === interaction.user.id) 
    return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ Ø®ÙˆØ¯ØªØ§Ù† Ø³Ú©Ù‡ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ù‡ÛŒØ¯!', ephemeral: true });

  if (targetUser.bot) 
    return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ Ø±Ø¨Ø§Øªâ€ŒÙ‡Ø§ Ø³Ú©Ù‡ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ù‡ÛŒØ¯!', ephemeral: true });

  const userId = interaction.user.id;
  const wallet = await db.get(`wallet_${userId}`) || 0;

  // Validate transfer amount
  if (amount === 'all') {
    amount = wallet;
  } else {
    amount = parseInt(amount);
    if (isNaN(amount)) return interaction.reply({ content: 'âŒ Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!', ephemeral: true });
  }

  if (amount <= 0) return interaction.reply({ content: 'âŒ Ù…Ù‚Ø¯Ø§Ø± Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø§ÛŒØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² ØµÙØ± Ø¨Ø§Ø´Ø¯!', ephemeral: true });
  if (amount > wallet) return interaction.reply({ content: 'âŒ Ø´Ù…Ø§ Ø³Ú©Ù‡ Ú©Ø§ÙÛŒ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø®ÙˆØ¯ Ù†Ø¯Ø§Ø±ÛŒØ¯!', ephemeral: true });

  // Process transfer
  await db.sub(`wallet_${userId}`, amount);
  await db.add(`wallet_${targetUser.id}`, amount);

  const embed = new EmbedBuilder()
    .setColor('#00ff00')
    .setTitle('ğŸ’¸ Ø§Ù†ØªÙ‚Ø§Ù„ Ù…ÙˆÙÙ‚')
    .setDescription(`Ø´Ù…Ø§ ${amount} ğŸª™ Ø¨Ù‡ <@${targetUser.id}> Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯ÛŒØ¯!`)
    .setTimestamp();

  await interaction.reply({ embeds: [embed] });
}

// Helper function for applying bank interest
async function applyBankInterest() {
  const bankEntries = await db.all();
  const bankPattern = /^bank_(\d+)$/;

  for (const entry of bankEntries) {
    const match = entry.id.match(bankPattern);
    if (match) {
      const userId = match[1];
      const bank = entry.value || 0;

      if (bank > 0) {
        const interest = Math.floor(bank * BANK_INTEREST_RATE);
        if (interest > 0) {
          await db.add(`bank_${userId}`, interest);
        }
      }
    }
  }

  console.log('Applied monthly bank interest to all accounts.');
}

// Help command
function sendHelpEmbed(message) {
  const embed = new EmbedBuilder()
    .setColor('#0099ff')
    .setTitle('ğŸ’° Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø±Ø¨Ø§Øª Ø§Ù‚ØªØµØ§Ø¯ÛŒ')
    .setDescription('Ù„ÛŒØ³Øª Ø¯Ø³ØªÙˆØ±Ø§Øª Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡:')
    .addFields(
      { name: 'ğŸ¦ Ø¯Ø³ØªÙˆØ±Ø§Øª Ø§ØµÙ„ÛŒ', value: 
        '`!balance` - Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ùˆ Ø¨Ø§Ù†Ú©\n' +
        '`!daily` - Ø¯Ø±ÛŒØ§ÙØª Ø³Ú©Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡\n' +
        '`!deposit <Ù…Ù‚Ø¯Ø§Ø±>` - ÙˆØ§Ø±ÛŒØ² Ø¨Ù‡ Ø¨Ø§Ù†Ú©\n' +
        '`!withdraw <Ù…Ù‚Ø¯Ø§Ø±>` - Ø¨Ø±Ø¯Ø§Ø´Øª Ø§Ø² Ø¨Ø§Ù†Ú©\n' +
        '`!transfer @user <Ù…Ù‚Ø¯Ø§Ø±>` - Ø§Ù†ØªÙ‚Ø§Ù„ Ø³Ú©Ù‡ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø±'
      },
      { name: 'ğŸ® Ø¨Ø§Ø²ÛŒâ€ŒÙ‡Ø§', value: 
        '`!coinflip <Ù…Ù‚Ø¯Ø§Ø±> <Ø´ÛŒØ±/Ø®Ø·>` - Ø´ÛŒØ± ÛŒØ§ Ø®Ø·\n' +
        '`!dice <Ù…Ù‚Ø¯Ø§Ø±> <1-6>` - ØªØ§Ø³\n' +
        '`!rob @user` - Ø¯Ø²Ø¯ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø± Ø¯ÛŒÚ¯Ø±'
      },
      { name: 'ğŸ›’ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ùˆ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§', value: 
        '`!shop` - Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡\n' +
        '`!buy <Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ…>` - Ø®Ø±ÛŒØ¯ Ø¢ÛŒØªÙ…\n' +
        '`!inventory` - Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©ÙˆÙ„Ù‡â€ŒÙ¾Ø´ØªÛŒ'
      },
      { name: 'ğŸ“Š Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ùˆ Ø¢Ù…Ø§Ø±', value: 
        '`!profile` - Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù¾Ø±ÙˆÙØ§ÛŒÙ„\n' +
        '`!leaderboard` - Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù„ÛŒØ¯Ø±Ø¨ÙˆØ±Ø¯'
      }
    )
    .setFooter({ text: 'Ø§Ø² !help Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ø§ÛŒÙ† Ø±Ø§Ù‡Ù†Ù…Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.' });

  message.reply({ embeds: [embed] });
}

// Login to Discord with your app's token
console.log("Attempting to login with Discord token...");
console.log("Token environment variable exists:", !!process.env.TOKEN);
// Ø§Ú¯Ø± ØªÙˆÚ©Ù† Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø¯Ø± Ù…Ø­ÛŒØ· ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯ØŒ Ø§ÛŒÙ† Ù¾ÛŒØ§Ù… Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
// Ø§Ú¯Ø± undefined ÛŒØ§ Ø®Ø§Ù„ÛŒ Ø¨Ø§Ø´Ø¯ØŒ Ù…Ø´Ú©Ù„ Ø¯Ø± Secrets Ø§Ø³Øª

client.login(process.env.TOKEN)
  .then(() => {
    console.log("Successfully logged in to Discord!");
  })
  .catch(error => {
    console.error("Failed to login to Discord:", error.message);
    console.log("Please make sure your TOKEN is correctly set in Secrets.");

    // Ú†Ú© Ú©Ø±Ø¯Ù† Ù…Ø´Ú©Ù„Ø§Øª Ø±Ø§ÛŒØ¬
    if (error.message.includes("invalid token")) {
      console.log("ØªÙˆÚ©Ù† Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ ÛŒÚ© ØªÙˆÚ©Ù† Ø¬Ø¯ÛŒØ¯ Ø§Ø² Ù¾Ù†Ù„ Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯ ØªÙ‡ÛŒÙ‡ Ú©Ù†ÛŒØ¯.");
    }
    if (error.message.includes("disallowed intents")) {
      console.log("Ù…Ø´Ú©Ù„ Ø¨Ø§ Intents Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯. Ù„Ø·ÙØ§Ù‹ Ø¨Ù‡ Ù¾Ù†Ù„ Ø¯ÛŒØ³Ú©ÙˆØ±Ø¯ Ø¨Ø±ÙˆÛŒØ¯ Ùˆ Intents Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯.");
    }
  });