باشه، خیلی خوبه که می‌خوای تنوع شغل‌ها رو بیشتر کنی! من 5 تا شغل جدید طراحی می‌کنم که حس واقعی داشته باشن، به فضای دیسکورد و رباتت بخورن و با سیستم دکمه‌ای هماهنگ باشن. این شغل‌ها رو طوری می‌سازم که هم فعالیت‌های سرور رو تقویت کنن، هم کاربرا رو به تعامل بیشتر تشویق کنن. بیایم شروع کنیم!

---

### مستندسازی دقیق سیستم شغل با 10 شغل

#### شغل‌های قبلی (5 شغل موجود)
1. **کارگر معدن (Miner)**  
   - **درآمد:** 200 Ccoin هر 12 ساعت  
   - **پیش‌نیاز:** بدون پیش‌نیاز  
   - **فعالیت:** پست کردن یه پیام (مثل جوک) تو کانال مشخص و ثبت لینک.  
   - **ارتقا:** تا 292 Ccoin + شانس 5% کریستال (سطح 5).  

2. **تاجر (Trader)**  
   - **درآمد:** 500 Ccoin هر 12 ساعت  
   - **پیش‌نیاز:** 10,000 Ccoin  
   - **فعالیت:** خرید یا فروش آیتم تو بازار و ثبت کد تراکنش.  
   - **ارتقا:** تا 732 Ccoin + تخفیف 10% تو فروشگاه (سطح 5).  

3. **ساپورت ربات (Bot Supporter)**  
   - **درآمد:** 300 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** 5000 Ccoin  
   - **فعالیت:** جواب دادن به سوال تو کانال اطلاعات عمومی (3+ رای مثبت) و ثبت لینک.  
   - **ارتقا:** تا 439 Ccoin + نشان "پشتیبان نمونه" (سطح 5).  

4. **شکارچی گنج (Treasure Hunter)**  
   - **درآمد:** 250 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** 5000 Ccoin  
   - **فعالیت:** پیدا کردن پیام رویداد ربات تو کانال و ثبت لینک.  
   - **ارتقا:** تا 365 Ccoin + شانس 30% آیتم نادر (سطح 5).  

5. **سرباز کلن (Clan Soldier)**  
   - **درآمد:** 400 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** عضویت در کلن  
   - **فعالیت:** شرکت تو جنگ کلن یا ماموریت گروهی و ثبت نتیجه.  
   - **ارتقا:** تا 585 Ccoin + 10% قدرت تو جنگ (سطح 5).  

---

#### شغل‌های جدید (5 شغل اضافه)
6. **خبرنگار سرور (Server Reporter)**  
   - **توضیح:** کاربری که اخبار و اتفاقات سرور رو گزارش می‌ده، مثل یه روزنامه‌نگار واقعی.  
   - **درآمد پایه:** 350 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** 7000 Ccoin  
   - **فعالیت:** نوشتن یه گزارش کوتاه (حداقل 50 کلمه) از یه رویداد سرور (مثلاً جنگ کلن یا مسابقه) تو کانال "اخبار" و ثبت لینک پیام. گزارش باید حداقل 2 رای مثبت بگیره.  
   - **ارتقا:**  
     - سطح 1: 350 Ccoin  
     - سطح 2: 385 Ccoin (نیاز: 50 XP + 1500 Ccoin)  
     - سطح 3: 423 Ccoin  
     - سطح 4: 465 Ccoin  
     - سطح 5: 512 Ccoin + نشان "خبرنگار برتر"  
   - **واقعیت:** حس گزارشگری و مستندسازی سرور رو می‌ده.

7. **برگزارکننده رویداد (Event Organizer)**  
   - **توضیح:** کاربری که رویدادهای کوچیک تو سرور راه می‌ندازه، مثل مسابقه یا بازی گروهی.  
   - **درآمد پایه:** 450 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** 12,000 Ccoin  
   - **فعالیت:** برگزاری یه رویداد (مثلاً کوئیز یا حقیقت و جرأت) تو چت صوتی یا متنی و ثبت لینک چت یا اعلام نتیجه با حداقل 5 شرکت‌کننده.  
   - **ارتقا:**  
     - سطح 1: 450 Ccoin  
     - سطح 2: 495 Ccoin (نیاز: 50 XP + 2000 Ccoin)  
     - سطح 3: 544 Ccoin  
     - سطح 4: 598 Ccoin  
     - سطح 5: 658 Ccoin + امکان درخواست 500 Ccoin جایزه از خزانه برای رویداد  
   - **واقعیت:** حس مدیریت و سرگرم کردن بقیه رو می‌ده.

8. **طراح چالش (Challenge Designer)**  
   - **توضیح:** کاربری که چالش‌های خلاقانه برای بقیه طراحی می‌کنه، مثل یه گیم‌مستر.  
   - **درآمد پایه:** 320 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** 6000 Ccoin  
   - **فعالیت:** ساخت یه چالش (مثلاً "10 کلمه مرتبط بگو" یا "یه نقاشی بکش") تو کانال مشخص و ثبت لینک. حداقل 3 نفر باید شرکت کنن.  
   - **ارتقا:**  
     - سطح 1: 320 Ccoin  
     - سطح 2: 352 Ccoin (نیاز: 50 XP + 1300 Ccoin)  
     - سطح 3: 387 Ccoin  
     - سطح 4: 426 Ccoin  
     - سطح 5: 468 Ccoin + شانس 10% برای 1 Crystal  
   - **واقعیت:** حس خلاقیت و تعامل با کاربرا رو می‌ده.

9. **نگهبان سرور (Server Guardian)**  
   - **توضیح:** کاربری که به نظم سرور کمک می‌کنه، مثل گزارش اسپم یا رفتار بد.  
   - **درآمد پایه:** 280 Ccoin هر 24 ساعت  
   - **پیش‌نیاز:** 4000 Ccoin  
   - **فعالیت:** گزارش یه پیام مشکل‌دار (مثل اسپم یا توهین) تو کانال "گزارشات" با لینک پیام و توضیح کوتاه. گزارش باید توسط ادمین یا ربات تأیید بشه.  
   - **ارتقا:**  
     - سطح 1: 280 Ccoin  
     - سطح 2: 308 Ccoin (نیاز: 50 XP + 1000 Ccoin)  
     - سطح 3: 339 Ccoin  
     - سطح 4: 373 Ccoin  
     - سطح 5: 410 Ccoin + نشان "نگهبان افتخاری"  
   - **واقعیت:** حس مسئولیت‌پذیری و کمک به سرور رو می‌ده.

10. **استریمر سرور (Server Streamer)**  
    - **توضیح:** کاربری که محتوای سرگرم‌کننده (مثل بازی یا چت صوتی) استریم می‌کنه.  
    - **درآمد پایه:** 380 Ccoin هر 24 ساعت  
    - **پیش‌نیاز:** 8000 Ccoin  
    - **فعالیت:** استریم حداقل 30 دقیقه تو چت صوتی سرور (مثلاً بازی یا گپ) و ثبت لینک اعلام استریم تو کانال مشخص با حداقل 3 شنونده.  
    - **ارتقا:**  
      - سطح 1: 380 Ccoin  
      - سطح 2: 418 Ccoin (نیاز: 50 XP + 1600 Ccoin)  
      - سطح 3: 460 Ccoin  
      - سطح 4: 506 Ccoin  
      - سطح 5: 556 Ccoin + امکان نمایش پروفایل تو کانال "استримерها"  
    - **واقعیت:** حس سرگرمی و جذب مخاطب تو سرور رو می‌ده.

---

#### 3. مکانیزم‌های مشترک
- **XP و ارتقا:**  
  - هر فعالیت موفق → 10 XP.  
  - ارتقا: 50 XP + هزینه سکه (بسته به شغل از 1000 تا 2000 Ccoin).  
  - افزایش درآمد: 10% با هر سطح + جایزه خاص تو سطح 5.  
- **کول‌داون:**  
  - 12 ساعت: کارگر معدن، تاجر.  
  - 24 ساعت: بقیه شغل‌ها.  
- **ثبت کار:** کاربر بعد از فعالیت، با دکمه "ثبت کار" لینک یا مدرک می‌فرسته و ربات چک می‌کنه (مثلاً رای‌ها، تعداد شرکت‌کننده‌ها).  
- **مالیات:** 5% از درآمد به خزانه برای رویدادها.

---

#### 4. پیاده‌سازی در کد (به‌روزرسانی)

##### الف) مدل شغل (Job.ts)
```typescript
// server/models/economy/Job.ts
export interface Job {
  userId: string;
  jobType: string; // "miner", "trader", "supporter", "hunter", "soldier", "reporter", "organizer", "designer", "guardian", "streamer"
  income: number;
  currency: "Ccoin";
  level: number; // 1-5
  xp: number;
  lastWorked: number;
  cooldown: number;
  lastTask?: string; // لینک یا مدرک فعالیت
}
```

##### ب) منوی شغل (economyMenu.ts)
```typescript
// server/discord/components/economyMenu.ts
import { ButtonInteraction, MessageActionRow, MessageButton } from 'discord.js';

function createJobsMenu(userJob: Job | null) {
  const buttons = [
    new MessageButton().setCustomId('jobs_select').setLabel('انتخاب شغل').setStyle('PRIMARY'),
    new MessageButton().setCustomId('jobs_work').setLabel('کار کردن').setStyle('SUCCESS'),
    new MessageButton().setCustomId('jobs_submit').setLabel('ثبت کار').setStyle('SECONDARY'),
    new MessageButton().setCustomId('jobs_upgrade').setLabel('ارتقا شغل').setStyle('SECONDARY'),
    new MessageButton().setCustomId('jobs_status').setLabel('وضعیت شغل').setStyle('SECONDARY'),
    new MessageButton().setCustomId('economy_back').setLabel('بازگشت').setStyle('DANGER'),
  ];
  const row = new MessageActionRow().addComponents(buttons);
  const desc = userJob ? `شغل: ${userJob.jobType} | سطح: ${userJob.level} | درآمد: ${userJob.income} Ccoin` : 'شغلی انتخاب نشده!';
  return { content: desc, components: [row] };
}

export async function handleJobsInteraction(interaction: ButtonInteraction) {
  const customId = interaction.customId;
  const userId = interaction.user.id;

  if (customId === 'jobs_select') {
    const jobs = [
      { id: 'miner', label: 'کارگر معدن (200 Ccoin/12h)', req: { ccoin: 0 } },
      { id: 'trader', label: 'تاجر (500 Ccoin/12h)', req: { ccoin: 10000 } },
      { id: 'supporter', label: 'ساپورت ربات (300 Ccoin/24h)', req: { ccoin: 5000 } },
      { id: 'hunter', label: 'شکارچی گنج (250 Ccoin/24h)', req: { ccoin: 5000 } },
      { id: 'soldier', label: 'سرباز کلن (400 Ccoin/24h)', req: { clan: true } },
      { id: 'reporter', label: 'خبرنگار سرور (350 Ccoin/24h)', req: { ccoin: 7000 } },
      { id: 'organizer', label: 'برگزارکننده رویداد (450 Ccoin/24h)', req: { ccoin: 12000 } },
      { id: 'designer', label: 'طراح چالش (320 Ccoin/24h)', req: { ccoin: 6000 } },
      { id: 'guardian', label: 'نگهبان سرور (280 Ccoin/24h)', req: { ccoin: 4000 } },
      { id: 'streamer', label: 'استریمر سرور (380 Ccoin/24h)', req: { ccoin: 8000 } },
    ];
    const buttons = jobs.map(j => new MessageButton().setCustomId(`select_${j.id}`).setLabel(j.label).setStyle('PRIMARY'));
    const rows = [];
    for (let i = 0; i < buttons.length; i += 5) rows.push(new MessageActionRow().addComponents(buttons.slice(i, i + 5)));
    await interaction.update({ content: 'شغلت رو انتخاب کن:', components: rows });
  }

  if (customId === 'jobs_work') {
    const job = await storage.getUserJob(userId);
    if (!job) return await interaction.update({ content: 'اول شغل انتخاب کن!' });
    const now = Date.now();
    if (now < job.lastWorked + job.cooldown) {
      const remaining = Math.ceil((job.lastWorked + job.cooldown - now) / 3600000);
      await interaction.update({ content: `هنوز ${remaining} ساعت مونده!` });
    } else {
      const tasks = {
        miner: 'یه پیام تو چت بفرست و لینک کن.',
        trader: 'یه آیتم بخر یا بفروش و کد تراکنش بده.',
        supporter: 'به یه سوال تو اطلاعات عمومی جواب بده (3+ رای).',
        hunter: 'پیام رویداد امروز رو پیدا کن.',
        soldier: 'تو جنگ کلن شرکت کن.',
        reporter: 'یه گزارش از سرور بنویس (2+ رای).',
        organizer: 'یه رویداد با 5 نفر برگزار کن.',
        designer: 'یه چالش بساز (3 نفر شرکت کنن).',
        guardian: 'یه پیام مشکل‌دار گزارش بده.',
        streamer: '30 دقیقه استریم کن (3 شنونده).',
      };
      await interaction.update({ content: tasks[job.jobType] + '\nبعدش "ثبت کار" رو بزن.', components: [new MessageActionRow().addComponents(
        new MessageButton().setCustomId('jobs_submit').setLabel('ثبت کار').setStyle('SECONDARY')
      )] });
    }
  }

  if (customId === 'jobs_submit') {
    await interaction.reply({ content: 'لینک یا مدرک فعالیتت رو بفرست:', ephemeral: true });
    // اینجا باید collector برای چک کردن مدرک اضافه بشه
  }

  if (customId === 'jobs_upgrade') {
    const job = await storageA.getUserJob(userId);
    if (!job || job.xp < 50) return await interaction.update({ content: 'XP کافی نداری!' });
    const cost = job.level * 500 + 500;
    if (await storage.getUserCcoin(userId) >= cost) {
      await storage.updateJobLevel(userId);
      await interaction.update({ content: `شغلت به سطح ${job.level + 1} ارتقا یافت!` });
    } else {
      await interaction.update({ content: 'سکه کافی نداری!' });
    }
  }
}
```

##### ج) ذخیره‌سازی (storage.ts)
```typescript
// server/storage.ts
export class MemStorage {
  private jobs: Map<string, Job> = new Map();

  async getUserJob(userId: string): Promise<Job | null> {
    return this.jobs.get(userId) || null;
  }

  async assignJob(userId: string, jobType: string): Promise<void> {
    const jobData = {
      miner: { income: 200, cooldown: 12 * 3600000 },
      trader: { income: 500, cooldown: 12 * 3600000 },
      supporter: { income: 300, cooldown: 24 * 3600000 },
      hunter: { income: 250, cooldown: 24 * 3600000 },
      soldier: { income: 400, cooldown: 24 * 3600000 },
      reporter: { income: 350, cooldown: 24 * 3600000 },
      organizer: { income: 450, cooldown: 24 * 3600000 },
      designer: { income: 320, cooldown: 24 * 3600000 },
      guardian: { income: 280, cooldown: 24 * 3600000 },
      streamer: { income: 380, cooldown: 24 * 3600000 },
    };
    const job = { userId, jobType, level: 1, xp: 0, lastWorked: 0, currency: 'Ccoin', ...jobData[jobType] };
    this.jobs.set(userId, job);
  }

  async collectJobIncome(userId: string, taskProof: string): Promise<void> {
    const job = this.jobs.get(userId);
    if (job) {
      job.lastWorked = Date.now();
      job.xp += 10;
      job.lastTask = taskProof;
      // منطق چک کردن taskProof و اضافه کردن درآمد
      this.jobs.set(userId, job);
    }
  }

  async updateJobLevel(userId: string): Promise<void> {
    const job = this.jobs.get(userId);
    if (job && job.xp >= 50) {
      job.level += 1;
      job.xp = 0;
      job.income = Math.floor(job.income * 1.1);
      this.jobs.set(userId, job);
    }
  }
}
```

---

### نتیجه
حالا 10 شغل داری که هم واقعی‌ان، هم به سرور دیسکوردت حس پویایی می‌دن. هر کدوم یه فعالیت مشخص دارن که کاربرا رو به مشارکت تو سرور تشویق می‌کنه. اگه بخوای یه شغل رو تغییر بدی یا جزئیات بیشتری به کد اضافه کنم (مثلاً منطق چک کردن مدارک)، بگو تا باهم کاملش کنیم! 😊