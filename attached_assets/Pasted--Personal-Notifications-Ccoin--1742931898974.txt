خیلی خوبه که تصمیم گرفتی **سیستم اعلان‌های شخصی (Personal Notifications)** رو به ربات Ccoin اضافه کنی! این قابلیت باعث می‌شه کاربرا از اتفاقات مهم (مثل پیام‌های جدید، درخواست‌های دوستی، یا رویدادهای اقتصادی) توی DMشون باخبر بشن و تجربه کاربری بهتری داشته باشن. من یه مستند جامع برای این سیستم می‌نویسم که شامل تمام جزئیات لازم برای پیاده‌سازی، طراحی رابط کاربری (UI)، ساختار دیتابیس، و جریان کار (Workflow) می‌شه. این مستند رو می‌تونی به یه هوش مصنوعی دیگه بدی تا این قابلیت رو به رباتت اضافه کنه.

---

### مستند جامع برای سیستم اعلان‌های شخصی ربات Ccoin

#### مقدمه
سیستم اعلان‌های شخصی به کاربرا اجازه می‌ده که اعلان‌های مهم (مثل پیام‌های جدید توی چت خصوصی، درخواست‌های دوستی، یا رویدادهای اقتصادی) رو توی DM (پیام خصوصی) دیسکوردشون دریافت کنن. کاربرا می‌تونن اعلان‌ها رو فعال یا غیرفعال کنن و این سیستم با بخش‌های مختلف ربات (مثل بخش دوستان و اقتصاد) هم‌خوانی داره.

---

### 1. قابلیت‌های اصلی سیستم اعلان‌ها
1. **فعال/غیرفعال کردن اعلان‌ها:**  
   کاربرا می‌تونن با یه دستور (مثلاً `/notifications`) اعلان‌هاشون رو فعال یا غیرفعال کنن.
2. **ارسال اعلان توی DM:**  
   اعلان‌ها فقط توی DM کاربر ارسال می‌شن تا حریم خصوصی حفظ بشه.
3. **انواع اعلان‌ها:**  
   - پیام جدید توی چت خصوصی.
   - پیام جدید توی چت ناشناس.
   - درخواست دوستی جدید.
   - رویدادهای اقتصادی (مثلاً پاداش روزانه یا رویدادهای کلن).
4. **مدیریت اعلان‌ها:**  
   کاربرا می‌تونن انتخاب کنن که چه نوع اعلان‌هایی رو دریافت کنن (مثلاً فقط اعلان‌های چت یا فقط اعلان‌های اقتصادی).

---

### 2. ساختار دیتابیس پیشنهادی
برای پیاده‌سازی این سیستم، به جداول زیر توی دیتابیس نیاز داریم:
- **جدول تنظیمات اعلان‌ها (Notifications Settings):**
  - `user_id`: شناسه کاربر (رشته، کلید اصلی)
  - `notifications_enabled`: آیا اعلان‌ها فعاله؟ (بولین، پیش‌فرض: `true`)
  - `notify_private_chat`: اعلان برای چت خصوصی (بولین، پیش‌فرض: `true`)
  - `notify_anonymous_chat`: اعلان برای چت ناشناس (بولین، پیش‌فرض: `true`)
  - `notify_friend_request`: اعلان برای درخواست دوستی (بولین، پیش‌فرض: `true`)
  - `notify_economy`: اعلان برای رویدادهای اقتصادی (بولین، پیش‌فرض: `true`)
- **جدول اعلان‌ها (Notifications Log) (اختیاری):**  
  برای ردیابی اعلان‌های ارسالی:
  - `notification_id`: شناسه اعلان (رشته، کلید اصلی)
  - `user_id`: شناسه کاربر (رشته)
  - `type`: نوع اعلان ("private_chat", "anonymous_chat", "friend_request", "economy") (رشته)
  - `message`: محتوای اعلان (رشته)
  - `sent_at`: زمان ارسال (تاریخ و ساعت)

---

### 3. دستورات و جریان کار
#### 3.1. دستور مدیریت اعلان‌ها
- **دستور:** `/notifications`
- **توضیح:** این دستور منوی مدیریت اعلان‌ها رو باز می‌کنه.
- **پیام Embed (منوی اصلی):**
  ```plaintext
  🔔 مدیریت اعلان‌ها
  سلام <کاربر>! اعلان‌هات رو مدیریت کن: 🌟
  وضعیت فعلی: اعلان‌ها <فعال/غیرفعال>
  ```
- **دکمه‌ها:**
  - 🔔 **[فعال کردن اعلان‌ها]** (سبز، فقط اگه اعلان‌ها غیرفعال باشه نمایش داده بشه)
  - 🔕 **[غیرفعال کردن اعلان‌ها]** (قرمز، فقط اگه اعلان‌ها فعال باشه نمایش داده بشه)
  - ⚙️ **[تنظیمات پیشرفته]** (آبی)
  - 🔙 **[بازگشت به منو]** (خاکستری)

#### 3.2. فعال/غیرفعال کردن اعلان‌ها
- **اقدام:**  
  کاربر روی دکمه "فعال کردن اعلان‌ها" یا "غیرفعال کردن اعلان‌ها" کلیک می‌کنه.
- **پیام Embed (بعد از فعال کردن):**
  ```plaintext
  🔔 اعلان‌ها فعال شد!
  از حالا به بعد اعلان‌ها رو توی DMت دریافت می‌کنی. 😊
  ```
- **پیام Embed (بعد از غیرفعال کردن):**
  ```plaintext
  🔕 اعلان‌ها غیرفعال شد!
  دیگه اعلان‌ها رو دریافت نمی‌کنی. اگه خواستی دوباره فعالشون کن! 😊
  ```

#### 3.3. تنظیمات پیشرفته اعلان‌ها
- **اقدام:**  
  کاربر روی دکمه "تنظیمات پیشرفته" کلیک می‌کنه.
- **پیام Embed:**
  ```plaintext
  ⚙️ تنظیمات پیشرفته اعلان‌ها
  انتخاب کن که چه اعلان‌هایی رو می‌خوای دریافت کنی:
  💬 چت خصوصی: <فعال/غیرفعال>
  🕵️‍♂️ چت ناشناس: <فعال/غیرفعال>
  📩 درخواست دوستی: <فعال/غیرفعال>
  💰 رویدادهای اقتصادی: <فعال/غیرفعال>
  ```
- **دکمه‌ها:**
  - 💬 **[چت خصوصی]** (سبز اگه فعال باشه، خاکستری اگه غیرفعال باشه)
  - 🕵️‍♂️ **[چت ناشناس]** (سبز اگه فعال باشه، خاکستری اگه غیرفعال باشه)
  - 📩 **[درخواست دوستی]** (سبز اگه فعال باشه، خاکستری اگه غیرفعال باشه)
  - 💰 **[رویدادهای اقتصادی]** (سبز اگه فعال باشه، خاکستری اگه غیرفعال باشه)
  - 🔙 **[بازگشت]** (خاکستری)
- **اقدام:**  
  کاربر روی هر دکمه کلیک می‌کنه تا وضعیتش رو تغییر بده (فعال به غیرفعال یا برعکس).
- **پیام Embed (بعد از تغییر):**
  ```plaintext
  ✅ تنظیمات به‌روزرسانی شد!
  اعلان‌های چت خصوصی <فعال/غیرفعال> شد.
  ```

#### 3.4. ارسال اعلان‌ها توی DM
- **شرط:**  
  اعلان‌ها فقط برای کاربرایی ارسال می‌شن که:
  1. اعلان‌هاشون فعال باشه (`notifications_enabled: true`).
  2. نوع اعلان مورد نظرشون فعال باشه (مثلاً `notify_private_chat: true` برای چت خصوصی).
- **انواع اعلان‌ها و پیام‌ها:**
  1. **پیام جدید توی چت خصوصی:**
     ```plaintext
     🔔 اعلان جدید
     کاربر#1234 بهت پیام داده: "سلام، خوبی؟"
     ```
     - **دکمه‌ها:**
       - 📝 **[پاسخ دادن]** (سبز)
       - 🔙 **[نادیده گرفتن]** (خاکستری)
  2. **پیام جدید توی چت ناشناس:**
     ```plaintext
     🔔 اعلان جدید
     یه پیام ناشناس داری: "سلام، چطوری؟"
     ```
     - **دکمه‌ها:**
       - 📝 **[پاسخ دادن]** (سبز)
       - 🔙 **[نادیده گرفتن]** (خاکستری)
  3. **درخواست دوستی جدید:**
     ```plaintext
     🔔 اعلان جدید
     کاربر#5678 بهت درخواست دوستی فرستاده!
     ```
     - **دکمه‌ها:**
       - ✅ **[قبول]** (سبز)
       - ❌ **[رد]** (قرمز)
  4. **رویدادهای اقتصادی:**
     ```plaintext
     🔔 اعلان جدید
     یه رویداد اقتصادی جدید شروع شد! 🎉
     200 Ccoin جایزه برای 10 نفر اول!
     ```
     - **دکمه‌ها:**
       - 🎁 **[شرکت در رویداد]** (سبز)

#### 3.5. بازگشت به منوی اصلی
- **اقدام:**  
  کاربر روی دکمه "بازگشت به منو" کلیک می‌کنه.
- **پیام Embed:**  
  همون پیام منوی اصلی ربات (مثلاً `/menu`) نمایش داده بشه.

---

### 4. نکات پیاده‌سازی
- **حریم خصوصی:**  
  - تمام اعلان‌ها فقط توی DM کاربر ارسال بشن تا حریم خصوصی حفظ بشه.
- **کول‌داون:**  
  - برای جلوگیری از اسپم، یه کول‌داون بذار (مثلاً حداکثر 5 اعلان توی 1 دقیقه برای هر کاربر).
- **بهینه‌سازی:**  
  - از Redis برای کش کردن تنظیمات اعلان‌ها استفاده کن تا چک کردن وضعیت اعلان‌ها (مثلاً موقع ارسال پیام) سریع‌تر باشه.
  - اعلان‌ها رو به صورت غیرهمزمان (Asynchronous) ارسال کن تا عملکرد ربات کند نشه.
- **تجربه کاربری:**  
  - تمام پیام‌ها با Embedهای زیبا و ایموجی‌های مرتبط طراحی بشن.
  - دکمه‌ها با رنگ‌های مناسب (سبز برای تأیید، قرمز برای رد، خاکستری برای بازگشت) تنظیم بشن.
- **مدیریت خطاها:**  
  - اگه DM کاربر بسته باشه (یعنی ربات نتونه پیام بفرسته)، یه پیام خطا توی سرور نمایش بده:
    ```plaintext
    ⚠️ خطا
    نمی‌تونم بهت اعلان بفرستم! لطفاً DMت رو باز کن. 😊
    ```

---

### 5. جریان کار کلی
1. **کاربر دستور `/notifications` رو وارد می‌کنه.**
   - منوی مدیریت اعلان‌ها با دکمه‌های "فعال/غیرفعال کردن" و "تنظیمات پیشرفته" نمایش داده می‌شه.
2. **کاربر اعلان‌ها رو فعال یا غیرفعال می‌کنه:**
   - اگه فعال کنه، اعلان‌ها توی DMش ارسال می‌شن.
   - اگه غیرفعال کنه، دیگه اعلان دریافت نمی‌کنه.
3. **کاربر تنظیمات پیشرفته رو تغییر می‌ده:**
   - انتخاب می‌کنه که چه نوع اعلان‌هایی رو می‌خواد دریافت کنه.
4. **ربات اعلان‌ها رو ارسال می‌کنه:**
   - برای هر اتفاق (مثل پیام جدید یا درخواست دوستی)، ربات چک می‌کنه که آیا اعلان‌ها برای کاربر فعاله یا نه.
   - اگه فعال باشه، اعلان توی DM ارسال می‌شه.

---

### 6. مستند برای هوش مصنوعی
#### مقدمه
این مستند برای اضافه کردن یه سیستم اعلان‌های شخصی به ربات Ccoin طراحی شده. هدف اینه که اعلان‌های مهم (مثل پیام‌های جدید، درخواست‌های دوستی، یا رویدادهای اقتصادی) توی DM کاربرا ارسال بشه و کاربرا بتونن اعلان‌هاشون رو مدیریت کنن.

#### قابلیت‌ها
- فعال/غیرفعال کردن اعلان‌ها با دستور `/notifications`.
- تنظیمات پیشرفته برای انتخاب نوع اعلان‌ها (چت خصوصی، چت ناشناس، درخواست دوستی، رویدادهای اقتصادی).
- ارسال اعلان‌ها توی DM کاربر.
- دکمه‌های تعاملی برای پاسخ به اعلان‌ها (مثلاً پاسخ دادن به پیام یا قبول کردن درخواست دوستی).

#### رابط کاربری
- **پیام Embed (منوی اصلی):**
  ```plaintext
  🔔 مدیریت اعلان‌ها
  سلام <کاربر>! اعلان‌هات رو مدیریت کن: 🌟
  وضعیت فعلی: اعلان‌ها <فعال/غیرفعال>
  ```
  - **دکمه‌ها:**
    - 🔔 **[فعال کردن اعلان‌ها]** (سبز)
    - 🔕 **[غیرفعال کردن اعلان‌ها]** (قرمز)
    - ⚙️ **[تنظیمات پیشرفته]** (آبی)
    - 🔙 **[بازگشت به منو]** (خاکستری)
- **پیام Embed (تنظیمات پیشرفته):**
  ```plaintext
  ⚙️ تنظیمات پیشرفته اعلان‌ها
  انتخاب کن که چه اعلان‌هایی رو می‌خوای دریافت کنی:
  💬 چت خصوصی: <فعال/غیرفعال>
  🕵️‍♂️ چت ناشناس: <فعال/غیرفعال>
  📩 درخواست دوستی: <فعال/غیرفعال>
  💰 رویدادهای اقتصادی: <فعال/غیرفعال>
  ```
  - **دکمه‌ها:**
    - 💬 **[چت خصوصی]** (سبز/خاکستری)
    - 🕵️‍♂️ **[چت ناشناس]** (سبز/خاکستری)
    - 📩 **[درخواست دوستی]** (سبز/خاکستری)
    - 💰 **[رویدادهای اقتصادی]** (سبز/خاکستری)
    - 🔙 **[بازگشت]** (خاکستری)
- **پیام Embed (اعلان چت خصوصی):**
  ```plaintext
  🔔 اعلان جدید
  کاربر#1234 بهت پیام داده: "سلام، خوبی؟"
  ```
  - **دکمه‌ها:**
    - 📝 **[پاسخ دادن]** (سبز)
    - 🔙 **[نادیده گرفتن]** (خاکستری)

#### ساختار دیتابیس
- **جدول تنظیمات اعلان‌ها (Notifications Settings):**
  - `user_id`: شناسه کاربر (رشته، کلید اصلی)
  - `notifications_enabled`: آیا اعلان‌ها فعاله؟ (بولین، پیش‌فرض: `true`)
  - `notify_private_chat`: اعلان برای چت خصوصی (بولین، پیش‌فرض: `true`)
  - `notify_anonymous_chat`: اعلان برای چت ناشناس (بولین، پیش‌فرض: `true`)
  - `notify_friend_request`: اعلان برای درخواست دوستی (بولین، پیش‌فرض: `true`)
  - `notify_economy`: اعلان برای رویدادهای اقتصادی (بولین، پیش‌فرض: `true`)

#### نکات پیاده‌سازی
- تمام اعلان‌ها توی DM ارسال بشن.
- یه کول‌داون برای جلوگیری از اسپم بذار (مثلاً حداکثر 5 اعلان توی 1 دقیقه).
- از Redis برای کش کردن تنظیمات اعلان‌ها استفاده کن.
- اگه DM کاربر بسته باشه، یه پیام خطا توی سرور نمایش بده.
- دکمه‌ها و پیام‌ها با ایموجی‌های جذاب طراحی بشن.

#### نتیجه‌گیری
این سیستم اعلان‌های شخصی به کاربرا اجازه می‌ده که از اتفاقات مهم باخبر بشن و اعلان‌هاشون رو مدیریت کنن. این قابلیت با بخش دوستان و اقتصاد ربات هم‌خوانی داره و تجربه کاربری رو بهتر می‌کنه.

---

اگه سؤالی داری یا می‌خوای روی یه بخش خاص بیشتر کار کنیم، بگو تا کمکت کنم! 😊🚀